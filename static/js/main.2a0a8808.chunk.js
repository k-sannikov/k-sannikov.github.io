(this.webpackJsonpcard_maker=this.webpackJsonpcard_maker||[]).push([[0],[,,,,,,,,function(e,t,n){e.exports={select:"SelectFontFamily_select__1Hv9D",fantazyor:"SelectFontFamily_fantazyor__1YuH3",piroucyrillic:"SelectFontFamily_piroucyrillic__2APyX",phenomena:"SelectFontFamily_phenomena__3L0pA",sunday:"SelectFontFamily_sunday__3-2n9",kurale:"SelectFontFamily_kurale__-1mws",sensei:"SelectFontFamily_sensei__1zzQ5",borsok:"SelectFontFamily_borsok__2Wuhd",summer:"SelectFontFamily_summer__1jEjL",underdog:"SelectFontFamily_underdog__2MpfH",montserrat:"SelectFontFamily_montserrat__3seoV",openSans:"SelectFontFamily_openSans__tiuJF",comfortaa:"SelectFontFamily_comfortaa__3IxgG",rubik:"SelectFontFamily_rubik__3nd8M",marta:"SelectFontFamily_marta__1T-z5"}},,,,function(e,t,n){e.exports={modal:"Modal_modal__3Ldwj",appear:"Modal_appear__1oVsi",modalDialog:"Modal_modalDialog__3Du5z",animatetop:"Modal_animatetop__2MHhu","slide-in":"Modal_slide-in__1_LpD",modalHeader:"Modal_modalHeader__1ppBy",modalFooter:"Modal_modalFooter__lSAfT",modalClose:"Modal_modalClose__3GnIC",modalBody:"Modal_modalBody__12nPW",modalContent:"Modal_modalContent__35CCy",modalTitle:"Modal_modalTitle__bNkET"}},function(e,t,n){e.exports={toolbar:"ToolbarBackground_toolbar__MQ_48",toolbar__label:"ToolbarBackground_toolbar__label__1I8R8",toolbar__col1:"ToolbarBackground_toolbar__col1__3BwVD",toolbar__col2:"ToolbarBackground_toolbar__col2__12hzd",toolbar__row:"ToolbarBackground_toolbar__row__3lf-3",button_container:"ToolbarBackground_button_container__1ir_S",colorPickerBox:"ToolbarBackground_colorPickerBox__2npIL"}},function(e,t,n){e.exports={block:"Img_block__r3fmB",img:"Img_img__3Hans",selected:"Img_selected__vEyvs",pointBottomRight:"Img_pointBottomRight__1Z-pj",pointTopLeft:"Img_pointTopLeft__3ZXB8",pointTopRight:"Img_pointTopRight__2cXMJ",pointBottomLeft:"Img_pointBottomLeft__x6rWq"}},function(e,t,n){e.exports={block:"ArtObj_block__1DyCD",img:"ArtObj_img__3ltZN",selected:"ArtObj_selected__1oJ2Z",pointBottomRight:"ArtObj_pointBottomRight__3og1x",pointTopLeft:"ArtObj_pointTopLeft__2iQK4",pointTopRight:"ArtObj_pointTopRight__19xjD",pointBottomLeft:"ArtObj_pointBottomLeft__1BMY1"}},function(e,t,n){e.exports={toolbar:"ToolbarCanvas_toolbar__2lemH",toolbar__button:"ToolbarCanvas_toolbar__button__2LRIf",toolbar__label:"ToolbarCanvas_toolbar__label__1lbBA",toolbar__button_text:"ToolbarCanvas_toolbar__button_text__Fo0b_",input_number:"ToolbarCanvas_input_number__kQeBA",toolbar__row:"ToolbarCanvas_toolbar__row__fR0UK",input_range:"ToolbarCanvas_input_range__2BdY0"}},,function(e,t,n){e.exports={toolbar:"ToolbarText_toolbar__L36Xy",toolbar__row:"ToolbarText_toolbar__row__1n6YO",toolbar__label:"ToolbarText_toolbar__label__XASo7",button:"ToolbarText_button__34F-S"}},function(e,t,n){e.exports={toolbar:"ToolbarObject_toolbar__1wNU-",toolbar__label:"ToolbarObject_toolbar__label__GzSLz",toolbar__col:"ToolbarObject_toolbar__col__33gVZ",toolbar__row:"ToolbarObject_toolbar__row__3n9uD",input__color:"ToolbarObject_input__color__3PxWa",button_container:"ToolbarObject_button_container__2CKtQ"}},,,function(e,t,n){e.exports={button:"NavFileButton_button__31bRb",button__text:"NavFileButton_button__text__2WzyS",inputFile:"NavFileButton_inputFile__3SOw7",icon:"NavFileButton_icon__1R6pk"}},function(e,t,n){e.exports={dropbtn:"DropdownMenu_dropbtn__2-JiC",dropdown:"DropdownMenu_dropdown__2_ubm",dropdown_content:"DropdownMenu_dropdown_content__iSef_",dropdown_text:"DropdownMenu_dropdown_text__2gbo8"}},function(e,t,n){e.exports={button:"AddImgButtonFile_button__2N8CC",button__text:"AddImgButtonFile_button__text__34fFe",inputFile:"AddImgButtonFile_inputFile__4uOdL",icon:"AddImgButtonFile_icon__3xQsK"}},function(e,t,n){e.exports={toolbar:"ToolbarFilter_toolbar__CEBoi",toolbar__label:"ToolbarFilter_toolbar__label__3pgyB",input_color:"ToolbarFilter_input_color__1hKXO",input_range:"ToolbarFilter_input_range__2mQc9",colorPickerBox:"ToolbarFilter_colorPickerBox__3-g1H"}},function(e,t,n){e.exports={button:"FileImgButton_button__2-G8o",button__text:"FileImgButton_button__text__ilBCY",inputFile:"FileImgButton_inputFile__nu7Na"}},,function(e,t,n){e.exports={toolbar:"ToolbarImg_toolbar__1U8h2",button_box:"ToolbarImg_button_box__1ADxG",toolbar__label:"ToolbarImg_toolbar__label__3zwm8"}},,,,function(e,t,n){e.exports={header:"Header_header__1rLmw",panel:"Header_panel__29H5m"}},function(e,t,n){e.exports={button:"NavButton_button__UL2Cr",button__text:"NavButton_button__text__C4Sqv"}},function(e,t,n){e.exports={preview:"PreviewTemplate_preview__IUSm5",img:"PreviewTemplate_img__ajmyo"}},function(e,t,n){e.exports={button:"ButtonEditText_button__JsKq3",active:"ButtonEditText_active__1z4H3"}},function(e,t,n){e.exports={button:"AddImgButton_button__2zBC1"}},function(e,t,n){e.exports={button:"Button_button__3s58t",button_text:"Button_button_text__2xGDG"}},function(e,t,n){e.exports={toolbar:"ToolbarArea_toolbar__17QU7",toolbar__label:"ToolbarArea_toolbar__label__25frT"}},function(e,t,n){e.exports={block:"Text_block__Fvt_5",selected:"Text_selected__2uNOO"}},,function(e,t,n){e.exports={main:"CardMaker_main__qNuoq"}},,function(e,t,n){e.exports={navbar:"Navbar_navbar__2UjT7",input:"Navbar_input__1lW6o"}},,,function(e,t,n){e.exports={toolbar:"Toolbar_toolbar__hCIIv"}},function(e,t,n){e.exports={input:"ColorPicker_input__Kiwid"}},function(e,t,n){e.exports={input__number:"InputNumber_input__number__2kkQW"}},function(e,t,n){e.exports={sticker:"PreviewArtObj_sticker__twuA7"}},function(e,t,n){e.exports={input__color:"ColorPicker_input__color__3EGb4"}},function(e,t,n){e.exports={canvas:"Canvas_canvas__Ak89z"}},function(e,t,n){e.exports={filter:"Filter_filter__16erS"}},function(e,t,n){e.exports={deleteArea:"DeleteArea_deleteArea__2KQym"}},function(e,t,n){e.exports={areaSelection:"AreaSelection_areaSelection__1Syux"}},function(e,t,n){},,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);n(55);var r=n(1),c=n.n(r),o=n(27),a=n.n(o),i=n(41),l=n.n(i),u=n(2),s=n(32),d=n.n(s),b=n(43),f=n.n(b),_=n(4),j=n(33),v=n.n(j),p=n(7),m=n(0),h=Object(r.forwardRef)((function(e,t){return Object(m.jsxs)("button",{onClick:e.onClick?e.onClick:function(){},className:v.a.button,ref:t,children:[Object(m.jsx)(p.a,{icon:e.icon}),""!==e.label&&Object(m.jsx)("span",{className:v.a.button__text,children:e.label})]})})),O=Object(u.b)(null,null,null,{forwardRef:!0})(h),x=n(22),g=n.n(x),E=Object(r.forwardRef)((function(e,t){return Object(m.jsxs)("button",{className:g.a.button,children:[Object(m.jsx)("label",{htmlFor:"input-file",className:g.a.icon,children:Object(m.jsx)(p.a,{icon:e.icon})}),Object(m.jsx)("input",{className:g.a.inputFile,type:"file",accept:".json",ref:t,id:"input-file"}),""!==e.label&&Object(m.jsx)("label",{className:g.a.button__text,htmlFor:"input-file",children:e.label})]})})),y=Object(u.b)(null,null,null,{forwardRef:!0})(E),T=n(6),S=n.n(T),w=n(9);function k(e){return L.apply(this,arguments)}function L(){return(L=Object(w.a)(S.a.mark((function e(t){var n,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=n})),r=new Image,e.next=4,n;case 4:return r.src=e.sent,e.next=7,r.decode();case 7:return e.abrupt("return",{width:r.width,height:r.height,src:r.src});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){return B.apply(this,arguments)}function B(){return(B=Object(w.a)(S.a.mark((function e(t){var n,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){var r=new FileReader;r.readAsText(t),r.onload=function(){return e(r.result)},r.onerror=n})),e.next=3,n;case 3:return r=e.sent,e.next=6,JSON.parse(r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C,R=n(3);function I(e,t,n){var r=[];return e.forEach((function(e){e.id===t?r.push(Object(R.a)(Object(R.a)({},e),n)):r.push(e)})),r}function A(e,t){var n=-1;return e.forEach((function(e,r){e.id===t&&(n=r)})),n}function F(e){if(!e)throw new Error("Assertion failed");return e}function D(e){return{type:"APPLY_FILE_PROJECT",project:e}}!function(e){e[e.img=0]="img",e[e.artObj=1]="artObj",e[e.text=2]="text"}(C||(C={}));var M,z={birthday_1:{name:"\u0421 \u0434\u043d\u0435\u043c \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f!",json:"./templates/birthday_1.json",preview:"./templates/birthday_1.png"},birthday_2:{name:"\u0421 \u0434\u043d\u0435\u043c \u0440\u043e\u0436\u0434\u0435\u043d\u0438\u044f!",json:"./templates/birthday_2.json",preview:"./templates/birthday_2.png"},february_23_1:{name:"\u0421 23 \u0444\u0435\u0432\u0440\u0430\u043b\u044f!",json:"./templates/february_23_1.json",preview:"./templates/february_23_1.png"},march_8_1:{name:"\u0421 8 \u043c\u0430\u0440\u0442\u0430!",json:"./templates/march_8_1.json",preview:"./templates/march_8_1.png"},march_8_2:{name:"\u0421 8 \u043c\u0430\u0440\u0442\u0430!",json:"./templates/march_8_2.json",preview:"./templates/march_8_2.png"},new_year_1:{name:"\u0421 \u043d\u043e\u0432\u044b\u043c \u0433\u043e\u0434\u043e\u043c!",json:"./templates/new_year_1.json",preview:"./templates/new_year_1.png"},new_year_2:{name:"\u0421 \u043d\u043e\u0432\u044b\u043c \u0433\u043e\u0434\u043e\u043c!",json:"./templates/new_year_2.json",preview:"./templates/new_year_2.png"},new_year_3:{name:"\u0421 \u043d\u043e\u0432\u044b\u043c \u0433\u043e\u0434\u043e\u043c!",json:"./templates/new_year_3.json",preview:"./templates/new_year_3.png"},september_1_1:{name:"\u0421 1 \u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f!",json:"./templates/september_1_1.json",preview:"./templates/september_1_1.png"}};!function(e){e.boy="./img/artObj/boy.png",e.frog="./img/artObj/frog.png",e.girl="./img/artObj/girl.png",e.loupe="./img/artObj/loupe.png",e.palette="./img/artObj/palette.png",e.pencil="./img/artObj/pencil.png",e.rainbow="./img/artObj/rainbow.png",e.snail="./img/artObj/snail.png"}(M||(M={}));var P=n(40),K=n(11);var U=function(e,t){switch(t.type){case"NEW_CARD_MAKER":case"RESET_BACKGROUND":return{color:"#ffffff",src:null,width:null,height:null};case"SET_BACKGROUND_COLOR":return{color:t.color,src:null,width:null,height:null};case"SET_BACKGROUND_IMG":return{color:null,src:t.src,width:t.width,height:t.height};default:return e}};var X=function(e,t){switch(t.type){case"NEW_CARD_MAKER":return{color:"#ffffff",opacity:0};case"SET_FILTER":return{color:t.color,opacity:t.opacity};default:return e}};var H=function(e,t){switch(t.type){case"NEW_CARD_MAKER":return 600;case"SET_CANVAS_SIZE":return t.height;default:return e}};function G(){return[Y(2),Y(1),Y(1),Y(1),Y(3)].join("-")}function Y(e){for(var t="",n=0;n<e;n++)t+=(65536*(1+Math.random())|0).toString(16).substring(1);return t}var W=function(e,t){switch(t.type){case"NEW_CARD_MAKER":return[];case"CREATE_TEXT_BLOCK":return[].concat(Object(K.a)(e),[{id:G(),type:C.text,color:"#898989",x:t.x-45,y:t.y-25,text:"<div>\u0422\u0435\u043a\u0441\u0442<br></div>",size:50,bold:!1,italic:!1,underline:!1,fontFamily:"OpenSans"}]);case"SET_SIZE_BLOCK":return I(e,t.id,{width:t.width,height:t.height});case"SET_TEXT_IN_TEXT_BLOCK":return I(e,t.id,{text:t.text});case"SET_FONT_FAMILY_TEXT":return I(e,t.id,{fontFamily:t.fontFamily});case"SET_BOLD_TEXT":return I(e,t.id,{bold:t.isBold});case"SET_ITALIC_TEXT":return I(e,t.id,{italic:t.isItalic});case"SET_UNDERLINE_TEXT":return I(e,t.id,{underline:t.isUnderline});case"SET_SIZE_TEXT":return I(e,t.id,{size:t.size});case"SET_COLOR_TEXT":return I(e,t.id,{color:t.color});case"CREATE_IMG_BLOCK":return[].concat(Object(K.a)(e),[{id:G(),type:C.img,width:t.width,height:t.height,x:t.x,y:t.y,src:t.src}]);case"CREATE_ART_OBJ_BLOCK":return[].concat(Object(K.a)(e),[{id:G(),type:C.artObj,width:150,height:150,x:t.x,y:t.y,src:t.src}]);case"DELETE_BLOCK":var n=Object(K.a)(e);return function(e){return Boolean(e)}(t.id)&&n.forEach((function(e,r){if(e.id===t.id)return n.splice(r,1),!1})),n;case"SET_POSITION_BLOCK":return I(e,t.id,{x:t.x,y:t.y});case"SHIFT_UP_BLOCK":var r=Object(K.a)(e);if(function(e,t){var n=t.length;return Boolean(e&&A(t,e)<n-1)}(t.id,e)){var c=A(r,t.id),o=[r[c+1],r[c]];r.splice.apply(r,[c,2].concat(o))}return r;case"SHIFT_DOWN_BLOCK":var a=Object(K.a)(e);if(function(e,t){return Boolean(e&&A(t,e)>0)}(t.id,e)){var i=A(a,t.id),l=[a[i],a[i-1]];a.splice.apply(a,[i-1,2].concat(l))}return a;default:return e}};var Z=function(e,t){switch(t.type){case"NEW_CARD_MAKER":return 800;case"SET_CANVAS_SIZE":return t.width;default:return e}};var J=function(e,t){return{width:Z(e.width,t),height:H(e.height,t),filter:X(e.filter,t),listBlock:W(e.listBlock,t),background:U(e.background,t),deleteArea:V(e.deleteArea,t)}};function V(e,t){switch(t.type){case"DELETE_AREA_SELECTION":return t.area?[].concat(Object(K.a)(e),[t.area]):e;case"NEW_CARD_MAKER":return[];default:return e}}var Q=function(e,t){switch(t.type){case"NEW_CARD_MAKER":case"RESET_SELECTED_BLOCK":return null;case"SET_SELECTED_BLOCK":return t.id;default:return e}};var q=function(e,t){switch(t.type){case"NEW_CARD_MAKER":return{listState:[J({},t)],currentIndex:0};case"ADD_HISTORY":var n=e.listState,r=e.currentIndex,c=Object(K.a)(e.listState);return r!==n.length-1&&c.splice(r+1,n.length-r+1),c.push(t.newCanvas),{currentIndex:r+1,listState:c};case"UNDO":var o=e.currentIndex,a=function(e){var t=e.listState.length,n=e.currentIndex;return t>1&&n>0}(e)?o-1:o;return Object(R.a)(Object(R.a)({},e),{},{currentIndex:a});case"REDO":var i=e.currentIndex,l=function(e){var t=e.listState.length;return e.currentIndex+1<t}(e)?i+1:i;return Object(R.a)(Object(R.a)({},e),{},{currentIndex:l});default:return e}};function $(e,t){switch(t.type){case"AREA_SELECTION":return{x:t.x,y:t.y,width:t.width,height:t.height};case"SET_POSITION_AREA_SELECTION":return Object(R.a)(Object(R.a)({},e.viewModel.areaSelection),{},{x:t.x,y:t.y});case"RESET_AREA_SELECTION":case"UNDO":case"REDO":return null;default:return e.viewModel.areaSelection}}function ee(e,t){switch(t.type){case"INPUT_BACKGROUND_COLOR":return t.color;case"UNDO":case"REDO":return null;default:return e.canvas.background.color}}function te(e,t){return"INPUT_BACKGROUND_IMG"===t.type?{width:t.width,height:t.height,src:t.src}:null}function ne(e,t){switch(t.type){case"INPUT_CANVAS_SIZE":return{width:t.width,height:t.height};case"UNDO":case"REDO":return null;default:return e.viewModel.canvasSize}}function re(e,t){switch(t.type){case"INPUT_FILTER":return{color:t.color,opacity:t.opacity};case"UNDO":case"REDO":return null;default:return e.viewModel.filter}}function ce(e,t){var n,r={color:null,size:null,bold:null,italic:null,underline:null,fontFamily:null,tempColor:null,tempSize:null};switch(t.type){case"CLICK_ON_TEXT":var c=(n=e.canvas.listBlock)[A(n,t.id)];return{color:c.color,tempColor:null,tempSize:null,size:c.size,bold:c.bold,italic:c.italic,underline:c.underline,fontFamily:c.fontFamily};case"SET_FONT_FAMILY_TEXT":return Object(R.a)(Object(R.a)({},e.viewModel.text),{},{fontFamily:t.fontFamily});case"INPUT_COLOR_TEXT":return Object(R.a)(Object(R.a)({},e.viewModel.text),{},{tempColor:t.color});case"INPUT_SIZE_TEXT":return Object(R.a)(Object(R.a)({},e.viewModel.text),{},{tempSize:t.size});case"SET_BOLD_TEXT":return Object(R.a)(Object(R.a)({},e.viewModel.text),{},{bold:t.isBold});case"SET_ITALIC_TEXT":return Object(R.a)(Object(R.a)({},e.viewModel.text),{},{italic:t.isItalic});case"SET_UNDERLINE_TEXT":return Object(R.a)(Object(R.a)({},e.viewModel.text),{},{underline:t.isUnderline});case"SET_SELECTED_BLOCK":case"RESET_SELECTED_BLOCK":case"UNDO":case"REDO":return r;default:return e.viewModel.text}}var oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return"NEW_CARD_MAKER"===t.type?{bgColor:null,bgImg:null,canvasSize:null,filter:null,text:{color:null,size:null,bold:null,italic:null,underline:null,fontFamily:null,tempColor:null,tempSize:null},areaSelection:null}:{bgColor:ee(e,t),bgImg:te(e,t),canvasSize:ne(e,t),filter:re(e,t),text:ce(e,t),areaSelection:$(e,t)}};var ae={id:"d3df27cd-3053-21a6-4abe-9db51cda7c17",type:C.artObj,width:150,height:150,x:20,y:280,src:"img/artObj/girl.png"},ie={width:800,height:800,filter:{color:"#c1e319",opacity:.05},listBlock:[{id:"4f406201-6f2f-b9ce-575e-438b1a7d1456",type:C.img,width:320,height:238,x:100,y:270,src:"https://images.pexels.com/photos/3337209/pexels-photo-3337209.jpeg?cs=srgb&dl=pexels-mo-3337209.jpg&fm=jpg"},ae,{id:"9a13a85a-59ee-7ba3-1c64-fcad25650fc1",type:C.text,x:200,y:280,text:"<div>\u042d\u0442\u043e</div><div>\u0437\u0430\u043a\u0430\u0442!!!</div>",size:40,bold:!0,italic:!0,underline:!0,color:"#ffffff",fontFamily:"Sensei"}],deleteArea:[{width:100,height:50,x:150,y:200},{width:70,height:50,x:350,y:175}],background:{color:null,src:"https://images.pexels.com/photos/8175462/pexels-photo-8175462.jpeg?auto=compress&cs=tinysrgb&h=650&w=940",width:867,height:650}},le={canvas:ie,selectBlock:null,history:{listState:[ie],currentIndex:0},viewModel:{bgColor:null,bgImg:null,canvasSize:null,filter:null,text:{color:null,size:null,bold:null,italic:null,underline:null,fontFamily:null,tempColor:null,tempSize:null},areaSelection:null}},ue=["NEW_CARD_MAKER","ADD_HISTORY","AFTER_CHANGE_HISTORY","UNDO","REDO","SET_SELECTED_BLOCK","RESET_SELECTED_BLOCK","INPUT_SIZE_TEXT","INPUT_COLOR_TEXT","SET_SIZE_TEXT","SET_POSITION_AREA_SELECTION","RESET_AREA_SELECTION","AREA_SELECTION","INPUT_FILTER","INPUT_CANVAS_SIZE","INPUT_BACKGROUND_IMG","INPUT_BACKGROUND_COLOR"],se=["UNDO","REDO"],de=Object(P.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AFTER_CHANGE_HISTORY":return t.cardMaker;case"APPLY_FILE_PROJECT":return t.project;default:return{canvas:J(e.canvas,t),selectBlock:Q(e.selectBlock,t),history:q(e.history,t),viewModel:oe(e,t)}}}),le,Object(P.a)((function(e){return function(t){return function(n){var r=e.getState(),c=t(n),o=e.getState();return ue.includes(n.type)||JSON.stringify(r.canvas)!==JSON.stringify(o.canvas)&&(console.log("\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u0438"),e.dispatch({type:"ADD_HISTORY",newCanvas:o.canvas})),c}}}),(function(e){return function(t){return function(n){var r=t(n);if(se.includes(n.type)&&"AFTER_CHANGE_HISTORY"!==n.type){var c=e.getState().history.listState[e.getState().history.currentIndex],o=Object(R.a)(Object(R.a)({},e.getState()),{},{canvas:c});e.dispatch({type:"AFTER_CHANGE_HISTORY",cardMaker:o})}return r}}})));var be=n(10),fe=n(44),_e=n(12),je=n.n(_e),ve=Object(u.b)()((function(e){var t=e.visible,n=void 0!==t&&t,c=e.title,o=void 0===c?"":c,a=e.content,i=void 0===a?"":a,l=e.footer,u=void 0===l?"":l,s=e.onClose;return Object(r.useEffect)((function(){var e=function(e){if("Escape"===e.key)s()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[s]),n?Object(m.jsx)("div",{className:je.a.modal,onClick:s,children:Object(m.jsxs)("div",{className:je.a.modalDialog,onClick:function(e){return e.stopPropagation()},children:[Object(m.jsxs)("div",{className:je.a.modalHeader,children:[Object(m.jsx)("h3",{className:je.a.modalTitle,children:o}),Object(m.jsx)("span",{className:je.a.modalClose,onClick:s,children:Object(m.jsx)(p.a,{icon:_.p})})]}),Object(m.jsx)("div",{className:je.a.modalBody,children:Object(m.jsx)("div",{className:je.a.modalContent,children:i})}),u&&Object(m.jsx)("div",{className:je.a.modalFooter,children:u})]})}):null}));var pe=Object(u.b)(null,(function(e){return{newCardMaker:function(){return e({type:"NEW_CARD_MAKER"})}}}))((function(e){var t=Object(r.useState)(!1),n=Object(be.a)(t,2),c=n[0],o=n[1],a=function(){return o(!1)},i=Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("p",{children:"\u041d\u0435\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u044b"}),Object(m.jsx)("p",{children:"\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c ?"})]}),l=Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{onClick:function(){e.newCardMaker(),a()},children:"\u0414\u0430"}),Object(m.jsx)("button",{onClick:a,children:"\u041d\u0435\u0442"})]});return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(O,{label:"\u041d\u043e\u0432\u0430\u044f",icon:fe.a,onClick:function(){return o(!0)}}),Object(m.jsx)(ve,{visible:c,title:"\u041d\u043e\u0432\u0430\u044f \u043e\u0442\u043a\u0440\u044b\u0442\u043a\u0430",content:i,footer:l,onClose:a})]})})),me=n(45);function he(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(w.a)(S.a.mark((function e(t){var n,r,c,o,a,i,l,u,s,d,b,f,_,j,v;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=de.getState().canvas.listBlock,r=de.getState().canvas.deleteArea,c=de.getState().canvas.width,o=de.getState().canvas.height,a=de.getState().canvas.background,i=de.getState().canvas.filter,(l=document.createElement("canvas")).width=c,l.height=o,u=l.getContext("2d"),!a.src){e.next=23;break}return(s=new Image).crossOrigin="anonymous",s.src=a.src,e.next=16,s.decode();case 16:d=s.width,b=s.height,s.width<c&&(b=s.height*c/s.width,d=s.width*b/s.height),s.height<o&&(d=s.width*o/s.height,b=s.height*d/s.width),u.drawImage(s,0,0,d,b),e.next=24;break;case 23:a.color&&(u.fillStyle=a.color,u.fillRect(0,0,c,o));case 24:f=0;case 25:if(!(f<n.length)){e.next=31;break}return e.next=28,xe(n[f],u);case 28:f++,e.next=25;break;case 31:_=ye(i.color),u.fillStyle="rgba(".concat(_.r,", ").concat(_.g,", ").concat(_.b,", ").concat(i.opacity,")"),u.fillRect(0,0,c,o),u.fillStyle="#ffffff",r.forEach((function(e){u.fillRect(e.x,e.y,e.width,e.height)})),j=l.toDataURL(t),(v=document.createElement("a")).href=j,v.download="new-image",v.click();case 41:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e,t){return ge.apply(this,arguments)}function ge(){return(ge=Object(w.a)(S.a.mark((function e(t,n){var r,c,o,a,i,l,u,s,d,b,f,_,j;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=5,c=1.2,e.t0=t.type,e.next=e.t0===C.text?5:e.t0===C.img?12:e.t0===C.artObj?19:26;break;case 5:o=Ee(t),(a=document.createElement("div")).innerHTML=t.text,i=0,l=Object(me.a)(Array.from(a.children));try{for(l.s();!(u=l.n()).done;){if(s=u.value,n.fillStyle=o.color,n.font=o.italic+" "+o.weight+" "+o.size+"px "+o.family,n.fillText(s.innerText,t.x+r,t.y+i+o.size),t.underline){for(d=n.measureText(s.innerText).width,b=0,f="";s.innerText.length>b;)f+="_",b++;n.font="700 ".concat(o.size,"px openSans"),n.fillText(f,t.x+r,t.y+i+o.size,d)}i+=t.size*c}}catch(v){l.e(v)}finally{l.f()}return e.abrupt("break",26);case 12:return(_=new Image).crossOrigin="anonymous",_.src=t.src,e.next=17,_.decode();case 17:return n.drawImage(_,t.x,t.y,t.width,t.height),e.abrupt("break",26);case 19:return(j=new Image).crossOrigin="anonymous",j.src=t.src,e.next=24,j.decode();case 24:return n.drawImage(j,t.x,t.y,t.width,t.height),e.abrupt("break",26);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(e){return{x:e.x,y:e.y,color:e.color,size:e.size,weight:e.bold?"700":"",italic:e.italic?"italic":"",family:e.fontFamily}}function ye(e){"#"===e.substring(0,1)&&(e=e.substring(1));var t={r:255,g:255,b:255};return t.r=parseInt(e.substring(0,2),16),t.g=parseInt(e.substring(2,4),16),t.b=parseInt(e.substring(4),16),t}var Te=Object(u.b)()((function(){var e=Object(r.useRef)(null),t=Object(r.useState)(!1),n=Object(be.a)(t,2),c=n[0],o=n[1],a=function(){return o(!1)},i=Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("p",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u043e\u0440\u043c\u0430\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c\u043e\u0433\u043e \u0444\u0430\u0439\u043b\u0430"})}),l=Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{onClick:function(){he("image/jpeg"),a()},children:"jpg"}),Object(m.jsx)("button",{onClick:function(){he("image/png"),a()},children:"png"}),Object(m.jsx)("button",{onClick:a,children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]});return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(O,{label:"\u0412 jpg/png",icon:_.k,onClick:function(){return o(!0)},ref:e}),Object(m.jsx)(ve,{visible:c,title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u043a...",content:i,footer:l,onClose:a})]})})),Se=n(23),we=n.n(Se);var ke=Object(u.b)()((function(e){return Object(m.jsxs)("div",{className:we.a.dropdown,children:[Object(m.jsxs)("button",{className:we.a.dropbtn,children:[Object(m.jsx)(p.a,{icon:e.icon,size:e.sizeIcon}),""!==e.label&&Object(m.jsx)("span",{className:we.a.dropdown_text,children:e.label})]}),Object(m.jsx)("div",{className:we.a.dropdown_content,style:{minWidth:e.minWidth},children:e.children})]})})),Le=n(34),Ne=n.n(Le);var Be=Object(u.b)(null,(function(e){return{applyFileProject:function(t){return e(D(t))}}}))((function(e){var t=Object(r.useState)(!1),n=Object(be.a)(t,2),c=n[0],o=n[1],a=function(){return o(!1)},i=function(){var t=Object(w.a)(S.a.mark((function t(){var n;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e.srcJson);case 2:return n=t.sent,t.t0=e,t.next=6,n.json();case 6:t.t1=t.sent,t.t0.applyFileProject.call(t.t0,t.t1),a();case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),l=Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("p",{children:"\u041d\u0435\u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0431\u0443\u0434\u0443\u0442 \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u044b"}),Object(m.jsx)("p",{children:"\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c ?"})]}),u=Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{onClick:i,children:"\u0414\u0430"}),Object(m.jsx)("button",{onClick:a,children:"\u041d\u0435\u0442"})]}),s=Object(r.useRef)(null);return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:Ne.a.preview,onClick:function(){return o(!0)},children:[Object(m.jsx)("img",{src:e.srcImg,alt:"",ref:s,className:Ne.a.img}),Object(m.jsx)("p",{children:e.name})]}),Object(m.jsx)(ve,{visible:c,title:"\u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0448\u0430\u0431\u043b\u043e\u043d\u0430",content:l,footer:u,onClose:a})]})}));var Ce=Object(u.b)(null,(function(e){return{undo:function(){return e({type:"UNDO"})},redo:function(){return e({type:"REDO"})},applyFileProject:function(t){return e(D(t))}}}))((function(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null);!function(e,t,n,c){Object(r.useEffect)((function(){var r=e.current,o=t.current;function a(){n()}function i(){c()}function l(e){"KeyZ"===e.code&&(e.ctrlKey||e.metaKey)&&n(),"KeyY"===e.code&&(e.ctrlKey||e.metaKey)&&c()}return F(r).addEventListener("click",a),F(o).addEventListener("click",i),document.addEventListener("keydown",l),function(){r&&r.removeEventListener("click",a),o&&o.removeEventListener("click",i),document.removeEventListener("keydown",l)}}),[e,t,n,c])}(t,n,e.undo,e.redo);var c,o=Object(r.useRef)(null),a=Object(r.useRef)(null);!function(e,t){Object(r.useEffect)((function(){var n=e.current;function r(e){return c.apply(this,arguments)}function c(){return(c=Object(w.a)(S.a.mark((function e(n){var r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.target,c=r.files,e.prev=2,e.t0=t,e.next=6,N(c[0]);case 6:e.t1=e.sent,(0,e.t0)(e.t1),e.next=13;break;case 10:e.prev=10,e.t2=e.catch(2),alert("\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438");case 13:r.value="";case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}return F(n).addEventListener("change",r),function(){n&&n.removeEventListener("change",r)}}),[e,t])}(o,e.applyFileProject),c=a,Object(r.useEffect)((function(){var e=c.current;function t(e){var t=de.getState(),n=JSON.stringify(Object(R.a)(Object(R.a)({},t),{},{history:{listState:[t.canvas],currentIndex:0}})),r=new Blob([n],{type:"application/json"}),c=document.createElement("a");c.href=URL.createObjectURL(r),c.download="\u041d\u043e\u0432\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442.json",c.click()}return F(e).addEventListener("click",t),function(){e&&e.removeEventListener("click",t)}}),[c]);var i=Object.values(z),l=[];return i.forEach((function(e,t){l.push(Object(m.jsx)(Be,{name:e.name,srcImg:e.preview,srcJson:e.json},t))})),Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("nav",{className:f.a.navbar,children:[Object(m.jsx)(y,{label:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c",icon:_.h,ref:o}),Object(m.jsx)(pe,{}),Object(m.jsx)(Te,{}),Object(m.jsx)(O,{label:"\u0432 json",icon:_.g,ref:a,onClick:null}),Object(m.jsx)(ke,{minWidth:450,label:"\u0428\u0430\u0431\u043b\u043e\u043d\u044b",icon:_.d,sizeIcon:"1x",children:l}),Object(m.jsx)(O,{label:"",icon:_.s,ref:t,onClick:null}),Object(m.jsx)(O,{label:"",icon:_.m,ref:n,onClick:null})]})})})),Re=n(46),Ie=n.n(Re),Ae=n(18),Fe=n.n(Ae);function De(e){return{type:"SET_BOLD_TEXT",id:de.getState().selectBlock,isBold:e}}function Me(e){return{type:"SET_ITALIC_TEXT",id:de.getState().selectBlock,isItalic:e}}function ze(e){return{type:"SET_UNDERLINE_TEXT",id:de.getState().selectBlock,isUnderline:e}}var Pe=n(35),Ke=n.n(Pe);var Ue=Object(u.b)()((function(e){var t=Object(r.useRef)(null);return function(e,t,n,c){Object(r.useEffect)((function(){var r=e.current;function o(e){null!==t?(n(!t),e.preventDefault()):c||n(!0)}return F(r).addEventListener("click",o),function(){r&&r.removeEventListener("click",o)}}),[e,n,t,c])}(t,e.enabled,e.modifyFn,e.param),Object(m.jsx)("button",{className:Ke.a.button+" "+(e.enabled?Ke.a.active:""),ref:t,children:Object(m.jsx)(p.a,{icon:e.icon})})})),Xe=n(47),He=n.n(Xe);var Ge=Object(u.b)((function(e){return{color:e.viewModel.text.color}}),(function(e){return{setColorText:function(t){return e(function(e){return{type:"SET_COLOR_TEXT",id:de.getState().selectBlock,color:e}}(t))},inputColorText:function(t){return e(function(e){return{type:"INPUT_COLOR_TEXT",color:e}}(t))}}}))((function(e){var t=Object(r.useRef)(null);return function(e,t,n,c){Object(r.useEffect)((function(){var r=t.current;function o(e){var t=e.target;c(t.value)}function a(e){var t=e.target;n(t.value)}function i(e){e.stopImmediatePropagation()}return F(r).value=e||"#000000",F(r).addEventListener("input",o),F(r).addEventListener("change",a),F(r).addEventListener("click",i),function(){r&&(r.removeEventListener("input",o),r.removeEventListener("change",a),r.removeEventListener("click",i))}}),[e,t,n,c])}(e.color,t,e.setColorText,e.inputColorText),Object(m.jsx)("input",{type:"color",ref:t,className:He.a.input})})),Ye=n(48),We=n.n(Ye);var Ze=Object(u.b)((function(e){return{size:e.viewModel.text.size,tempSize:e.viewModel.text.tempSize}}),(function(e){return{setSizeText:function(t){return e(function(e){return{type:"SET_SIZE_TEXT",id:de.getState().selectBlock,size:e}}(t))},inputSizeText:function(t){return e(function(e){return{type:"INPUT_SIZE_TEXT",size:e}}(t))}}}))((function(e){var t,n,c,o,a=Object(r.useRef)(null);return t=e.size,n=a,c=e.setSizeText,o=e.inputSizeText,Object(r.useEffect)((function(){var e=n.current;function r(e){var t=e.target;o(Number(t.value))}function a(e){var t=e.target;c(Number(t.value))}function i(e){e.stopImmediatePropagation()}return F(e).value=t?String(t):"10",F(e).addEventListener("input",r),F(e).addEventListener("blur",a),F(e).addEventListener("click",i),function(){e&&(e.removeEventListener("input",r),e.removeEventListener("blur",a),e.removeEventListener("click",i))}}),[t,n,c,o]),Object(m.jsx)("input",{type:"number",ref:a,className:We.a.input__number,min:10,max:150,step:1})})),Je=n(8),Ve=n.n(Je);var Qe=Object(u.b)((function(e){var t,n=null;return(null===(t=e.viewModel.text)||void 0===t?void 0:t.fontFamily)&&(n=e.viewModel.text.fontFamily),{fontFamily:n}}),(function(e){return{setFontFamilyText:function(t){return e(function(e){return{type:"SET_FONT_FAMILY_TEXT",id:de.getState().selectBlock,fontFamily:e}}(t))}}}))((function(e){var t=Object(r.useRef)(null);!function(e,t){Object(r.useEffect)((function(){var n=e.current;function r(e){e.stopImmediatePropagation()}function c(e){var n=e.target;t(n.value)}return F(n).addEventListener("click",r),F(n).addEventListener("change",c),function(){n&&(n.removeEventListener("click",r),n.removeEventListener("change",c))}}),[e,t])}(t,e.setFontFamilyText);var n=[{value:"Fantazyor",class:Ve.a.fantazyor},{value:"Piroucyrillic",class:Ve.a.piroucyrillic},{value:"Phenomena",class:Ve.a.phenomena},{value:"Sunday",class:Ve.a.sunday},{value:"Kurale",class:Ve.a.kurale},{value:"Sensei",class:Ve.a.sensei},{value:"Borsok",class:Ve.a.borsok},{value:"Summer",class:Ve.a.summer},{value:"Underdog",class:Ve.a.underdog},{value:"Montserrat",class:Ve.a.montserrat},{value:"OpenSans",class:Ve.a.openSans},{value:"Comfortaa",class:Ve.a.comfortaa},{value:"Rubik",class:Ve.a.rubik},{value:"Marta",class:Ve.a.marta}].map((function(e,t){return Object(m.jsx)("option",{className:e.class,value:e.value,children:e.value},t)})),c=n[0].props.className;return n=n.map((function(t){return t.props.value===e.fontFamily?(c=t.props.className,Object(R.a)(Object(R.a)({},t),{},{props:Object(R.a)(Object(R.a)({},t.props),{},{selected:!0})})):t})),Object(m.jsx)("select",{name:"",id:"",className:Ve.a.select+" "+c,ref:t,children:n})}));var qe=Object(u.b)((function(e){return{bold:e.viewModel.text.bold,italic:e.viewModel.text.italic,underline:e.viewModel.text.underline}}),(function(e){return{createTextBlock:function(){return e({type:"CREATE_TEXT_BLOCK",x:de.getState().canvas.width/2,y:de.getState().canvas.height/2})},setBoldText:function(t){return e(De(t))},setItalicText:function(t){return e(Me(t))},setUnderlineText:function(t){return e(ze(t))}}}))((function(e){return Object(m.jsxs)("div",{className:Fe.a.toolbar,children:[Object(m.jsxs)("div",{className:Fe.a.toolbar__row,children:[Object(m.jsx)(Qe,{}),Object(m.jsx)(Ue,{icon:_.i,enabled:null,modifyFn:e.createTextBlock,param:!1})]}),Object(m.jsxs)("div",{className:Fe.a.toolbar__row,children:[Object(m.jsx)(Ze,{}),Object(m.jsx)(Ue,{icon:_.c,enabled:e.bold,modifyFn:e.setBoldText,param:!0}),Object(m.jsx)(Ue,{icon:_.l,enabled:e.italic,modifyFn:e.setItalicText,param:!0}),Object(m.jsx)(Ue,{icon:_.r,enabled:e.underline,modifyFn:e.setUnderlineText,param:!0}),Object(m.jsx)("div",{className:Fe.a.colorPickerBox,children:Object(m.jsx)(Ge,{})})]}),Object(m.jsx)("label",{className:Fe.a.toolbar__label,children:"\u0422\u0435\u043a\u0441\u0442"})]})})),$e=n(28),et=n.n($e),tt=n(36),nt=n.n(tt),rt=Object(r.forwardRef)((function(e,t){return Object(m.jsxs)("button",{ref:t,className:nt.a.button,title:e.title,children:[Object(m.jsx)(p.a,{icon:e.icon,size:"lg"}),""!==e.label&&Object(m.jsx)("span",{className:nt.a.button__text,children:e.label})]})})),ct=Object(u.b)(null,null,null,{forwardRef:!0})(rt),ot=n(24),at=n.n(ot),it=Object(r.forwardRef)((function(e,t){return Object(m.jsxs)("button",{className:at.a.button,children:[Object(m.jsx)("label",{htmlFor:"input-file-img",className:at.a.icon,children:Object(m.jsx)(p.a,{icon:e.icon,size:"lg"})}),Object(m.jsx)("input",{className:at.a.inputFile,type:"file",accept:".png,.jpg,.jfif,.jpe,.jpeg",ref:t,id:"input-file-img"}),""!==e.label&&Object(m.jsx)("label",{className:at.a.button__text,htmlFor:"input-file-img",children:e.label})]})})),lt=Object(u.b)(null,null,null,{forwardRef:!0})(it),ut=n(49),st=n.n(ut);var dt=Object(u.b)(null,(function(e){return{createArtObjBlock:function(t){return e(function(e){return{type:"CREATE_ART_OBJ_BLOCK",src:e,x:de.getState().canvas.width/2-75,y:de.getState().canvas.height/2-75}}(t))}}}))((function(e){var t,n,c,o=Object(r.useRef)(null);return t=o,n=e.src,c=e.createArtObjBlock,Object(r.useEffect)((function(){var e=t.current;function r(){c(n)}return F(e).addEventListener("click",r),function(){e&&e.removeEventListener("click",r)}}),[t,n,c]),Object(m.jsx)("img",{src:e.src,alt:"",ref:o,className:st.a.sticker})}));var bt=Object(u.b)(null,(function(e){return{createImgBlock:function(t,n,r){return e(function(e,t,n){return{type:"CREATE_IMG_BLOCK",src:e,width:t,height:n,x:de.getState().canvas.width/2-t/2,y:de.getState().canvas.height/2-n/2}}(t,n,r))}}}))((function(e){var t=Object.values(M),n=[];t.forEach((function(e,t){n.push(Object(m.jsx)(dt,{src:e},t))}));var c=Object(r.useRef)(null);return function(e,t){Object(r.useEffect)((function(){var n=e.current;function r(e){return c.apply(this,arguments)}function c(){return(c=Object(w.a)(S.a.mark((function e(n){var r,c,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.target,c=r.files,e.prev=2,e.next=5,k(c[0]);case 5:o=e.sent,t(o.src,o.width,o.height),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),alert("\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438");case 12:r.value="";case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}return F(n).addEventListener("change",r),function(){n&&n.removeEventListener("change",r)}}),[e,t])}(c,e.createImgBlock),Object(m.jsxs)("div",{className:et.a.toolbar,children:[Object(m.jsxs)("div",{className:et.a.button_box,children:[Object(m.jsx)(lt,{label:"",title:"C \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430",icon:_.e,ref:c}),Object(m.jsx)(ct,{label:"",title:"\u0418\u0437 Pixels",icon:_.j}),Object(m.jsx)(ke,{minWidth:200,label:"",icon:_.o,sizeIcon:"lg",children:n})]}),Object(m.jsx)("label",{className:et.a.toolbar__label,children:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f"})]})})),ft=n(25),_t=n.n(ft),jt=n(50),vt=n.n(jt),pt=Object(r.forwardRef)((function(e,t){return Object(m.jsx)("input",{type:"color",ref:t,className:vt.a.input__color})})),mt=Object(u.b)(null,null,null,{forwardRef:!0})(pt);function ht(e,t){return{type:"SET_CANVAS_SIZE",width:e,height:t}}function Ot(e,t,n,r){return{type:"AREA_SELECTION",x:e,y:t,width:n,height:r}}var xt=Object(u.b)((function(e){return{filter:e.canvas.filter}}),(function(e){return{inputFilter:function(t,n){return e(function(e,t){return{type:"INPUT_FILTER",color:e,opacity:t}}(t,n))},setFilter:function(t,n){return e(function(e,t){return{type:"SET_FILTER",color:e,opacity:t}}(t,n))}}}))((function(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null);return function(e,t,n,c,o){Object(r.useEffect)((function(){var r=e.current,a=t.current;function i(){if(a&&r){var e=r.value,t=Number(a.value);n(e,t)}}function l(){if(a&&r){var e=Number(a.value),t=r.value;c(t,e)}}return F(r).value=o.color,F(a).value=String(o.opacity),F(r).addEventListener("input",i),F(r).addEventListener("change",l),F(a).addEventListener("input",i),F(a).addEventListener("change",l),function(){r&&(r.removeEventListener("input",i),r.removeEventListener("change",l)),a&&(a.removeEventListener("input",i),a.removeEventListener("change",l))}}),[e,t,n,c,o])}(t,n,e.inputFilter,e.setFilter,e.filter),Object(m.jsxs)("div",{className:_t.a.toolbar,children:[Object(m.jsx)("div",{className:_t.a.colorPickerBox,children:Object(m.jsx)(mt,{ref:t})}),Object(m.jsx)("input",{type:"range",min:"0",max:"0.2",step:"0.025",className:_t.a.input_range,ref:n}),Object(m.jsx)("label",{className:_t.a.toolbar__label,children:"\u0424\u0438\u043b\u044c\u0442\u0440"})]})})),gt=n(13),Et=n.n(gt),yt=n(26),Tt=n.n(yt);var St=Object(u.b)((function(e){return{ViewModelBgImg:e.viewModel.bgImg}}),(function(e){return{inputBackgroundImg:function(t,n,r){return e(function(e,t,n){return{type:"INPUT_BACKGROUND_IMG",src:e,width:t,height:n}}(t,n,r))},setBackgroundImg:function(t,n,r){return e(function(e,t,n){return{type:"SET_BACKGROUND_IMG",src:e,width:t,height:n}}(t,n,r))},setCanvasSize:function(t,n){return e(ht(t,n))}}}))((function(e){var t,n=Object(r.useRef)(null),c=Object(r.useState)(!1),o=Object(be.a)(c,2),a=o[0],i=o[1],l=function(){return i(!1)};!function(e,t,n,c){Object(r.useEffect)((function(){var r=de.getState().canvas.width,o=de.getState().canvas.height,a=e.current;function i(e){return l.apply(this,arguments)}function l(){return(l=Object(w.a)(S.a.mark((function e(a){var i,l,u;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.target,l=i.files,e.prev=2,e.next=5,k(l[0]);case 5:u=e.sent,r<u.width||o<u.height?(n(u.src,u.width,u.height),c(!0)):t(u.src,u.width,u.height),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),alert("\u0422\u0435\u043a\u0441\u0442 \u043e\u0448\u0438\u0431\u043a\u0438");case 12:i.value="";case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}return F(a).addEventListener("change",i),function(){a&&a.removeEventListener("change",i)}}),[e,t,n,c])}(n,e.setBackgroundImg,e.inputBackgroundImg,i);var u=null!==(t=e.ViewModelBgImg)&&void 0!==t?t:{width:0,height:0,src:""},s=Object(m.jsx)(m.Fragment,{children:Object(m.jsx)("p",{children:"\u0418\u0441\u0445\u043e\u0434\u043d\u043e\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u043e\u043b\u044c\u0448\u0435 \u0440\u0430\u0437\u043c\u0435\u0440\u0430 \u0445\u043e\u043b\u0441\u0442\u0430"})}),d=Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("button",{onClick:function(){e.setBackgroundImg(u.src,u.width,u.height),e.setCanvasSize(u.width,u.height),l()},children:"\u0420\u0430\u0441\u0442\u044f\u043d\u0443\u0442\u044c \u0445\u043e\u043b\u0441\u0442"}),Object(m.jsx)("button",{onClick:function(){e.setBackgroundImg(u.src,u.width,u.height),l()},children:"\u041e\u0431\u0440\u0435\u0437\u0430\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"}),Object(m.jsx)("button",{onClick:l,children:"\u041e\u0442\u043c\u0435\u043d\u0430"})]});return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(ve,{visible:a,title:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435",content:s,footer:d,onClose:l}),Object(m.jsxs)("button",{className:Tt.a.button,title:e.title,children:[Object(m.jsx)("label",{htmlFor:"input-file-bg-img",className:Tt.a.icon,children:Object(m.jsx)(p.a,{icon:e.icon})}),Object(m.jsx)("input",{className:Tt.a.inputFile,type:"file",accept:".png,.jpg,.jfif,.jpe,.jpeg",id:"input-file-bg-img",ref:n}),""!==e.label&&Object(m.jsx)("label",{className:Tt.a.button__text,htmlFor:"input-file-bg-img",children:e.label})]})]})})),wt=n(37),kt=n.n(wt),Lt=Object(r.forwardRef)((function(e,t){return Object(m.jsxs)("button",{className:kt.a.button,ref:t,title:e.title,style:{textAlign:""===e.label?"center":"left"},children:[Object(m.jsx)(p.a,{icon:e.icon}),""!==e.label&&Object(m.jsx)("span",{className:kt.a.button_text,children:e.label})]})})),Nt=Object(u.b)(null,null,null,{forwardRef:!0})(Lt);var Bt=Object(u.b)((function(e){return{background:e.canvas.background}}),(function(e){return{resetBackground:function(){return e({type:"RESET_BACKGROUND"})},inputBackgroundColor:function(t){return e(function(e){return{type:"INPUT_BACKGROUND_COLOR",color:e}}(t))},setBackgroundColor:function(t){return e(function(e){return{type:"SET_BACKGROUND_COLOR",color:e}}(t))}}}))((function(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null);return function(e,t,n,c,o,a){Object(r.useEffect)((function(){var r=o.current,c=a.current;function i(){e()}function l(e){var n=e.target;t(n.value)}function u(e){var t=e.target.value;n(t)}return F(r).addEventListener("input",l),F(r).addEventListener("change",u),F(c).addEventListener("click",i),function(){r&&(r.removeEventListener("input",l),r.removeEventListener("change",u)),c&&c.removeEventListener("click",i)}}),[e,t,n,c,o,a]),Object(r.useEffect)((function(){F(o.current).value=c.color?c.color:"#ffffff"}),[o,c])}(e.resetBackground,e.inputBackgroundColor,e.setBackgroundColor,e.background,t,n),Object(m.jsxs)("div",{className:Et.a.toolbar,children:[Object(m.jsxs)("div",{className:Et.a.toolbar__row,children:[Object(m.jsx)("div",{className:Et.a.toolbar__col1,children:Object(m.jsxs)("div",{className:Et.a.button_container,children:[Object(m.jsx)(St,{label:"C \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430",title:"C \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u0430",icon:_.e}),Object(m.jsx)(Nt,{label:"\u0418\u0437 Pixels",title:"\u0418\u0437 Pixels",icon:_.j})]})}),Object(m.jsxs)("div",{className:Et.a.toolbar__col2,children:[Object(m.jsx)("div",{className:Et.a.colorPickerBox,children:Object(m.jsx)(mt,{ref:t})}),Object(m.jsx)(Nt,{label:"\u0421\u0431\u0440\u043e\u0441",title:"\u0421\u0431\u0440\u043e\u0441",icon:_.n,ref:n})]})]}),Object(m.jsx)("label",{className:Et.a.toolbar__label,children:"\u0424\u043e\u043d"})]})})),Ct=n(38),Rt=n.n(Ct);var It=Object(u.b)(null,(function(e){return{deleteAreaSelection:function(){return e({type:"DELETE_AREA_SELECTION",area:de.getState().viewModel.areaSelection})},resetAreaSelection:function(){return e({type:"RESET_AREA_SELECTION"})}}}))((function(e){var t=Object(r.useRef)(null);return function(e,t,n){Object(r.useEffect)((function(){var r=e.current;function c(){t(),n()}function o(e){e.preventDefault()}return F(r).addEventListener("click",c),F(r).addEventListener("mousedown",o),function(){r&&r.removeEventListener("click",c),r&&r.removeEventListener("mousedown",o)}}),[e,t,n])}(t,e.deleteAreaSelection,e.resetAreaSelection),Object(m.jsxs)("div",{className:Rt.a.toolbar,children:[Object(m.jsx)(Nt,{ref:t,label:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435",title:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435",icon:_.f}),Object(m.jsx)("label",{className:Rt.a.toolbar__label,children:"\u041e\u0431\u043b\u0430\u0441\u0442\u044c"})]})})),At=n(19),Ft=n.n(At);function Dt(e){return{type:"SET_SELECTED_BLOCK",id:e}}function Mt(e,t){return{type:"SET_SIZE_BLOCK",id:de.getState().selectBlock,width:e,height:t}}function zt(){return{type:"DELETE_BLOCK",id:de.getState().selectBlock}}function Pt(e,t){return{type:"SET_POSITION_BLOCK",id:de.getState().selectBlock,x:e,y:t}}var Kt=Object(u.b)(null,(function(e){return{shiftUpBlock:function(){return e({type:"SHIFT_UP_BLOCK",id:de.getState().selectBlock})},shiftDownBlock:function(){return e({type:"SHIFT_DOWN_BLOCK",id:de.getState().selectBlock})},deleteBlock:function(){return e(zt())}}}))((function(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null),c=Object(r.useRef)(null);return function(e,t,n,c){Object(r.useEffect)((function(){var r=e.current,o=t.current;function a(e){e.preventDefault(),n()}function i(e){e.preventDefault(),c()}return F(r).addEventListener("click",a),F(o).addEventListener("click",i),function(){r&&r.removeEventListener("click",a),o&&o.removeEventListener("click",i)}}),[e,t,n,c])}(t,n,e.shiftUpBlock,e.shiftDownBlock),function(e,t){Object(r.useEffect)((function(){var n=e.current;function r(){t()}function c(e){"Delete"===e.code&&t()}return F(n).addEventListener("click",r),document.addEventListener("keydown",c),function(){n&&n.removeEventListener("click",r),document.removeEventListener("keydown",c)}}),[e,t])}(c,e.deleteBlock),Object(m.jsxs)("div",{className:Ft.a.toolbar,children:[Object(m.jsxs)("div",{className:Ft.a.toolbar__row,children:[Object(m.jsx)("div",{children:Object(m.jsxs)("div",{className:Ft.a.button_container,children:[Object(m.jsx)(Nt,{ref:t,label:"",title:"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0432\u043f\u0435\u0440\u0435\u0434",icon:_.b}),Object(m.jsx)(Nt,{ref:n,label:"",title:"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u043d\u0430\u0437\u0430\u0434",icon:_.a})]})}),Object(m.jsx)("div",{className:Ft.a.toolbar__col,children:Object(m.jsx)(Nt,{ref:c,label:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",icon:_.q})})]}),Object(m.jsx)("label",{className:Ft.a.toolbar__label,children:"\u041e\u0431\u044a\u0435\u043a\u0442\u044b"})]})})),Ut=n(16),Xt=n.n(Ut);var Ht=Object(u.b)((function(e){return{width:e.canvas.width,height:e.canvas.height}}),(function(e){return{inputCanvasSize:function(t,n){return e(function(e,t){return{type:"INPUT_CANVAS_SIZE",width:e,height:t}}(t,n))},setCanvasSize:function(t,n){return e(ht(t,n))}}}))((function(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null);return function(e,t,n,c,o,a){Object(r.useEffect)((function(){var r=e.current,i=t.current;function l(){if(r&&i){var e=Number(r.value),t=Number(i.value);n(e,t)}}function u(){if(r&&i){var e=Number(r.value),t=Number(i.value);c(e,t)}}return F(r).value=String(o),F(i).value=String(a),F(r).addEventListener("change",l),F(r).addEventListener("blur",u),F(i).addEventListener("change",l),F(i).addEventListener("blur",u),function(){r&&(r.removeEventListener("change",l),r.removeEventListener("blur",u)),i&&(i.removeEventListener("change",l),i.removeEventListener("blur",u))}}),[e,t,n,c,o,a])}(t,n,e.inputCanvasSize,e.setCanvasSize,e.width,e.height),Object(m.jsxs)("div",{className:Xt.a.toolbar,children:[Object(m.jsxs)("div",{className:Xt.a.toolbar__row,children:[Object(m.jsx)("input",{type:"number",className:Xt.a.input_number,min:"0",ref:t}),Object(m.jsx)(p.a,{icon:_.p,className:Xt.a.label}),Object(m.jsx)("input",{type:"number",className:Xt.a.input_number,min:"0",ref:n})]}),Object(m.jsx)("label",{className:Xt.a.toolbar__label,children:"\u0425\u043e\u043b\u0441\u0442"})]})}));var Gt=Object(u.b)()((function(){return Object(m.jsxs)("div",{className:Ie.a.toolbar,children:[Object(m.jsx)(qe,{}),Object(m.jsx)(bt,{}),Object(m.jsx)(Bt,{}),Object(m.jsx)(It,{}),Object(m.jsx)(xt,{}),Object(m.jsx)(Kt,{}),Object(m.jsx)(Ht,{})]})}));var Yt=Object(u.b)()((function(){return Object(m.jsx)("header",{className:d.a.header,children:Object(m.jsxs)("div",{className:d.a.panel,children:[Object(m.jsx)(Ce,{}),Object(m.jsx)(Gt,{})]})})})),Wt=n(51),Zt=n.n(Wt),Jt=n(14),Vt=n.n(Jt);function Qt(e,t,n,c){Object(r.useEffect)((function(){var r=t.current;function o(){de.getState().selectBlock!==e&&setTimeout((function(){n(e)}))}function a(t){var n=t.defaultPrevented,o=de.getState().selectBlock===e;!n&&o&&t.target!==r&&c()}return document.addEventListener("click",a),F(r).addEventListener("mousedown",o),function(){r&&r.removeEventListener("mousedown",o),document.removeEventListener("click",a)}}),[e,t,n,c])}function qt(e,t,n){Object(r.useEffect)((function(){var r,c,o=e.current;function a(e){r={x:e.pageX,y:e.pageY},document.addEventListener("mousemove",i),document.addEventListener("mouseup",l)}function i(e){if(!e.defaultPrevented){e.preventDefault();var n={x:e.pageX-r.x,y:e.pageY-r.y};c={x:t.x+n.x,y:t.y+n.y},F(o).style.left=String(c.x)+"px",F(o).style.top=String(c.y)+"px"}}function l(){c&&n(c.x,c.y),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",l)}return F(o).addEventListener("mousedown",a),function(){o&&o.removeEventListener("mousedown",a)}}),[e,t,n])}function $t(e,t,n,c,o,a,i,l,u){Object(r.useEffect)((function(){var r,s,d=i.current,b=n,f=c,_=o,j=a;function v(e){switch(e.preventDefault(),e.target){case b.current:s="LT";break;case f.current:s="RT";break;case _.current:s="LB";break;case j.current:s="RB"}r={x:e.pageX+(5-e.offsetX),y:e.pageY+(5-e.offsetY)},document.addEventListener("mousemove",g),document.addEventListener("mouseup",y)}var p,m=u.width,h=u.height,O=u.width,x=u.height;function g(e){e.preventDefault();var t={x:e.pageX-r.x,y:e.pageY-r.y},n={x:0,y:0};switch(s){case"LT":var c=E({x:-t.x,y:-t.y},O,x),o=Object(be.a)(c,2);m=o[0],h=o[1],n={x:u.width-m,y:u.height-h};break;case"RT":var a=E({x:t.x,y:-t.y},O,x),i=Object(be.a)(a,2);m=i[0],h=i[1],n={x:0,y:u.height-h};break;case"LB":var b=E({x:-t.x,y:t.y},O,x),f=Object(be.a)(b,2);m=f[0],h=f[1],n={x:u.width-m,y:0};break;case"RB":var _=E(t,O,x),j=Object(be.a)(_,2);m=j[0],h=j[1]}F(d).style.width=String(m)+"px",F(d).style.height=String(h)+"px",p={x:l.x+n.x,y:l.y+n.y},F(d).style.left=String(p.x)+"px",F(d).style.top=String(p.y)+"px",O=m,x=h}function E(e,t,n){return e.x/t<e.y/n?(h=u.height+e.y,m=t*(h=h<20?20:h)/n):(m=u.width+e.x,h=n*(m=m<20?20:m)/t),[m,h]}function y(){e(m,h),p&&t(p.x,p.y),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",y)}return F(b.current).addEventListener("mousedown",v),F(f.current).addEventListener("mousedown",v),F(_.current).addEventListener("mousedown",v),F(j.current).addEventListener("mousedown",v),function(){b.current&&b.current.removeEventListener("mousedown",v),f.current&&f.current.removeEventListener("mousedown",v),_.current&&_.current.removeEventListener("mousedown",v),j.current&&j.current.removeEventListener("mousedown",v)}}),[e,t,n,c,o,a,i,l,u])}var en=Object(u.b)((function(e){return{selectBlock:e.selectBlock}}),(function(e){return{setPositionBlock:function(t,n){return e(Pt(t,n))},setSizeBlock:function(t,n){return e(Mt(t,n))},setSelectedBlock:function(t){return e(Dt(t))},resetSelectedBlock:function(){return e({type:"RESET_SELECTED_BLOCK"})}}}))((function(e){var t=e.img,n="";t.src&&(n=t.src);var c=function(e){return{width:e.width,height:e.height,left:e.x,top:e.y}}(t),o=Object(r.useRef)(null),a=Object(r.useRef)(null),i=Object(r.useRef)(null),l=Object(r.useRef)(null),u=Object(r.useRef)(null);Qt(e.img.id,o,e.setSelectedBlock,e.resetSelectedBlock),qt(o,{x:t.x,y:t.y},e.setPositionBlock),$t(e.setSizeBlock,e.setPositionBlock,a,i,l,u,o,{x:t.x,y:t.y},{width:t.width,height:t.height});var s=e.img.id===e.selectBlock?Vt.a.selected:"";return Object(m.jsxs)("div",{className:Vt.a.block+" "+s,style:c,ref:o,onDragStart:function(e){return e.preventDefault()},children:[Object(m.jsx)("div",{className:Vt.a.pointTopLeft,ref:a}),Object(m.jsx)("div",{className:Vt.a.pointTopRight,ref:i}),Object(m.jsx)("img",{src:n,alt:"",className:Vt.a.img}),Object(m.jsx)("div",{className:Vt.a.pointBottomLeft,ref:l}),Object(m.jsx)("div",{className:Vt.a.pointBottomRight,ref:u})]})})),tn=n(39),nn=n.n(tn);var rn=Object(u.b)((function(e){return{selectBlock:e.selectBlock,color:e.viewModel.text.tempColor,size:e.viewModel.text.tempSize}}),(function(e){return{setPositionBlock:function(t,n){return e(Pt(t,n))},setSelectedBlock:function(t){return e(Dt(t))},resetSelectedBlock:function(){return e({type:"RESET_SELECTED_BLOCK"})},setTextInTextBlock:function(t){return e(function(e){return{type:"SET_TEXT_IN_TEXT_BLOCK",id:de.getState().selectBlock,text:e}}(t))},clickOnText:function(){return e({type:"CLICK_ON_TEXT",id:de.getState().selectBlock})},deleteBlock:function(){return e(zt())},setBoldText:function(t){return e(De(t))},setItalicText:function(t){return e(Me(t))},setUnderlineText:function(t){return e(ze(t))}}}))((function(e){var t,n,c,o,a,i,l,u,s,d,b=e.text,f=Object(r.useRef)(null);Qt(e.text.id,f,e.setSelectedBlock,e.resetSelectedBlock),qt(f,{x:b.x,y:b.y},e.setPositionBlock),t=f,n=b.bold,c=b.italic,o=b.underline,a=e.setTextInTextBlock,i=e.clickOnText,l=e.deleteBlock,u=e.setBoldText,s=e.setItalicText,d=e.setUnderlineText,Object(r.useEffect)((function(){var e=t.current;function r(){setTimeout((function(){i()}))}function b(){F(e).setAttribute("contenteditable","true"),F(e).focus()}function f(){e&&(e.setAttribute("contenteditable","false"),"<div><br></div>"===e.innerHTML?l():a(e.innerHTML))}function _(t){"true"===F(e).getAttribute("contenteditable")&&t.stopImmediatePropagation()}function j(t){"Escape"===t.code&&"true"===F(e).getAttribute("contenteditable")&&(F(e).setAttribute("contenteditable","false"),a(F(e).innerHTML)),"Delete"===t.code&&t.stopImmediatePropagation(),"KeyB"===t.code&&(t.ctrlKey||t.metaKey)&&u(!n),"KeyI"===t.code&&(t.ctrlKey||t.metaKey)&&s(!c),"KeyU"===t.code&&(t.ctrlKey||t.metaKey)&&d(!o)}function v(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}function p(t){e&&("<"===e.innerHTML[0]&&"<br>"!==e.innerHTML||(e.innerHTML="<div>".concat(e.innerText,"<br></div>"),e.focus()))}return F(e).addEventListener("mousedown",r),F(e).addEventListener("dblclick",b),F(e).addEventListener("blur",f),F(e).addEventListener("keydown",j),F(e).addEventListener("paste",v),F(e).addEventListener("input",p),document.addEventListener("mousemove",_),function(){e&&(e.removeEventListener("mousedown",r),e.removeEventListener("dblclick",b),e.addEventListener("blur",f),e.removeEventListener("keydown",j),e.removeEventListener("paste",v),e.removeEventListener("input",p)),document.removeEventListener("mousemove",_)}}),[t,n,c,o,a,i,l,u,s,d]);var _=e.text.id===e.selectBlock?nn.a.selected:"",j=function(e){return{left:e.x,top:e.y,color:e.color,fontSize:e.size,fontWeight:e.bold?700:400,textDecoration:e.underline?"underline":"none",fontStyle:e.italic?"italic":"normal",fontFamily:e.fontFamily}}(b);return j=Object(R.a)(Object(R.a)({},j),{},{color:e.color&&""!==_?e.color:j.color,fontSize:e.size&&""!==_?e.size:j.fontSize}),Object(m.jsx)("div",{style:j,contentEditable:!1,suppressContentEditableWarning:!0,onDragStart:function(e){return e.preventDefault()},ref:f,className:nn.a.block+" "+_,dangerouslySetInnerHTML:{__html:b.text}})})),cn=n(15),on=n.n(cn);var an=Object(u.b)((function(e){return{selectBlock:e.selectBlock}}),(function(e){return{setPositionBlock:function(t,n){return e(Pt(t,n))},setSizeBlock:function(t,n){return e(Mt(t,n))},setSelectedBlock:function(t){return e(Dt(t))},resetSelectedBlock:function(){return e({type:"RESET_SELECTED_BLOCK"})}}}))((function(e){var t=e.artObj,n=Object(r.useRef)(null),c=function(e){return{width:e.width,height:e.height,left:e.x,top:e.y}}(t),o=Object(r.useRef)(null),a=Object(r.useRef)(null),i=Object(r.useRef)(null),l=Object(r.useRef)(null);Qt(e.artObj.id,n,e.setSelectedBlock,e.resetSelectedBlock),qt(n,{x:t.x,y:t.y},e.setPositionBlock),$t(e.setSizeBlock,e.setPositionBlock,o,a,i,l,n,{x:t.x,y:t.y},{width:t.width,height:t.height});var u=e.artObj.id===e.selectBlock?on.a.selected:"";return Object(m.jsxs)("div",{className:on.a.block+" "+u,style:c,ref:n,onDragStart:function(e){return e.preventDefault()},children:[Object(m.jsx)("div",{className:on.a.pointTopLeft,ref:o}),Object(m.jsx)("div",{className:on.a.pointTopRight,ref:a}),Object(m.jsx)("img",{src:t.src,alt:"",className:on.a.img}),Object(m.jsx)("div",{className:on.a.pointBottomLeft,ref:i}),Object(m.jsx)("div",{className:on.a.pointBottomRight,ref:l})]})})),ln=n(52),un=n.n(ln);var sn=Object(u.b)((function(e){return{canvas:e.canvas,filter:e.viewModel.filter}}))((function(e){var t=e.canvas,n="",r=0;e.filter?(n=e.filter.color,r=e.filter.opacity):(n=t.filter.color,r=t.filter.opacity);var c={background:n,opacity:r};return Object(m.jsx)("div",{className:un.a.filter,style:c,id:"filter"})})),dn=n(53),bn=n.n(dn);var fn=Object(u.b)((function(e){return{canvas:e.canvas}}))((function(e){var t=e.canvas,n=[];return t.deleteArea.forEach((function(e,t){var r={width:e.width,height:e.height,left:e.x,top:e.y};n.push(Object(m.jsx)("div",{className:bn.a.deleteArea,style:r},t))})),Object(m.jsx)(m.Fragment,{children:n})})),_n=n(54),jn=n.n(_n),vn=Object(r.forwardRef)((function(e,t){var n;return n={left:e.area.x,top:e.area.y,width:e.area.width-2,height:e.area.height-2},qt(t,{x:e.area.x,y:e.area.y},e.setPositionAreaSelection),Object(m.jsx)("div",{className:jn.a.areaSelection,style:n,ref:t})})),pn=Object(u.b)(null,(function(e){return{areaSelection:function(t,n,r,c){return e(Ot(t,n,r,c))},resetAreaSelection:function(){return e({type:"RESET_AREA_SELECTION"})},setPositionAreaSelection:function(t,n){return e(function(e,t){return{type:"SET_POSITION_AREA_SELECTION",x:e,y:t}}(t,n))}}}),null,{forwardRef:!0})(vn);var mn=Object(u.b)((function(e){return{canvas:e.canvas,area:e.viewModel.areaSelection,bgColor:e.viewModel.bgColor,canvasSize:e.viewModel.canvasSize}}),(function(e){return{areaSelection:function(t,n,r,c){return e(Ot(t,n,r,c))},resetAreaSelection:function(){return e({type:"RESET_AREA_SELECTION"})}}}))((function(e){var t=function(e,t,n){var r="#fff",c="";t?r=t:e.background.color?r=e.background.color:e.background.src&&(c="url("+e.background.src+")");var o=0,a=0;n?(o=n.width,a=n.height):(o=e.width,a=e.height);var i=e.background.width,l=e.background.height;return{width:o,height:a,backgroundColor:r,backgroundImage:c,backgroundSize:i&&l?hn(i,l,o,a):""}}(e.canvas,e.bgColor,e.canvasSize),n=function(e){var t=[];return e.forEach((function(e){switch(e.type){case C.text:t.push(Object(m.jsx)(rn,{text:e},e.id));break;case C.img:t.push(Object(m.jsx)(en,{img:e},e.id));break;case C.artObj:t.push(Object(m.jsx)(an,{artObj:e},e.id))}})),t}(e.canvas.listBlock),c=Object(r.useRef)(null),o=Object(r.useRef)(null);return function(e,t,n,c){Object(r.useEffect)((function(){var r,o,a=e.current,i=t.current,l=document.createElement("div");function u(e){e.defaultPrevented||e.target!==a||(r={x:e.pageX,y:e.pageY},o={x:e.offsetX,y:e.offsetY},document.addEventListener("mousemove",s),document.addEventListener("mouseup",d),l.style.border="1px dashed red",l.style.width="0px",l.style.height="0px",l.style.left=e.offsetX+"px",l.style.top=e.offsetY+"px",a&&a.appendChild(l))}function s(e){if(!e.defaultPrevented){var t={x:Math.abs(e.pageX-r.x),y:Math.abs(e.pageY-r.y)},n={x:0,y:0};r.x>=e.pageX&&r.y>=e.pageY?n={x:-t.x,y:-t.y}:r.x<=e.pageX&&r.y>=e.pageY?n={x:0,y:-t.y}:r.x>=e.pageX&&r.y<=e.pageY&&(n={x:-t.x,y:0}),l.style.width=t.x+"px",l.style.height=t.y+"px",l.style.left=o.x+n.x+"px",l.style.top=o.y+n.y+"px"}}function d(){l.offsetWidth>2&&l.offsetHeight>2&&n(l.offsetLeft,l.offsetTop,l.offsetWidth,l.offsetHeight),l.remove(),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",d)}function b(e){!e.defaultPrevented&&t.current&&(e.preventDefault(),t.current!==e.target&&c())}function f(e){e.preventDefault()}return l.style.position="absolute",l.style.zIndex="1",l.style.pointerEvents="none",F(a).addEventListener("mousedown",u),i&&i.addEventListener("mousedown",f),document.addEventListener("mousedown",b),function(){a&&a.removeEventListener("mousedown",u),i&&i.removeEventListener("mousedown",f),document.removeEventListener("mousedown",b)}}),[e,t,n,c])}(c,o,e.areaSelection,e.resetAreaSelection),Object(m.jsxs)("div",{id:"canvas",className:Zt.a.canvas,style:t,ref:c,children:[e.area&&Object(m.jsx)(pn,{area:e.area,ref:o}),e.canvas.deleteArea&&Object(m.jsx)(fn,{}),Object(m.jsx)(sn,{}),n]})}));function hn(e,t,n,r){var c=e,o=t;return c<n&&(e=c*(t=o*n/c)/o),o<r&&(t=o*(e=c*r/o)/c),"".concat(e,"px ").concat(t,"px")}var On=Object(u.b)()((function(){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Yt,{}),Object(m.jsx)("main",{className:l.a.main,children:Object(m.jsx)(mn,{})})]})}));de.subscribe((function(){})),a.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(u.a,{store:de,children:Object(m.jsx)(On,{})})}),document.getElementById("root"))}],[[70,1,2]]]);
//# sourceMappingURL=main.2a0a8808.chunk.js.map