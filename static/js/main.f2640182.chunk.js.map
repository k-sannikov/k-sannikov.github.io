{"version":3,"sources":["cardMaker/toolbar/toolbarText/selectFontFamily/SelectFontFamily.module.css","cardMaker/toolbar/modalSearchImg/ModalSearchImg.module.css","cardMaker/toolbar/toolbarCanvas/ToolbarCanvas.module.css","cardMaker/modal/Modal.module.css","cardMaker/canvas/img/Img.module.css","cardMaker/canvas/artObj/ArtObj.module.css","cardMaker/toolbar/toolbarText/ToolbarText.module.css","cardMaker/dropdownMenu/DropdownMenu.module.css","cardMaker/toolbar/toolbarImg/addImgButtonFile/AddImgButtonFile.module.css","cardMaker/toolbar/toolbarFilter/ToolbarFilter.module.css","cardMaker/toolbar/toolbarBackground/ToolbarBackground.module.css","cardMaker/toolbar/toolbarBackground/fileImgButton/FileImgButton.module.css","cardMaker/toolbar/topToolbar/navbar/navButton/NavFileButton/NavFileButton.module.css","cardMaker/canvas/text/Text.module.css","cardMaker/toolbar/toolbarText/buttonEditText/ButtonEditText.module.css","cardMaker/toolbar/toolbarImg/ToolbarImg.module.css","cardMaker/toolbar/toolbarImg/addImgByUrlButton/AddImgByUrlButton.module.css","cardMaker/toolbar/toolbarBackground/addBackgroundByUrlButton/AddBackgroundByUrlButton.module.css","cardMaker/toolbar/button/Button.module.css","cardMaker/toolbar/topToolbar/TopToolbar.module.css","cardMaker/toolbar/topToolbar/navbar/navButton/NavButton/NavButton.module.css","cardMaker/toolbar/topToolbar/navbar/previewTemplate/PreviewTemplate.module.css","cardMaker/CardMaker.module.css","cardMaker/canvas/Canvas.module.css","cardMaker/canvas/filter/Filter.module.css","cardMaker/canvas/deleteArea/DeleteArea.module.css","cardMaker/canvas/areaSelection/AreaSelection.module.css","cardMaker/toolbar/Toolbar.module.css","cardMaker/toolbar/toolbarText/colorPicker/ColorPicker.module.css","cardMaker/toolbar/toolbarText/inputNumber/InputNumber.module.css","cardMaker/toolbar/toolbarImg/previewArtObj/PreviewArtObj.module.css","cardMaker/toolbar/modalSearchImg/loadingIndicator/LoadingIndicator.module.css","cardMaker/toolbar/colorPicker/ColorPicker.module.css","cardMaker/toolbar/toolbarObject/ToolbarObject.module.css","cardMaker/toolbar/topToolbar/navbar/Navbar.module.css","store/reducers/BackgroundReducer.ts","store/reducers/FilterReducer.ts","store/reducers/HeightCanvasReducer.ts","store/types.ts","utils/elementList.ts","utils/permisions.ts","utils/guid.ts","store/reducers/ListBlockReducer.ts","store/reducers/WidthCanvasReducer.ts","store/reducers/CanvasReducer.ts","store/reducers/SelectBlockReducer.ts","store/reducers/HistoryReducer.ts","store/reducers/ViewModel/AreaSelectionReducer.ts","store/reducers/ViewModel/BgColorReducer.ts","store/reducers/ViewModel/BgImgReducer.ts","store/reducers/ViewModel/CanvasSizeReducer.ts","store/reducers/ViewModel/FilterReducer.ts","store/reducers/ViewModel/TextReducer.ts","store/reducers/ViewModel/ViewModelReducer.ts","store/initialState.ts","store/store.ts","store/reducers/CardMakerReducer.ts","store/actionCreators/historyActionCreators.ts","cardMaker/canvas/useStateBlock.ts","cardMaker/canvas/useDragAndDrop.ts","utils/size.ts","cardMaker/canvas/useResize.ts","store/actionCreators/blockActionCreators.ts","cardMaker/canvas/img/Img.tsx","store/actionCreators/textBlockActionCreators.ts","cardMaker/canvas/text/Text.tsx","cardMaker/canvas/text/useEditText.ts","cardMaker/canvas/artObj/ArtObj.tsx","cardMaker/canvas/filter/Filter.tsx","cardMaker/canvas/deleteArea/DeleteArea.tsx","store/actionCreators/canvasActionCreators.ts","cardMaker/canvas/areaSelection/AreaSelection.tsx","cardMaker/canvas/areaSelection/useAreaSelection.ts","cardMaker/canvas/Canvas.tsx","cardMaker/toolbar/toolbarText/buttonEditText/ButtonEditText.tsx","cardMaker/toolbar/toolbarText/buttonEditText/useEditStateText.ts","cardMaker/toolbar/toolbarText/colorPicker/ColorPicker.tsx","cardMaker/toolbar/toolbarText/colorPicker/useEditColorText.ts","cardMaker/toolbar/toolbarText/inputNumber/InputNumber.tsx","cardMaker/toolbar/toolbarText/inputNumber/useEditFontSize.ts","cardMaker/toolbar/toolbarText/selectFontFamily/SelectFontFamily.tsx","cardMaker/toolbar/toolbarText/selectFontFamily/useSelectFont.ts","cardMaker/toolbar/toolbarText/ToolbarText.tsx","cardMaker/dropdownMenu/DropdownMenu.tsx","cardMaker/toolbar/toolbarImg/addImgButtonFile/AddImgButtonFile.tsx","cardMaker/toolbar/toolbarImg/previewArtObj/PreviewArtObj.tsx","store/actionCreators/artObjBlockActionCreators.ts","cardMaker/toolbar/toolbarImg/previewArtObj/useCreateArtObj.ts","utils/files.ts","store/actionCreators/imgBlockActionCreators.ts","cardMaker/toolbar/modalSearchImg/useGetPhotoAPI.ts","cardMaker/toolbar/modalSearchImg/Img.tsx","cardMaker/toolbar/modalSearchImg/loadingIndicator/LoadingIndicator.tsx","cardMaker/toolbar/modalSearchImg/ModalSearchImg.tsx","cardMaker/toolbar/toolbarImg/addImgByUrlButton/useCreateImgByUrl.ts","cardMaker/toolbar/toolbarImg/addImgByUrlButton/AddImgByUrlButton.tsx","cardMaker/toolbar/toolbarImg/ToolbarImg.tsx","cardMaker/toolbar/toolbarImg/useCreateImg.ts","cardMaker/toolbar/colorPicker/ColorPicker.tsx","cardMaker/toolbar/toolbarFilter/ToolbarFilter.tsx","cardMaker/toolbar/toolbarFilter/useStateFilter.ts","cardMaker/modal/Modal.tsx","cardMaker/toolbar/toolbarBackground/fileImgButton/FileImgButton.tsx","cardMaker/toolbar/toolbarBackground/useBackgroungImg.ts","cardMaker/toolbar/toolbarBackground/addBackgroundByUrlButton/useAddBackgroundByUrl.ts","cardMaker/toolbar/toolbarBackground/addBackgroundByUrlButton/AddBackgroundByUrlButton.tsx","cardMaker/toolbar/toolbarBackground/ToolbarBackground.tsx","cardMaker/toolbar/toolbarBackground/useBackgroungColor.ts","cardMaker/toolbar/button/Button.tsx","cardMaker/toolbar/toolbarObject/ToolbarObject.tsx","cardMaker/toolbar/toolbarObject/useBlockLevel.ts","cardMaker/toolbar/toolbarObject/useBlockDelete.ts","cardMaker/toolbar/toolbarCanvas/ToolbarCanvas.tsx","cardMaker/toolbar/toolbarCanvas/useStateCanvasSize.ts","cardMaker/toolbar/toolbarCanvas/useDeleteArea.ts","cardMaker/toolbar/topToolbar/navbar/navButton/NavButton/NavButton.tsx","cardMaker/toolbar/topToolbar/navbar/navButton/NavFileButton/NavFileButton.tsx","store/actionCreators/cardMakerActionCreators.ts","cardMaker/toolbar/topToolbar/navbar/navButton/NewProjectButton/NewProjectButton.tsx","utils/color.ts","utils/exportInImage.ts","cardMaker/toolbar/topToolbar/navbar/navButton/ExportImgButton/ExportImgButton.tsx","cardMaker/toolbar/topToolbar/navbar/previewTemplate/PreviewTemplate.tsx","cardMaker/toolbar/topToolbar/navbar/Navbar.tsx","cardMaker/toolbar/topToolbar/navbar/useStateHistory.ts","cardMaker/toolbar/topToolbar/navbar/useExportFileProject.ts","cardMaker/toolbar/topToolbar/navbar/useImportFileProject.ts","cardMaker/toolbar/topToolbar/TopToolbar.tsx","cardMaker/toolbar/Toolbar.tsx","cardMaker/CardMaker.tsx","index.tsx"],"names":["module","exports","background","action","type","color","src","width","height","filter","opacity","heightCanvas","BlockTypes","SetOfArtObject","templates","birthday_1","name","json","preview","birthday_2","february_23_1","march_8_1","march_8_2","new_year_1","new_year_2","new_year_3","september_1_1","setComponentFields","listBlock","id","modifiableFields","newListBlock","forEach","component","push","getIndexById","foundIndex","block","index","verify","value","Error","createGUID","gen","join","count","out","i","Math","random","toString","substring","text","x","y","size","bold","italic","underline","fontFamily","isBold","isItalic","isUnderline","img","artObj","copyListBlock","Boolean","isSelectedBlock","splice","length","isShiftUpAvailable","flipValue","isShiftDownAvailable","widthCanvas","canvas","deleteArea","area","selectBlock","history","listState","currentIndex","newListState","newCanvas","newCurrentIndex","isUndoAvailable","isRedoAvailable","areaSelection","cardMaker","viewModel","bgColor","bgImg","canvasSize","list","defState","tempColor","tempSize","testCanvas","testCardMaker","exceptions","store","createStore","project","applyMiddleware","next","oldState","getState","result","includes","newState","JSON","stringify","dispatch","useStateBlock","blockId","setSelectedBlock","resetSelectedBlock","useEffect","currentBlock","current","mouseDownCurrentBlock","handleMousedownBlock","setTimeout","handleClickDocument","event","isDefPrev","defaultPrevented","isSelectedID","target","document","addEventListener","removeEventListener","useDragAndDrop","defPos","setPositionBlock","startPos","newPos","handleMousedown","pageX","pageY","handleMouseMove","handleMouseUp","preventDefault","delta","style","left","top","calcWidthByHeight","initWidth","initHeight","baseHeight","calcHeightByWidth","baseWidth","calcSizeImgByCanvas","imgW","imgH","canvasW","canvasH","newHeight","calcSizeByWidth","newWidth","calcSizeByHeight","useResize","setSizeBlock","LT","RT","LB","RB","defSize","point","pointLT","pointRT","pointLB","pointRB","offsetX","offsetY","prevWidth","prevHeight","moving","calculateSize","deleteBlock","connect","state","props","imgStyle","getStyle","imgBlock","useRef","select","styles","selected","className","ref","onDragStart","e","pointTopLeft","pointTopRight","alt","pointBottomLeft","pointBottomRight","setBoldText","setItalicText","setUnderlineText","setTextInTextBlock","clickOnText","textBlock","handleDblclickBlock","setAttribute","focus","handleBlur","innerHTML","getAttribute","stopImmediatePropagation","handlerKeydown","code","execCommand","ctrlKey","metaKey","handlerPaste","clipboardData","getData","handlerInput","innerText","textStyle","fontSize","fontWeight","textDecoration","fontStyle","contentEditable","suppressContentEditableWarning","dangerouslySetInnerHTML","__html","artObjBlock","artObjStyle","filterStyle","deleteAreaStyle","setCanvasSize","setBackgroundImg","inputBackgroundImg","AreaSelection","forwardRef","resetAreaSelection","startOffsetPos","field","selectArea","div","createElement","border","appendChild","abs","offsetWidth","offsetHeight","offsetLeft","offsetTop","remove","handleMousedownDocument","handleMousedownArea","position","zIndex","pointerEvents","useAreaSelection","setPositionAreaSelection","areaSelectionStyle","canvasStyle","backgroundColor","backgroundImage","bgWidth","bgHeight","bgSize","backgroundSize","getListBlock","button","enabled","modifyFn","param","btn","handleClickButton","useEditStateText","active","icon","setColorText","inputColorText","colorPicker","inputColor","handleInput","handleChange","handleClick","useEditColorText","input","setSizeText","inputSizeText","inputNumber","fieldSize","Number","String","input__number","min","max","step","setFontFamilyText","selectFontFamily","useSelectFont","fontFamilies","class","robotoSlab","fantazyor","piroucyrillic","phenomena","sunday","kurale","sensei","borsok","summer","underdog","montserrat","openSans","comfortaa","rubik","marta","map","element","currentStyle","createTextBlock","toolbar","toolbar__row","faFont","faBold","faItalic","faUnderline","colorPickerBox","dropdown","dropbtn","dropdownText","label","dropdownContent","minWidth","children","AddImgButton","htmlFor","inputFile","accept","buttonText","createArtObjBlock","artObjPreview","handleClickArtObj","sticker","getImgInformationFromFile","fileImg","a","promise","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","onerror","Image","decode","getProjectFromFile","file","readAsText","parse","createImgBlock","search","query","split","fetch","headers","response","useImg","baseSrc","setModal","loading","LoadingIndicator","cssloadSpinBox","visible","onClose","onKeydown","key","buttonSearch","buttonNext","buttonBack","loadingIndicator","information","useState","images","setImages","setNext","back","setBack","btnSearch","btnNext","btnBack","handlerClickSearch","display","renderImg","photos","next_page","handlerClickLink","link","prev_page","arr","item","large","visibility","useGetPhotoAPI","images1","images2","onCloseModal","modal","onClick","modalDialog","stopPropagation","modalHeader","modalTitle","modalClose","faTimes","searchBox","navBox","modalBody","modalContent","modalFooter","useCreateImgByUrl","url","image","handlerClick","newImage","AddImgByUrlButton","isModal","srcList","Object","values","imgList","handlerChangeInput","files","alert","useCreateImg","button_box","AddImgButtonFile","faDownload","faGlobe","faStickyNote","ColorPicker","input__color","inputFilter","setFilter","inputRange","fieldColor","fieldRange","handleInputFilter","handleChangeFilter","useStateFilter","row","title","content","footer","viewModelBgImg","handlerChange","useBackgroungImg","bg","useAddBackgroundByUrl","photo","Button","isModalSearchImg","setModalSearchImg","onCloseModalSearchImg","button_text","resetBackground","inputBackgroundColor","setBackgroundColor","buttonReset","handlerClickResetColor","handlerInputColor","handleerChangeColor","useBackgroungColor","FileImgButton","AddBackgroundByUrlButton","reset","faRetweet","shiftUpBlock","shiftDownBlock","buttonUp","buttonDown","buttonDelete","btnUp","btnDown","handlerClickShiftUp","handlerClickShiftDown","useBlockLevel","handlerClickDelete","useBlockDelete","faArrowUp","faArrowDown","faTrash","inputCanvasSize","deleteAreaSelection","inputWidth","inputHeight","fieldWidth","fieldHeight","handleChangeSize","handleBlurSize","useStateCanvasSize","handleMousedownButton","useDeleteArea","unitsLabel","faEraser","NavButton","button__text","NavFileButton","applyFileProject","newCardMaker","faPiedPiperSquare","convertColor","rgbColor","r","g","b","parseInt","exportInImage","canvasWidth","canvasHeight","elements","deleteAreas","canvasElement","ctx","getContext","crossOrigin","drawImage","fillStyle","fillRect","renderBlock","dataURL","toDataURL","href","download","click","renderText","renderArtObj","weight","family","shift","Array","from","str","font","fillText","textWidth","measureText","chars","downloadImg","faImage","template","onAccept","srcJson","srcImg","undo","redo","buttonUndo","buttonRedo","btnUndo","btnRedo","handlerClickUndo","handlerClickRedo","useStateHistory","downloadButton","downloadFile","handlerChangeInputFile","useImportFileProject","handlerClickSaveToJson","Blob","URL","createObjectURL","previewList","tmp","navbar","faFolderOpen","faFileExport","faClone","faUndo","faRedo","header","mainLabel","TopToolbar","main","window","returnValue","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.f2640182.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"select\":\"SelectFontFamily_select__-xsBg\",\"robotoSlab\":\"SelectFontFamily_robotoSlab__27hZJ\",\"fantazyor\":\"SelectFontFamily_fantazyor__M9yoI\",\"piroucyrillic\":\"SelectFontFamily_piroucyrillic__29ewu\",\"phenomena\":\"SelectFontFamily_phenomena__NRqnd\",\"sunday\":\"SelectFontFamily_sunday__1H2GQ\",\"kurale\":\"SelectFontFamily_kurale__3Hg9L\",\"sensei\":\"SelectFontFamily_sensei__M0k1g\",\"borsok\":\"SelectFontFamily_borsok__uN7nG\",\"summer\":\"SelectFontFamily_summer__1iu_f\",\"underdog\":\"SelectFontFamily_underdog__1VSS1\",\"montserrat\":\"SelectFontFamily_montserrat__2gZbq\",\"openSans\":\"SelectFontFamily_openSans__20d1g\",\"comfortaa\":\"SelectFontFamily_comfortaa__3j5F8\",\"rubik\":\"SelectFontFamily_rubik__3P7MR\",\"marta\":\"SelectFontFamily_marta__JO1cQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"ModalSearchImg_modal__uBBh1\",\"appear\":\"ModalSearchImg_appear__1G1Sw\",\"modalDialog\":\"ModalSearchImg_modalDialog__1idJU\",\"animatetop\":\"ModalSearchImg_animatetop__lbfEH\",\"slide-in\":\"ModalSearchImg_slide-in__3tA5h\",\"modalHeader\":\"ModalSearchImg_modalHeader__3KLzI\",\"modalFooter\":\"ModalSearchImg_modalFooter__2HKjX\",\"modalClose\":\"ModalSearchImg_modalClose__3YhCx\",\"modalBody\":\"ModalSearchImg_modalBody__dyHSE\",\"modalContent\":\"ModalSearchImg_modalContent__2Q6UH\",\"modalTitle\":\"ModalSearchImg_modalTitle__1vEB0\",\"searchBox\":\"ModalSearchImg_searchBox__1QOP1\",\"navBox\":\"ModalSearchImg_navBox__1nyG-\",\"information\":\"ModalSearchImg_information__3v8sD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarCanvas_toolbar__1lWFF\",\"inputNumber\":\"ToolbarCanvas_inputNumber__3FE9W\",\"row\":\"ToolbarCanvas_row__1CFS7\",\"label\":\"ToolbarCanvas_label__1kyuR\",\"unitsLabel\":\"ToolbarCanvas_unitsLabel__2Sp-N\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"Modal_modal__3Ldwj\",\"modalDialog\":\"Modal_modalDialog__3Du5z\",\"modalHeader\":\"Modal_modalHeader__1ppBy\",\"modalFooter\":\"Modal_modalFooter__lSAfT\",\"modalClose\":\"Modal_modalClose__3GnIC\",\"modalBody\":\"Modal_modalBody__12nPW\",\"modalContent\":\"Modal_modalContent__35CCy\",\"modalTitle\":\"Modal_modalTitle__bNkET\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"Img_block__r3fmB\",\"img\":\"Img_img__3Hans\",\"selected\":\"Img_selected__vEyvs\",\"pointBottomRight\":\"Img_pointBottomRight__1Z-pj\",\"pointTopLeft\":\"Img_pointTopLeft__3ZXB8\",\"pointTopRight\":\"Img_pointTopRight__2cXMJ\",\"pointBottomLeft\":\"Img_pointBottomLeft__x6rWq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"ArtObj_block__1DyCD\",\"img\":\"ArtObj_img__3ltZN\",\"selected\":\"ArtObj_selected__1oJ2Z\",\"pointBottomRight\":\"ArtObj_pointBottomRight__3og1x\",\"pointTopLeft\":\"ArtObj_pointTopLeft__2iQK4\",\"pointTopRight\":\"ArtObj_pointTopRight__19xjD\",\"pointBottomLeft\":\"ArtObj_pointBottomLeft__1BMY1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarText_toolbar__3Q1B2\",\"toolbar__row\":\"ToolbarText_toolbar__row__2xbEr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropbtn\":\"DropdownMenu_dropbtn__2-JiC\",\"dropdown\":\"DropdownMenu_dropdown__2_ubm\",\"dropdownContent\":\"DropdownMenu_dropdownContent__3ihyt\",\"dropdownText\":\"DropdownMenu_dropdownText__TLnH9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"AddImgButtonFile_button__2-aES\",\"buttonText\":\"AddImgButtonFile_buttonText__QVBcl\",\"inputFile\":\"AddImgButtonFile_inputFile__2htQZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarFilter_toolbar__33oQI\",\"inputRange\":\"ToolbarFilter_inputRange__3VgvX\",\"row\":\"ToolbarFilter_row__2v8k_\",\"label\":\"ToolbarFilter_label__1iRk3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarBackground_toolbar__1Rsa9\",\"row\":\"ToolbarBackground_row__Jz_7E\",\"label\":\"ToolbarBackground_label__iB0N8\",\"reset\":\"ToolbarBackground_reset__28bz6\",\"active\":\"ToolbarBackground_active__2f4Mq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"FileImgButton_button__YkRnP\",\"buttonText\":\"FileImgButton_buttonText__zV9Xx\",\"inputFile\":\"FileImgButton_inputFile__3s8el\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"NavFileButton_button__3OvDn\",\"button__text\":\"NavFileButton_button__text__1282s\",\"inputFile\":\"NavFileButton_inputFile__2Yk6m\",\"icon\":\"NavFileButton_icon__jHKWy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"Text_block__Fvt_5\",\"selected\":\"Text_selected__2uNOO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"ButtonEditText_button__2hfGq\",\"active\":\"ButtonEditText_active__Ffbj1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarImg_toolbar__GYlq5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"AddImgByUrlButton_button__1EEtm\",\"buttonText\":\"AddImgByUrlButton_buttonText__OVCrG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"AddBackgroundByUrlButton_button__JwlsP\",\"button_text\":\"AddBackgroundByUrlButton_button_text__1Me2L\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__35p3U\",\"buttonText\":\"Button_buttonText__22v9d\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"TopToolbar_header__2xzmM\",\"panel\":\"TopToolbar_panel__2JLpt\",\"mainLabel\":\"TopToolbar_mainLabel__3Q8Mp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"NavButton_button__3vR0i\",\"button__text\":\"NavButton_button__text__2jZVH\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"preview\":\"PreviewTemplate_preview__2EUo2\",\"img\":\"PreviewTemplate_img__2FN7H\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"CardMaker_main__qNuoq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"Canvas_canvas__Ak89z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"filter\":\"Filter_filter__16erS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"deleteArea\":\"DeleteArea_deleteArea__2KQym\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"areaSelection\":\"AreaSelection_areaSelection__1Syux\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"Toolbar_toolbar__apu1b\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"ColorPicker_input__3Kdsq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input__number\":\"InputNumber_input__number__2Dr6G\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sticker\":\"PreviewArtObj_sticker__yjFpD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cssloadSpinBox\":\"LoadingIndicator_cssloadSpinBox__27Etq\",\"cssload-spin\":\"LoadingIndicator_cssload-spin__3fpV3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input__color\":\"ColorPicker_input__color__29NBt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarObject_toolbar__29GLR\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navbar\":\"Navbar_navbar__1TxYi\",\"input\":\"Navbar_input__clRRx\"};","import { Background } from \"../types\";\n\nexport type BackgroundAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"RESET_BACKGROUND\",\n} | {\n  type: \"SET_BACKGROUND_COLOR\",\n  color: string,\n} | {\n  type: \"SET_BACKGROUND_IMG\",\n  src: string,\n  width: number,\n  height: number,\n}\n\nfunction background(background: Background, action: BackgroundAction): Background {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return {\n        color: \"#ffffff\",\n        src: null,\n        width: null,\n        height: null,\n      };\n\n    case \"RESET_BACKGROUND\":\n      return {\n        color: \"#ffffff\",\n        src: null,\n        width: null,\n        height: null,\n      };\n\n    case \"SET_BACKGROUND_COLOR\":\n      return {\n        color: action.color,\n        src: null,\n        width: null,\n        height: null,\n      };\n\n    case \"SET_BACKGROUND_IMG\":\n      return {\n        color: null,\n        src: action.src,\n        width: action.width,\n        height: action.height,\n      };\n\n    default:\n      return background;\n  }\n}\n\nexport default background;","import { Filter } from \"../types\";\n\nexport type FilterAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"SET_FILTER\",\n  color: string,\n  opacity: number,\n}\n\nfunction filter(filter: Filter, action: FilterAction): Filter {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return {\n        color: \"#ffffff\",\n        opacity: 0,\n      };\n\n    case \"SET_FILTER\":\n      return {\n        color: action.color,\n        opacity: action.opacity,\n      };\n\n    default:\n      return filter;\n  }\n}\n\nexport default filter;","export type HeightAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"SET_CANVAS_SIZE\",\n  height: number,\n}\n\nfunction heightCanvas(height: number, action: HeightAction): number {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return 600;\n\n    case \"SET_CANVAS_SIZE\":\n      return action.height;\n\n    default:\n      return height;\n  }\n}\n\nexport default heightCanvas;","export enum BlockTypes {\n  img,\n  artObj,\n  text\n}\n\nexport const templates = {\n  birthday_1: {\n    name: \"С днем рождения!\",\n    json: \"./templates/birthday_1.json\",\n    preview: \"./templates/birthday_1.png\",\n  },\n  birthday_2: {\n    name: \"С днем рождения!\",\n    json: \"./templates/birthday_2.json\",\n    preview: \"./templates/birthday_2.png\",\n  },\n  february_23_1: {\n    name: \"С 23 февраля!\",\n    json: \"./templates/february_23_1.json\",\n    preview: \"./templates/february_23_1.png\",\n  },\n  march_8_1: {\n    name: \"С 8 марта!\",\n    json: \"./templates/march_8_1.json\",\n    preview: \"./templates/march_8_1.png\",\n  },\n  march_8_2: {\n    name: \"С 8 марта!\",\n    json: \"./templates/march_8_2.json\",\n    preview: \"./templates/march_8_2.png\",\n  },\n  new_year_1: {\n    name: \"С новым годом!\",\n    json: \"./templates/new_year_1.json\",\n    preview: \"./templates/new_year_1.png\",\n  },\n  new_year_2: {\n    name: \"С новым годом!\",\n    json: \"./templates/new_year_2.json\",\n    preview: \"./templates/new_year_2.png\",\n  },\n  new_year_3: {\n    name: \"С новым годом!\",\n    json: \"./templates/new_year_3.json\",\n    preview: \"./templates/new_year_3.png\",\n  },\n  september_1_1: {\n    name: \"С 1 сентября!\",\n    json: \"./templates/september_1_1.json\",\n    preview: \"./templates/september_1_1.png\",\n  },\n}\n\n\nexport enum SetOfArtObject {\n  ball_1 = \"./img/artObj/ball_1.svg\",\n  bouquet_1 = \"./img/artObj/bouquet_1.svg\",\n  bouquet_2 = \"./img/artObj/bouquet_2.svg\",\n  bouquet_3 = \"./img/artObj/bouquet_3.svg\",\n  bouquet_4 = \"./img/artObj/bouquet_4.svg\",\n  bouquet_5 = \"./img/artObj/bouquet_5.svg\",\n  bow = \"./img/artObj/bow.svg\",\n  branch_1 = \"./img/artObj/branch_1.svg\",\n  branch_2 = \"./img/artObj/branch_2.svg\",\n  branch_3 = \"./img/artObj/branch_3.svg\",\n  camera_1 = \"./img/artObj/camera_1.svg\",\n  camera_2 = \"./img/artObj/camera_2.svg\",\n  flower_1 = \"./img/artObj/flower_1.svg\",\n  flower_2 = \"./img/artObj/flower_2.svg\",\n  flower_3 = \"./img/artObj/flower_3.svg\",\n  gift_1 = \"./img/artObj/gift_1.svg\",\n  gift_2 = \"./img/artObj/gift_2.svg\",\n  gift_3 = \"./img/artObj/gift_3.svg\",\n  sun_1 = \"./img/artObj/sun_1.svg\",\n  tree_1 = \"./img/artObj/tree_1.svg\",\n}\n\nexport type ActionHistory = Readonly<{\n  listState: Canvas[],\n  currentIndex: number,\n}>\n\nexport type Position = Readonly<{\n  x: number,\n  y: number,\n}>\n\nexport type UnifiedBlock = Readonly<{\n  id: string,\n}> & Position\n\nexport type ArtObj = Readonly<{\n  src: string,\n  type: BlockTypes.artObj\n}> & UnifiedBlock & Size\n\nexport type Img = Readonly<{\n  src: string,\n  type: BlockTypes.img\n}> & UnifiedBlock & Size\n\nexport type Text = Readonly<{\n  text: string,\n  color: string,\n  size: number,\n  bold: boolean,\n  italic: boolean,\n  underline: boolean,\n  fontFamily: string,\n  type: BlockTypes.text\n}> & UnifiedBlock\n\nexport type Block = Readonly<Text | Img | ArtObj>;\n\nexport type Background = Readonly<{\n  color: string | null,\n  src: string | null,\n  width: number | null,\n  height: number | null,\n}>\n\nexport type Filter = Readonly<{\n  color: string,\n  opacity: number,\n}>\n\nexport type Area = Readonly<{\n  x: number,\n  y: number,\n}> & Size\n\nexport type Canvas = Readonly<{\n  filter: Filter,\n  listBlock: Block[];\n  deleteArea: Area[],\n  background: Background,\n}> & Size\n\nexport type Size = Readonly<{\n  width: number,\n  height: number,\n}>\n\nexport type ViewModelText = Readonly<{\n  color: string | null,\n  size: number | null,\n  bold: boolean | null,\n  italic: boolean | null,\n  underline: boolean | null,\n  fontFamily: string | null,\n  tempColor: string | null,\n  tempSize: number | null,\n}>\n\nexport type ViewModelBgImg = Readonly<{\n  width: number,\n  height: number,\n  src: string,\n}>\n\nexport type ViewModel = Readonly<{\n  bgColor: string | null,\n  bgImg: ViewModelBgImg | null,\n  canvasSize: Size | null,\n  filter: Filter | null,\n  text: ViewModelText,\n  areaSelection: Area | null,\n}>\n\nexport type CardMaker = Readonly<{\n  canvas: Canvas,\n  selectBlock: string | null,\n  history: ActionHistory,\n  viewModel: ViewModel,\n}>\n\nexport type RGB = {\n  r: number,\n  g: number,\n  b: number\n}\n","import { Block } from \"../store/types\";\n\n// проверка выделен ли блок\nexport function isSelectedBlock(id: string | null): boolean {\n  return Boolean(id)\n}\n\n// установка значений полю/полям одного элемента из списка элементов\nexport function setComponentFields(listBlock: Block[], id: string, modifiableFields: object): Block[] {\n  let newListBlock: Block[] = [];\n  listBlock.forEach((component: Block) => {\n    if (component.id === id) {\n      newListBlock.push({\n        ...component,\n        ...modifiableFields,\n      });\n    } else {\n      newListBlock.push(component);\n    }\n  });\n  return newListBlock;\n}\n\n// получить индекс элемента по id\nexport function getIndexById(listBlock: Block[], id: string): number {\n  let foundIndex: number = -1;\n  listBlock.forEach((block: Block, index: number) => {\n    if (block.id === id) {\n      foundIndex = index;\n      return;\n    }\n  });\n  return foundIndex;\n}","import { ActionHistory, Block } from \"../store/types\";\nimport { getIndexById } from \"./elementList\";\n\n// провера доступности операции undo\nexport function isUndoAvailable(history: ActionHistory): boolean {\n  const length: number = history.listState.length;\n  const index: number = history.currentIndex;\n  return length > 1 && index > 0;\n}\n\n// проверка доступности операции redo\nexport function isRedoAvailable(history: ActionHistory): boolean {\n  const length: number = history.listState.length;\n  const index: number = history.currentIndex;\n  return index + 1 < length;\n}\n\n// проверка доступности операции перемещения слоя вверх\nexport function isShiftUpAvailable(id: string | null, listBlock: Block[]): boolean {\n  const length: number = listBlock.length;\n  return Boolean(id && getIndexById(listBlock, id) < length - 1)\n}\n\n// проверка доступности операции перемещения слоя вниз\nexport function isShiftDownAvailable(id: string | null, listBlock: Block[]): boolean {\n  return Boolean(id && getIndexById(listBlock, id) > 0)\n}\n\n// проверка на !null значение\nexport function verify<T>(value: T | null | undefined): T {\n  if (!value) {\n    throw new Error(\"Assertion failed\");\n  }\n  return value;\n}","export function createGUID() {\n  return [gen(2), gen(1), gen(1), gen(1), gen(3)].join(\"-\");\n}\n\nfunction gen(count: number) {\n  let out = \"\";\n  for (let i: number = 0; i < count; i++) {\n    out += (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n  }\n  return out;\n}","import { Block, BlockTypes } from \"../types\";\nimport { setComponentFields, getIndexById, isSelectedBlock } from \"../../utils/elementList\"\nimport { isShiftUpAvailable, isShiftDownAvailable } from \"../../utils/permisions\"\nimport { createGUID } from \"../../utils/guid\";\n\nexport type ListBlockAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"CREATE_TEXT_BLOCK\",\n  x: number,\n  y: number,\n} | {\n  type: \"SET_SIZE_BLOCK\",\n  id: string,\n  width: number,\n  height: number,\n} | {\n  type: \"SET_TEXT_IN_TEXT_BLOCK\",\n  id: string,\n  text: string,\n} | {\n  type: \"SET_FONT_FAMILY_TEXT\",\n  id: string,\n  fontFamily: string,\n} | {\n  type: \"SET_BOLD_TEXT\",\n  id: string,\n  isBold: boolean,\n} | {\n  type: \"SET_ITALIC_TEXT\",\n  id: string,\n  isItalic: boolean,\n} | {\n  type: \"SET_UNDERLINE_TEXT\",\n  id: string,\n  isUnderline: boolean,\n} | {\n  type: \"SET_SIZE_TEXT\",\n  id: string,\n  size: number,\n} | {\n  type: \"SET_COLOR_TEXT\",\n  id: string,\n  color: string,\n} | {\n  type: \"CREATE_IMG_BLOCK\",\n  width: number,\n  height: number,\n  src: string,\n  x: number,\n  y: number,\n} | {\n  type: \"CREATE_ART_OBJ_BLOCK\",\n  src: string,\n  x: number,\n  y: number,\n} | {\n  type: \"DELETE_BLOCK\",\n  id: string,\n} | {\n  type: \"SET_POSITION_BLOCK\",\n  id: string,\n  x: number,\n  y: number,\n} | {\n  type: \"SHIFT_UP_BLOCK\",\n  id: string,\n} | {\n  type: \"SHIFT_DOWN_BLOCK\",\n  id: string,\n}\n\nfunction listBlock(listBlock: Block[], action: ListBlockAction): Block[] {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return [];\n\n    case \"CREATE_TEXT_BLOCK\":\n      return [\n        ...listBlock,\n        {\n          id: createGUID(),\n          type: BlockTypes.text,\n          color: \"#898989\",\n          x: action.x - 45,\n          y: action.y - 25,\n          text: \"<div>Текст<br></div>\",\n          size: 50,\n          bold: false,\n          italic: false,\n          underline: false,\n          fontFamily: \"OpenSans\",\n        }\n      ];\n\n    case \"SET_SIZE_BLOCK\":\n      return setComponentFields(listBlock, action.id, {\n        width: action.width,\n        height: action.height,\n      });\n\n    case \"SET_TEXT_IN_TEXT_BLOCK\":\n      return setComponentFields(listBlock, action.id, {\n        text: action.text,\n      });\n\n    case \"SET_FONT_FAMILY_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        fontFamily: action.fontFamily,\n      });\n\n    case \"SET_BOLD_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        bold: action.isBold,\n      });\n\n    case \"SET_ITALIC_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        italic: action.isItalic,\n      });\n\n    case \"SET_UNDERLINE_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        underline: action.isUnderline,\n      });\n\n    case \"SET_SIZE_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        size: action.size,\n      });\n\n    case \"SET_COLOR_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        color: action.color,\n      });\n\n    case \"CREATE_IMG_BLOCK\":\n      return [\n        ...listBlock,\n        {\n          id: createGUID(),\n          type: BlockTypes.img,\n          width: action.width,\n          height: action.height,\n          x: action.x,\n          y: action.y,\n          src: action.src,\n        }\n      ];\n\n    case \"CREATE_ART_OBJ_BLOCK\":\n      return [\n        ...listBlock,\n        {\n          id: createGUID(),\n          type: BlockTypes.artObj,\n          width: 150,\n          height: 150,\n          x: action.x,\n          y: action.y,\n          src: action.src,\n        }\n      ];\n\n    case \"DELETE_BLOCK\":\n      const copyListBlock: Block[] = [...listBlock];\n      if (isSelectedBlock(action.id)) {\n        copyListBlock.forEach((component, index) => {\n          if (component.id === action.id) {\n            copyListBlock.splice(index, 1);\n            return false;\n          }\n        });\n      }\n      return copyListBlock;\n\n    case \"SET_POSITION_BLOCK\":\n      return setComponentFields(listBlock, action.id, {\n        x: action.x,\n        y: action.y,\n      });\n\n    case \"SHIFT_UP_BLOCK\":\n      {\n        const newListBlock: Block[] = [...listBlock];\n        if (isShiftUpAvailable(action.id, listBlock)) {\n          const id: string = action.id;\n          const index: number = getIndexById(newListBlock, id);\n          const flipValue: Block[] = [newListBlock[index + 1], newListBlock[index]];\n          newListBlock.splice(index, 2, ...flipValue);\n        }\n        return newListBlock;\n      }\n\n    case \"SHIFT_DOWN_BLOCK\":\n      {\n        const newListBlock: Block[] = [...listBlock];\n        if (isShiftDownAvailable(action.id, listBlock)) {\n          const id: string = action.id;\n          const index: number = getIndexById(newListBlock, id);\n          const flipValue: Block[] = [newListBlock[index], newListBlock[index - 1]];\n          newListBlock.splice(index - 1, 2, ...flipValue);\n        }\n        return newListBlock;\n      }\n\n    default:\n      return listBlock;\n  }\n}\n\nexport default listBlock;","export type WidthAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"SET_CANVAS_SIZE\",\n  width: number,\n}\n\nfunction widthCanvas(width: number, action: WidthAction): number {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return 800;\n\n    case \"SET_CANVAS_SIZE\":\n      return action.width;\n\n    default:\n      return width;\n  }\n}\nexport default widthCanvas;","import { Canvas, Area } from \"../types\";\nimport background, { BackgroundAction } from \"./BackgroundReducer\";\nimport filter, { FilterAction } from \"./FilterReducer\";\nimport heightCanvas, { HeightAction } from \"./HeightCanvasReducer\";\nimport listBlock, { ListBlockAction } from \"./ListBlockReducer\";\nimport widthCanvas, { WidthAction } from \"./WidthCanvasReducer\";\n\nexport type CanvasAction = WidthAction | HeightAction | FilterAction | ListBlockAction | BackgroundAction | DeleteAreaAction;\n\nfunction canvas(canvas: Canvas, action: CanvasAction): Canvas {\n  return {\n    width: widthCanvas(canvas.width, action as WidthAction),\n    height: heightCanvas(canvas.height, action as HeightAction),\n    filter: filter(canvas.filter, action as FilterAction),\n    listBlock: listBlock(canvas.listBlock, action as ListBlockAction),\n    background: background(canvas.background, action as BackgroundAction),\n    deleteArea: deleteArea(canvas.deleteArea, action as DeleteAreaAction),\n  };\n}\n\nexport default canvas;\n\ntype DeleteAreaAction = {\n  type: \"DELETE_AREA_SELECTION\",\n  area: Area | null\n} | {\n  type: \"NEW_CARD_MAKER\",\n}\n\nfunction deleteArea(deleteArea: Area[], action: DeleteAreaAction): Area[] {\n  switch (action.type) {\n    case \"DELETE_AREA_SELECTION\":\n      if (action.area) {\n        return [\n          ...deleteArea,\n          action.area as Area,\n        ];\n      } else {\n        return deleteArea;\n      }\n    case \"NEW_CARD_MAKER\":\n      return [];\n  \n    default:\n      return deleteArea;\n  }\n}","export type SelectBlockAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"RESET_SELECTED_BLOCK\",\n  width: number,\n} | {\n  type: \"SET_SELECTED_BLOCK\",\n  id: string,\n} | {\n  type: \"DELETE_BLOCK\",\n}\n\nfunction selectBlock(selectBlock: null | string, action: SelectBlockAction): string | null {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return null;\n\n    case \"RESET_SELECTED_BLOCK\":\n      return null;\n\n    case \"SET_SELECTED_BLOCK\":\n      return action.id;\n\n    case \"DELETE_BLOCK\":\n      return null;\n\n    default:\n      return selectBlock;\n  }\n}\n\nexport default selectBlock;","import { Canvas, ActionHistory } from \"../types\";\nimport { isUndoAvailable, isRedoAvailable } from \"../../utils/permisions\"\nimport canvas from \"./CanvasReducer\";\n\nexport type HistoryAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"ADD_HISTORY\",\n  newCanvas: Canvas,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\",\n}\n\nfunction history(history: ActionHistory, action: HistoryAction): ActionHistory {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return {\n        listState: [canvas({} as Canvas, action)],\n        currentIndex: 0,\n      };\n\n    case \"ADD_HISTORY\":\n      {\n        const listState: Canvas[] = history.listState;\n        const currentIndex: number = history.currentIndex;\n        const newListState: Canvas[] = [...history.listState];\n        if (currentIndex !== listState.length - 1) {\n          newListState.splice(currentIndex + 1, listState.length - (currentIndex + 1));\n        }\n        newListState.push(action.newCanvas);\n        return {\n          currentIndex: currentIndex + 1,\n          listState: newListState,\n        };\n      }\n\n    case \"UNDO\":\n      {\n        const currentIndex: number = history.currentIndex;\n        const newCurrentIndex: number = isUndoAvailable(history) ? currentIndex - 1 : currentIndex;\n        return {\n          ...history,\n          currentIndex: newCurrentIndex,\n        }\n      }\n\n    case \"REDO\":\n      {\n        const currentIndex: number = history.currentIndex;\n        const newCurrentIndex: number = isRedoAvailable(history) ? currentIndex + 1 : currentIndex;\n        return {\n          ...history,\n          currentIndex: newCurrentIndex,\n        }\n      }\n\n    default:\n      return history;\n  }\n}\n\nexport default history;","import { CardMaker, Area } from \"../../types\";\n\nexport type AreaSelectionAction = {\n  type: \"AREA_SELECTION\",\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n} | {\n  type: \"RESET_AREA_SELECTION\",\n} | {\n  type: \"SET_POSITION_AREA_SELECTION\",\n  x: number,\n  y: number,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nexport default function areaSelection(cardMaker: CardMaker, action: AreaSelectionAction): Area | null {\n  switch (action.type) {\n    case \"AREA_SELECTION\":\n      return {\n        x: action.x,\n        y: action.y,\n        width: action.width,\n        height: action.height,\n      }\n    case \"SET_POSITION_AREA_SELECTION\":\n      return {\n        ...cardMaker.viewModel.areaSelection as Area,\n        x: action.x,\n        y: action.y,\n      };\n    case \"RESET_AREA_SELECTION\": return null;\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default: return cardMaker.viewModel.areaSelection;\n  }\n}","import { CardMaker } from \"../../types\";\n\nexport type BgColorAction = {\n  type: \"INPUT_BACKGROUND_COLOR\",\n  color: string,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\",\n}\n\nexport default function bgColor(cardMaker: CardMaker, action: BgColorAction): string | null {\n  switch (action.type) {\n    case \"INPUT_BACKGROUND_COLOR\": return action.color;\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default: return cardMaker.canvas.background.color;\n  }\n}","import { CardMaker, Size } from \"../../types\";\n\nexport type BgImgAction = {\n  type: \"INPUT_BACKGROUND_IMG\",\n  width: number,\n  height: number,\n  src: string,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nexport default function bgImg(cardMaker: CardMaker, action: BgImgAction): Size & { src: string } | null {\n  switch (action.type) {\n    case \"INPUT_BACKGROUND_IMG\":\n      return {\n        width: action.width,\n        height: action.height,\n        src: action.src,\n      };\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default: return null;\n  }\n}","import { CardMaker, Size } from \"../../types\";\n\nexport type CanvasSizeAction = {\n  type: \"INPUT_CANVAS_SIZE\",\n  width: number,\n  height: number,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n} | {\n  type: \"SET_CANVAS_SIZE\"\n}\n\nexport default function canvasSize(cardMaker: CardMaker, action: CanvasSizeAction): Size | null {\n  switch (action.type) {\n    case \"INPUT_CANVAS_SIZE\":\n      return {\n        width: action.width,\n        height: action.height,\n      };\n    case \"SET_CANVAS_SIZE\": return null;\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default:\n      return null;\n  }\n}","import { CardMaker, Filter } from \"../../types\";\n\nexport type FilterAction = {\n  type: \"INPUT_FILTER\",\n  color: string,\n  opacity: number,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nexport default function filter(cardMaker: CardMaker, action: FilterAction): Filter | null {\n  switch (action.type) {\n    case \"INPUT_FILTER\":\n      return {\n        color: action.color,\n        opacity: action.opacity,\n      };\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default:\n      return cardMaker.viewModel.filter\n  }\n}","import { CardMaker, ViewModelText, Block, Text } from \"../../types\";\nimport { getIndexById } from \"../../../utils/elementList\";\n\nexport type TextAction = {\n  type: \"CLICK_ON_TEXT\",\n  id: string,\n} | {\n  type: \"RESET_SELECTED_BLOCK\",\n} | {\n  type: \"SET_SELECTED_BLOCK\",\n  id: string,\n} | {\n  type: \"SET_FONT_FAMILY_TEXT\",\n  id: string,\n  fontFamily: string,\n} | {\n  type: \"INPUT_COLOR_TEXT\",\n  color: string,\n} | {\n  type: \"INPUT_SIZE_TEXT\",\n  size: number,\n} | {\n  type: \"SET_BOLD_TEXT\",\n  id: string,\n  isBold: boolean,\n} | {\n  type: \"SET_ITALIC_TEXT\",\n  id: string,\n  isItalic: boolean,\n} | {\n  type: \"SET_UNDERLINE_TEXT\",\n  id: string,\n  isUnderline: boolean,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n} | {\n  type: \"DELETE_BLOCK\"\n}\n\nexport default function text(cardMaker: CardMaker, action: TextAction): ViewModelText {\n  const defState: ViewModelText = {\n    color: null,\n    size: null,\n    bold: null,\n    italic: null,\n    underline: null,\n    fontFamily: null,\n    tempColor: null,\n    tempSize: null,\n  }\n\n  let list: Block[]\n  switch (action.type) {\n\n    case \"CLICK_ON_TEXT\":\n      list = cardMaker.canvas.listBlock;\n      const { color, size, bold, italic, underline, fontFamily } = list[getIndexById(list, action.id)] as Text;\n      return { color, tempColor: null, tempSize: null, size, bold, italic, underline, fontFamily }\n\n    case \"SET_FONT_FAMILY_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        fontFamily: action.fontFamily\n      };\n\n    case \"INPUT_COLOR_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        tempColor: action.color\n      };\n\n    case \"INPUT_SIZE_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        tempSize: action.size\n      };\n\n    case \"SET_BOLD_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        bold: action.isBold\n      };\n\n    case \"SET_ITALIC_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        italic: action.isItalic\n      };\n\n    case \"SET_UNDERLINE_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        underline: action.isUnderline\n      };\n\n    case \"SET_SELECTED_BLOCK\": return defState;\n    case \"RESET_SELECTED_BLOCK\": return defState;\n\n    case \"UNDO\": return defState;\n\n    case \"REDO\": return defState;\n    \n    case \"DELETE_BLOCK\": return defState;\n\n    default:\n      return cardMaker.viewModel.text\n  }\n}","import { CardMaker } from \"../../types\";\nimport areaSelection, { AreaSelectionAction } from \"./AreaSelectionReducer\";\nimport bgColor, { BgColorAction } from \"./BgColorReducer\";\nimport bgImg, { BgImgAction } from \"./BgImgReducer\";\nimport canvasSize, { CanvasSizeAction } from \"./CanvasSizeReducer\";\nimport filter from \"./FilterReducer\";\nimport { FilterAction } from \"./FilterReducer\";\nimport text, { TextAction } from \"./TextReducer\";\n\nexport type ViewModelAction = { type: \"NEW_CARD_MAKER\" } | BgColorAction | BgImgAction | CanvasSizeAction | FilterAction | TextAction;\n\nexport default function viewModel(cardMaker: CardMaker = {} as CardMaker, action: ViewModelAction) {\n  if (action.type === \"NEW_CARD_MAKER\") {\n    return {\n      bgColor: null,\n      bgImg: null,\n      canvasSize: null,\n      filter: null,\n      text: {\n        color: null,\n        size: null,\n        bold: null,\n        italic: null,\n        underline: null,\n        fontFamily: null,\n        tempColor: null,\n        tempSize: null,\n      },\n      areaSelection: null,\n    }\n  }\n  return {\n    bgColor: bgColor(cardMaker, action as BgColorAction),\n    bgImg: bgImg(cardMaker, action as BgImgAction),\n    canvasSize: canvasSize(cardMaker, action as CanvasSizeAction),\n    filter: filter(cardMaker, action as FilterAction),\n    text: text(cardMaker, action as TextAction),\n    areaSelection: areaSelection(cardMaker, action as AreaSelectionAction),\n  }\n}\n","import {\n  ActionHistory,\n  Background,\n  Filter,\n  Canvas,\n  CardMaker,\n  ViewModel,\n} from \"./types\";\n\nconst testBackground: Background = {\n  color: \"#ffffff\",\n  src: null,\n  width: null,\n  height: null,\n}\n\nconst testFilter: Filter = {\n  color: \"#ffffff\",\n  opacity: 0,\n}\n\nconst testCanvas: Canvas = {\n  width: 800,\n  height: 600,\n  filter: testFilter,\n  listBlock: [],\n  deleteArea: [],\n  background: testBackground,\n}\n\nconst testActionHistory: ActionHistory = {\n  listState:\n    [\n      testCanvas,\n    ],\n  currentIndex: 0,\n}\n\nconst viewModel: ViewModel = {\n  bgColor: null,\n  bgImg: null,\n  canvasSize: null,\n  filter: null,\n  text: {\n    color: null,\n    size: null,\n    bold: null,\n    italic: null,\n    underline: null,\n    fontFamily: null,\n    tempColor: null,\n    tempSize: null,\n  },\n  areaSelection: null,\n}\n\nexport const testCardMaker: CardMaker = {\n  canvas: testCanvas,\n  selectBlock: null,\n  history: testActionHistory,\n  viewModel: viewModel,\n}","import { createStore, applyMiddleware, Store, MiddlewareAPI, Dispatch, AnyAction } from \"redux\";\nimport { cardMakerReducer } from \"./reducers/CardMakerReducer\";\nimport { testCardMaker } from \"./initialState\";\nimport { Canvas, CardMaker } from \"./types\";\n\nimport { addHistory, afterChangeHistory } from \"./actionCreators/historyActionCreators\";\n\n\nconst exceptions: string[] = [\n  \"UNDO\",\n  \"REDO\",\n  \"ADD_HISTORY\",\n  \"AFTER_CHANGE_HISTORY\",\n  \"SET_SELECTED_BLOCK\",\n  \"SET_POSITION_AREA_SELECTION\",\n  \"RESET_SELECTED_BLOCK\",\n  \"RESET_AREA_SELECTION\",\n  \"APPLY_FILE_PROJECT\",\n  \"NEW_CARD_MAKER\",\n  \"AREA_SELECTION\",\n  \"CLICK_ON_TEXT\",\n  \"INPUT_SIZE_TEXT\",\n  \"INPUT_COLOR_TEXT\",\n  \"INPUT_FILTER\",\n  \"INPUT_CANVAS_SIZE\",\n  \"INPUT_BACKGROUND_IMG\",\n  \"INPUT_BACKGROUND_COLOR\",\n];\n\nconst storeHistory = (store: MiddlewareAPI<Dispatch<AnyAction>, CardMaker>) =>\n  (next: AppDispatch) => (action: AnyAction) => {\n\n    const oldState: CardMaker = store.getState();\n    const result: AnyAction = next(action)\n    \n    if (!exceptions.includes(action.type)) {\n      const newState: CardMaker = store.getState();\n      if (JSON.stringify(oldState.canvas) !== JSON.stringify(newState.canvas)) {\n        store.dispatch(addHistory(newState.canvas));\n      }\n    }\n    return result\n  }\n\nconst movingHistory = (store: MiddlewareAPI<Dispatch<AnyAction>, CardMaker>) =>\n  (next: AppDispatch) => (action: AnyAction) => {\n\n    const result: AnyAction = next(action)\n\n    if ([\"UNDO\", \"REDO\"].includes(action.type)) {\n      const currentIndex: number = store.getState().history.currentIndex;\n      const canvas: Canvas = store.getState().history.listState[currentIndex];\n      const newState: CardMaker = {\n        ...store.getState(),\n        canvas,\n      }\n      store.dispatch(afterChangeHistory(newState));\n    }\n    return result\n  }\n\nexport const store: Store<CardMaker> = createStore(\n  cardMakerReducer,\n  testCardMaker,\n  applyMiddleware(storeHistory, movingHistory)\n);\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch","import { CardMaker } from \"../types\";\nimport canvas, { CanvasAction } from \"./CanvasReducer\";\nimport selectBlock, { SelectBlockAction } from \"./SelectBlockReducer\";\nimport history, { HistoryAction } from \"./HistoryReducer\";\nimport viewModel, { ViewModelAction } from \"./ViewModel/ViewModelReducer\";\n\nexport type CardMakerReducerAction = {\n  type: \"AFTER_CHANGE_HISTORY\",\n  cardMaker: CardMaker,\n} | {\n  type: \"APPLY_FILE_PROJECT\",\n  project: CardMaker,\n} | CanvasAction | SelectBlockAction | HistoryAction | ViewModelAction;\n\nexport function cardMakerReducer(cardMaker = {} as CardMaker, action: CardMakerReducerAction): CardMaker {\n  switch (action.type) {\n\n    case \"AFTER_CHANGE_HISTORY\":\n      return action.cardMaker;\n\n    case \"APPLY_FILE_PROJECT\":\n      return action.project;\n\n    default:\n      return {\n        canvas: canvas(cardMaker.canvas, action as CanvasAction),\n        selectBlock: selectBlock(cardMaker.selectBlock, action as SelectBlockAction),\n        history: history(cardMaker.history, action as HistoryAction),\n        viewModel: viewModel(cardMaker, action as ViewModelAction)\n      }\n  }\n}\n\n","import { Canvas, CardMaker } from \"../types\";\n\nexport function addHistory(newCanvas: Canvas) {\n  return {\n    type: \"ADD_HISTORY\",\n    newCanvas: newCanvas,\n  }\n}\n\nexport function undo() {\n  return {\n    type: \"UNDO\",\n  }\n}\n\nexport function redo() {\n  return {\n    type: \"REDO\",\n  }\n}\n\nexport function afterChangeHistory(cardMaker: CardMaker) {\n  return {\n    type: \"AFTER_CHANGE_HISTORY\",\n    cardMaker: cardMaker,\n  }\n}","import { useEffect, RefObject } from \"react\";\nimport { store } from \"../../store/store\";\nimport { verify } from \"../../utils/permisions\";\n\nexport function useStateBlock(\n  blockId: string,\n  block: RefObject<HTMLElement>,\n  setSelectedBlock: (id: string) => void,\n  resetSelectedBlock: () => void,\n): void {\n\n  useEffect(() => {\n\n    const currentBlock: HTMLElement | null = block.current;\n\n    let mouseDownCurrentBlock: boolean = false;\n\n    function handleMousedownBlock(): void {\n      mouseDownCurrentBlock = true;\n      if (store.getState().selectBlock !== blockId) {\n        setTimeout(() => {\n          setSelectedBlock(blockId);\n        });\n      }\n    }\n\n    function handleClickDocument(event: Event): void {\n      const isDefPrev: boolean = event.defaultPrevented;\n      const isSelectedID: boolean = store.getState().selectBlock === blockId;\n      if (!isDefPrev && isSelectedID && (event.target !== currentBlock) && !mouseDownCurrentBlock) {\n        resetSelectedBlock();\n      }\n      mouseDownCurrentBlock = false;\n    }\n\n\n    document.addEventListener(\"click\", handleClickDocument);\n    verify(currentBlock).addEventListener(\"mousedown\", handleMousedownBlock);\n    return () => {\n      if (currentBlock) currentBlock.removeEventListener(\"mousedown\", handleMousedownBlock);\n      document.removeEventListener(\"click\", handleClickDocument);\n    };\n  }, [blockId, block, setSelectedBlock, resetSelectedBlock]);\n}","import { useEffect, RefObject } from \"react\";\r\nimport { Position } from \"../../store/types\";\r\nimport { verify } from \"../../utils/permisions\";\r\n\r\nexport function useDragAndDrop(\r\n  block: RefObject<HTMLElement>,\r\n  defPos: Position,\r\n  setPositionBlock: (x: number, y: number) => void\r\n): void {\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    const currentBlock: HTMLElement | null = block.current;\r\n\r\n    let startPos: Position;\r\n\r\n    function handleMousedown(event: MouseEvent): void {\r\n      startPos = {\r\n        x: event.pageX,\r\n        y: event.pageY,\r\n      };\r\n      document.addEventListener(\"mousemove\", handleMouseMove);\r\n      document.addEventListener(\"mouseup\", handleMouseUp);\r\n    }\r\n\r\n    let newPos: Position;\r\n\r\n    function handleMouseMove(event: MouseEvent): void {\r\n      if (!event.defaultPrevented) {\r\n        event.preventDefault();\r\n        const delta: Position = {\r\n          x: event.pageX - startPos.x,\r\n          y: event.pageY - startPos.y\r\n        }\r\n        newPos = {\r\n          x: defPos.x + delta.x,\r\n          y: defPos.y + delta.y\r\n        }\r\n        verify(currentBlock).style.left = `${newPos.x}px`;\r\n        verify(currentBlock).style.top = `${newPos.y}px`;\r\n      }\r\n    }\r\n\r\n    function handleMouseUp(): void {\r\n      if (newPos) {\r\n        setPositionBlock(newPos.x, newPos.y);\r\n      }\r\n      document.removeEventListener(\"mousemove\", handleMouseMove);\r\n      document.removeEventListener(\"mouseup\", handleMouseUp);\r\n    }\r\n\r\n\r\n    if (currentBlock) currentBlock.addEventListener(\"mousedown\", handleMousedown);\r\n    return () => {\r\n      if (currentBlock) currentBlock.removeEventListener(\"mousedown\", handleMousedown);\r\n    };\r\n  }, [block, defPos, setPositionBlock]);\r\n}","import { Size } from \"../store/types\";\n\n// пропорциональный перерасчет ширины отностиельно новой высоты\nexport function calcWidthByHeight(initWidth: number, initHeight: number, baseHeight: number): number {\n  return initWidth * baseHeight / initHeight\n}\n\n// пропорциональный перерасчет высоты отностиельно новой ширины\nexport function calcHeightByWidth(initWidth: number, initHeight: number, baseWidth: number): number {\n  return initHeight * baseWidth / initWidth\n}\n\n// пропорциональный перерасчет размеров относительно новой ширины\nexport function calcSizeByWidth(initWidth: number, initHeight: number, baseWidth: number): Size {\n  const newHeight: number = (initHeight * baseWidth) / initWidth;\n  const newWidth: number = (initWidth * newHeight) / initHeight;\n  return {\n    width: newWidth,\n    height: newHeight,\n  }\n}\n\n// пропорциональный перерасчет размеров относительно новой высоты\nexport function calcSizeByHeight(initWidth: number, initHeight: number, baseHeight: number): Size {\n  const newWidth: number = calcWidthByHeight(initWidth, initHeight, baseHeight);\n  const newHeight: number = calcHeightByWidth(initWidth, initHeight, newWidth);\n  return {\n    width: newWidth,\n    height: newHeight,\n  }\n}\n\n// пропорциональный расчет размера изображения для полного заполнения холста\nexport function calcSizeImgByCanvas(imgW: number, imgH: number, canvasW: number, canvasH: number): Size {\n  let size = {\n    width: imgW,\n    height: imgH,\n  }\n  if (imgW < canvasW) {\n    size = calcSizeByWidth(imgW, imgH, canvasW);\n  }\n  if (imgH < canvasH) {\n    size = calcSizeByHeight(imgW, imgH, canvasH);\n  }\n  return size;\n}","import { useEffect, RefObject } from \"react\";\nimport { Position, Size } from \"../../store/types\";\nimport { verify } from \"../../utils/permisions\";\nimport { calcHeightByWidth, calcWidthByHeight } from \"../../utils/size\";\n\nexport function useResize(\n  setSizeBlock: (width: number, height: number) => void,\n  setPositionBlock: (x: number, y: number) => void,\n  LT: RefObject<HTMLElement>,\n  RT: RefObject<HTMLElement>,\n  LB: RefObject<HTMLElement>,\n  RB: RefObject<HTMLElement>,\n  block: RefObject<HTMLElement>,\n  defPos: Position,\n  defSize: Size\n): void {\n\n\n  useEffect(() => {\n\n    const currentBlock: HTMLElement | null = block.current;\n    const pointLT: HTMLElement | null = LT.current;\n    const pointRT: HTMLElement | null = RT.current;\n    const pointLB: HTMLElement | null = LB.current;\n    const pointRB: HTMLElement | null = RB.current;\n\n    let startPos: Position;\n    let point: string;\n\n    function handleMousedown(event: MouseEvent): void {\n      event.preventDefault();\n      switch (event.target) {\n        case pointLT:\n          point = \"LT\";\n          break;\n        case pointRT:\n          point = \"RT\";\n          break;\n        case pointLB:\n          point = \"LB\";\n          break;\n        case pointRB:\n          point = \"RB\";\n          break;\n      }\n\n      startPos = {\n        x: event.pageX + (5 - event.offsetX),\n        y: event.pageY + (5 - event.offsetY)\n      };\n\n      document.addEventListener(\"mousemove\", handleMouseMove);\n      document.addEventListener(\"mouseup\", handleMouseUp);\n    }\n\n    let newWidth: number = defSize.width;\n    let newHeight: number = defSize.height;\n    let prevWidth: number = defSize.width;\n    let prevHeight: number = defSize.height;\n    let newPos: Position;\n\n    function handleMouseMove(event: MouseEvent): void {\n      event.preventDefault();\n      const delta: Position = {\n        x: event.pageX - startPos.x,\n        y: event.pageY - startPos.y,\n      }\n\n      // перемещение при изменении размеров\n      let moving: Position = { x: 0, y: 0 };\n      switch (point) {\n        case \"LT\":\n          [newWidth, newHeight] = calculateSize({ x: -delta.x, y: -delta.y }, prevWidth, prevHeight);\n          moving = { x: defSize.width - newWidth, y: defSize.height - newHeight };\n          break;\n        case \"RT\":\n          [newWidth, newHeight] = calculateSize({ x: delta.x, y: -delta.y }, prevWidth, prevHeight);\n          moving = { x: 0, y: defSize.height - newHeight };\n          break;\n        case \"LB\":\n          [newWidth, newHeight] = calculateSize({ x: -delta.x, y: delta.y }, prevWidth, prevHeight);\n          moving = { x: defSize.width - newWidth, y: 0 };\n          break;\n        case \"RB\":\n          [newWidth, newHeight] = calculateSize(delta, prevWidth, prevHeight);\n          break;\n      }\n\n      verify(currentBlock).style.width = `${newWidth}px`;\n      verify(currentBlock).style.height = `${newHeight}px`;\n\n      newPos = {\n        x: defPos.x + moving.x,\n        y: defPos.y + moving.y\n      }\n\n      verify(currentBlock).style.left = `${newPos.x}px`;\n      verify(currentBlock).style.top = `${newPos.y}px`;\n\n      prevWidth = newWidth;\n      prevHeight = newHeight;\n    }\n\n    function calculateSize(delta: Position, prevWidth: number, prevHeight: number) {\n      if ((delta.x / prevWidth) < (delta.y / prevHeight)) {\n        newHeight = defSize.height + delta.y;\n        newHeight = newHeight < 20 ? 20 : newHeight;\n        newWidth = calcWidthByHeight(prevWidth, prevHeight, newHeight);\n      } else {\n        newWidth = defSize.width + delta.x;\n        newWidth = newWidth < 20 ? 20 : newWidth;\n        newHeight = calcHeightByWidth(prevWidth, prevHeight, newWidth);\n      }\n      return [newWidth, newHeight];\n    }\n\n    function handleMouseUp(): void {\n      setSizeBlock(newWidth, newHeight);\n      if (newPos) setPositionBlock(newPos.x, newPos.y);\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n      document.removeEventListener(\"mouseup\", handleMouseUp);\n    }\n\n\n    verify(pointLT).addEventListener(\"mousedown\", handleMousedown);\n    verify(pointRT).addEventListener(\"mousedown\", handleMousedown);\n    verify(pointLB).addEventListener(\"mousedown\", handleMousedown);\n    verify(pointRB).addEventListener(\"mousedown\", handleMousedown);\n    return () => {\n      if (pointLT) pointLT.removeEventListener(\"mousedown\", handleMousedown);\n      if (pointRT) pointRT.removeEventListener(\"mousedown\", handleMousedown);\n      if (pointLB) pointLB.removeEventListener(\"mousedown\", handleMousedown);\n      if (pointRB) pointRB.removeEventListener(\"mousedown\", handleMousedown);\n    };\n  }, [setSizeBlock, setPositionBlock, LT, RT, LB, RB, block, defPos, defSize]);\n}","import { store } from \"../store\";\n\nexport function setSelectedBlock(id: string) {\n  return {\n    type: \"SET_SELECTED_BLOCK\",\n    id: id,\n  }\n}\n\nexport function resetSelectedBlock() {\n  return {\n    type: \"RESET_SELECTED_BLOCK\",\n  }\n}\n\nexport function setSizeBlock(width: number, height: number) {\n  return {\n    type: \"SET_SIZE_BLOCK\",\n    id: store.getState().selectBlock,\n    width: width,\n    height: height,\n  }\n}\n\nexport function deleteBlock() {\n  return {\n    type: \"DELETE_BLOCK\",\n    id: store.getState().selectBlock,\n  }\n}\n\nexport function setPositionBlock(x: number, y: number) {\n  return {\n    type: \"SET_POSITION_BLOCK\",\n    id: store.getState().selectBlock,\n    x: x,\n    y: y,\n  }\n}\n\nexport function shiftUpBlock() {\n  return {\n    type: \"SHIFT_UP_BLOCK\",\n    id: store.getState().selectBlock,\n  }\n}\n\nexport function shiftDownBlock() {\n  return {\n    type: \"SHIFT_DOWN_BLOCK\",\n    id: store.getState().selectBlock,\n  }\n}\n\nexport function clickOnText() {\n  return {\n    type: \"CLICK_ON_TEXT\",\n    id: store.getState().selectBlock,\n  }\n}\n","import styles from \"./Img.module.css\";\r\nimport { Img as ImgType } from \"../../../store/types\";\r\nimport { useRef } from \"react\";\r\nimport { useStateBlock } from \"../useStateBlock\";\r\nimport { useDragAndDrop } from \"../useDragAndDrop\";\r\nimport { useResize } from \"../useResize\";\r\nimport { connect } from \"react-redux\";\r\nimport { resetSelectedBlock, setPositionBlock, setSelectedBlock, setSizeBlock } from \"../../../store/actionCreators/blockActionCreators\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\n\r\ntype ImgProps = {\r\n  img: ImgType,\r\n  selectBlock: string | null,\r\n  setSizeBlock: (width: number, height: number) => void,\r\n  setPositionBlock: (x: number, y: number) => void,\r\n  setSelectedBlock: (id: string) => void,\r\n  resetSelectedBlock: () => void,\r\n}\r\n\r\nfunction Img(props: ImgProps) {\r\n  const img: ImgType = props.img;\r\n  let src: string = \"\";\r\n  if (img.src) {\r\n    src = img.src;\r\n  }\r\n  const imgStyle = getStyle(img);\r\n  const imgBlock = useRef<HTMLImageElement>(null);\r\n\r\n\r\n  const pointLT = useRef<HTMLDivElement>(null);\r\n  const pointRT = useRef<HTMLDivElement>(null);\r\n  const pointLB = useRef<HTMLDivElement>(null);\r\n  const pointRB = useRef<HTMLDivElement>(null);\r\n\r\n  useStateBlock(img.id, imgBlock, props.setSelectedBlock, props.resetSelectedBlock);\r\n  useDragAndDrop(imgBlock, { x: img.x, y: img.y }, props.setPositionBlock);\r\n  useResize(\r\n    props.setSizeBlock,\r\n    props.setPositionBlock,\r\n    pointLT,\r\n    pointRT,\r\n    pointLB,\r\n    pointRB,\r\n    imgBlock,\r\n    { x: img.x, y: img.y },\r\n    { width: img.width, height: img.height }\r\n  );\r\n\r\n  const select: string = img.id === props.selectBlock ? styles.selected : \"\";\r\n\r\n  return (\r\n    <div\r\n      className={`${styles.block} ${select}`}\r\n      style={imgStyle}\r\n      ref={imgBlock}\r\n      onDragStart={(e) => e.preventDefault() }\r\n    >\r\n      <div className={styles.pointTopLeft} ref={pointLT}></div>\r\n      <div className={styles.pointTopRight} ref={pointRT}></div>\r\n      <img src={src}\r\n        alt=\"\"\r\n        className={styles.img}\r\n      />\r\n      <div className={styles.pointBottomLeft} ref={pointLB}></div>\r\n      <div className={styles.pointBottomRight} ref={pointRB}></div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  selectBlock: state.selectBlock,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    setPositionBlock: (x: number, y: number) => dispatch(setPositionBlock(x, y)),\r\n    setSizeBlock: (width: number, height: number) => dispatch(setSizeBlock(width, height)),\r\n    setSelectedBlock: (id: string) => dispatch(setSelectedBlock(id)),\r\n    resetSelectedBlock: () => dispatch(resetSelectedBlock()),\r\n  }\r\n}\r\n\r\nfunction getStyle(img: ImgType) {\r\n  return {\r\n    width: img.width,\r\n    height: img.height,\r\n    left: img.x,\r\n    top: img.y,\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Img);\r\n","import { store } from \"../store\";\n\nexport function createTextBlock() {\n  return {\n    type: \"CREATE_TEXT_BLOCK\",\n    x: store.getState().canvas.width / 2,\n    y: store.getState().canvas.height / 2,\n  }\n}\n\nexport function setTextInTextBlock(text: string) {\n  return {\n    type: \"SET_TEXT_IN_TEXT_BLOCK\",\n    id: store.getState().selectBlock,\n    text: text,\n  }\n}\n\nexport function setFontFamilyText(fontFamily: string) {\n  return {\n    type: \"SET_FONT_FAMILY_TEXT\",\n    id: store.getState().selectBlock,\n    fontFamily: fontFamily,\n  }\n}\n\nexport function setBoldText(isBold: boolean) {\n  return {\n    type: \"SET_BOLD_TEXT\",\n    id: store.getState().selectBlock,\n    isBold: isBold,\n  }\n}\n\nexport function setItalicText(isItalic: boolean) {\n  return {\n    type: \"SET_ITALIC_TEXT\",\n    id: store.getState().selectBlock,\n    isItalic: isItalic,\n  }\n}\n\nexport function setUnderlineText(isUnderline: boolean) {\n  return {\n    type: \"SET_UNDERLINE_TEXT\",\n    id: store.getState().selectBlock,\n    isUnderline: isUnderline,\n  }\n}\n\nexport function setSizeText(size: number) {\n  return {\n    type: \"SET_SIZE_TEXT\",\n    id: store.getState().selectBlock,\n    size: size,\n  }\n}\n\nexport function inputColorText(color: string) {\n  return {\n    type: \"INPUT_COLOR_TEXT\",\n    color: color,\n  }\n}\n\nexport function inputSizeText(size: number) {\n  return {\n    type: \"INPUT_SIZE_TEXT\",\n    size: size,\n  }\n}\n\nexport function setColorText(color: string) {\n  return {\n    type: \"SET_COLOR_TEXT\",\n    id: store.getState().selectBlock,\n    color: color,\n  }\n}","import styles from \"./Text.module.css\";\r\nimport { Text as TextType } from \"../../../store/types\";\r\nimport { useRef } from \"react\";\r\nimport { useStateBlock } from \"../useStateBlock\";\r\nimport { useDragAndDrop } from \"../useDragAndDrop\";\r\nimport { connect } from \"react-redux\";\r\nimport { clickOnText, deleteBlock, resetSelectedBlock, setPositionBlock, setSelectedBlock } from \"../../../store/actionCreators/blockActionCreators\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport { useEditText } from \"./useEditText\";\r\nimport { setBoldText, setItalicText, setTextInTextBlock, setUnderlineText } from \"../../../store/actionCreators/textBlockActionCreators\";\r\n\r\ntype TextProps = {\r\n  text: TextType,\r\n  color: string | null,\r\n  size: number | null,\r\n  selectBlock: string | null,\r\n  setPositionBlock: (x: number, y: number) => void,\r\n  setSelectedBlock: (id: string) => void,\r\n  resetSelectedBlock: () => void,\r\n  setTextInTextBlock: (text: string) => void,\r\n  clickOnText: () => void,\r\n  deleteBlock: () => void,\r\n  setBoldText: (isBold: boolean) => void,\r\n  setItalicText: (isItalic: boolean) => void,\r\n  setUnderlineText: (isUnderline: boolean) => void,\r\n}\r\n\r\nfunction Text(props: TextProps) {\r\n  const text: TextType = props.text;\r\n\r\n  const textBlock = useRef<HTMLDivElement>(null);\r\n  useStateBlock(text.id, textBlock, props.setSelectedBlock, props.resetSelectedBlock);\r\n  useDragAndDrop(textBlock, { x: text.x, y: text.y }, props.setPositionBlock);\r\n\r\n  useEditText(\r\n    textBlock,\r\n    text.bold,\r\n    text.italic,\r\n    text.underline,\r\n    props.setTextInTextBlock,\r\n    props.clickOnText,\r\n    props.deleteBlock,\r\n    props.setBoldText,\r\n    props.setItalicText,\r\n    props.setUnderlineText,\r\n  );\r\n\r\n  const select: string = text.id === props.selectBlock ? styles.selected : \"\";\r\n  let textStyle = getStyle(text);\r\n  textStyle = {\r\n    ...textStyle,\r\n    color: props.color && select !== \"\" ? props.color : textStyle.color,\r\n    fontSize: props.size && select !== \"\" ? props.size : textStyle.fontSize,\r\n  }\r\n\r\n  return (\r\n    <div style={textStyle}\r\n      contentEditable={false}\r\n      suppressContentEditableWarning={true}\r\n      onDragStart={(e) => e.preventDefault()}\r\n      ref={textBlock}\r\n      className={`${styles.block} ${select}`}\r\n      dangerouslySetInnerHTML={{ __html: text.text }}\r\n    >\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getStyle(text: TextType) {\r\n  return {\r\n    left: text.x,\r\n    top: text.y,\r\n    color: text.color,\r\n    fontSize: text.size,\r\n    fontWeight: text.bold ? 700 : 400,\r\n    textDecoration: text.underline ? \"underline\" : \"none\",\r\n    fontStyle: text.italic ? \"italic\" : \"normal\",\r\n    fontFamily: text.fontFamily,\r\n  };\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  selectBlock: state.selectBlock,\r\n  color: state.viewModel.text.tempColor,\r\n  size: state.viewModel.text.tempSize,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    setPositionBlock: (x: number, y: number) => dispatch(setPositionBlock(x, y)),\r\n    setSelectedBlock: (id: string) => dispatch(setSelectedBlock(id)),\r\n    resetSelectedBlock: () => dispatch(resetSelectedBlock()),\r\n    setTextInTextBlock: (text: string) => dispatch(setTextInTextBlock(text)),\r\n    clickOnText: () => dispatch(clickOnText()),\r\n    deleteBlock: () => dispatch(deleteBlock()),\r\n    setBoldText: (isBold: boolean) => dispatch(setBoldText(isBold)),\r\n    setItalicText: (isItalic: boolean) => dispatch(setItalicText(isItalic)),\r\n    setUnderlineText: (isUnderline: boolean) => dispatch(setUnderlineText(isUnderline)),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Text);\r\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useEditText(\n  block: RefObject<HTMLDivElement>,\n  bold: boolean,\n  italic: boolean,\n  underline: boolean,\n  setTextInTextBlock: (text: string) => void,\n  clickOnText: () => void,\n  deleteBlock: () => void,\n  setBoldText: (isBold: boolean) => void,\n  setItalicText: (isItalic: boolean) => void,\n  setUnderlineText: (isUnderline: boolean) => void,\n) {\n\n  useEffect(() => {\n\n    const currentBlock: HTMLDivElement | null = block.current;\n\n    function handleMousedownBlock() {\n      setTimeout(() => {\n        clickOnText();\n      });\n    }\n\n    function handleDblclickBlock() {\n      verify(currentBlock).setAttribute(\"contenteditable\", \"true\")\n      verify(currentBlock).focus();\n    }\n\n    function handleBlur() {\n      if (currentBlock) {\n        currentBlock.setAttribute(\"contenteditable\", \"false\")\n        const content: string = currentBlock.innerHTML;\n        if (content === \"<div><br></div>\") {\n          deleteBlock();\n        } else {\n          setTextInTextBlock(currentBlock.innerHTML);\n        }\n      }\n    }\n\n    function handleMouseMove(event: Event) {\n      if (verify(currentBlock).getAttribute(\"contenteditable\") === \"true\") {\n        event.stopImmediatePropagation();\n      }\n    }\n\n    function handlerKeydown(event: KeyboardEvent): void {\n      if (event.code === \"Escape\") {\n        if (verify(currentBlock).getAttribute(\"contenteditable\") === \"true\") {\n          verify(currentBlock).setAttribute(\"contenteditable\", \"false\")\n          setTextInTextBlock(verify(currentBlock).innerHTML)\n        }\n      }\n      if (event.code === \"Delete\") {\n        event.preventDefault();\n        document.execCommand(\"forwardDelete\");\n      }\n      if (event.code === \"KeyB\" && (event.ctrlKey || event.metaKey)) {\n        event.preventDefault();\n        setBoldText(!bold)\n      }\n      if (event.code === \"KeyI\" && (event.ctrlKey || event.metaKey)) {\n        event.preventDefault();\n        setItalicText(!italic)\n      }\n      if (event.code === \"KeyU\" && (event.ctrlKey || event.metaKey)) {\n        event.preventDefault();\n        setUnderlineText(!underline)\n      }\n    }\n\n    function handlerPaste(event: ClipboardEvent) {\n      event.preventDefault();\n      if (event.clipboardData) {\n        const text: string = event.clipboardData.getData(\"text/plain\");\n        document.execCommand(\"insertHTML\", false, text);\n      }\n\n    }\n\n    function handlerInput() {\n      if (currentBlock) {\n        if (currentBlock.innerHTML[0] !== \"<\" || currentBlock.innerHTML === \"<br>\") {\n          currentBlock.innerHTML = `<div>${currentBlock.innerText}<br></div>`;\n          currentBlock.focus();\n        }\n      }\n    }\n\n\n    verify(currentBlock).addEventListener(\"mousedown\", handleMousedownBlock);\n    verify(currentBlock).addEventListener(\"dblclick\", handleDblclickBlock);\n    verify(currentBlock).addEventListener(\"blur\", handleBlur);\n    verify(currentBlock).addEventListener(\"keydown\", handlerKeydown);\n    verify(currentBlock).addEventListener(\"paste\", handlerPaste);\n    verify(currentBlock).addEventListener(\"input\", handlerInput);\n    document.addEventListener(\"mousemove\", handleMouseMove);\n    return () => {\n      if (currentBlock) {\n        currentBlock.removeEventListener(\"mousedown\", handleMousedownBlock);\n        currentBlock.removeEventListener(\"dblclick\", handleDblclickBlock);\n        currentBlock.addEventListener(\"blur\", handleBlur);\n        currentBlock.removeEventListener(\"keydown\", handlerKeydown);\n        currentBlock.removeEventListener(\"paste\", handlerPaste);\n        currentBlock.removeEventListener(\"input\", handlerInput);\n      }\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n    };\n  }, [\n    block, bold, italic, underline, setTextInTextBlock, clickOnText,\n    deleteBlock, setBoldText, setItalicText, setUnderlineText\n  ]);\n}","import styles from \"./ArtObj.module.css\";\r\nimport { ArtObj as ArtObjType } from \"../../../store/types\";\r\nimport { useRef } from \"react\";\r\nimport { useStateBlock } from \"../useStateBlock\";\r\nimport { useDragAndDrop } from \"../useDragAndDrop\";\r\nimport { useResize } from \"../useResize\";\r\nimport { resetSelectedBlock, setPositionBlock, setSelectedBlock, setSizeBlock } from \"../../../store/actionCreators/blockActionCreators\";\r\nimport { connect } from \"react-redux\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\n\r\ntype ArtObjProps = {\r\n  artObj: ArtObjType,\r\n  selectBlock: string | null,\r\n  setSizeBlock: (width: number, height: number) => void,\r\n  setPositionBlock: (x: number, y: number) => void,\r\n  setSelectedBlock: (id: string) => void,\r\n  resetSelectedBlock: () => void,\r\n}\r\n\r\nfunction ArtObj(props: ArtObjProps) {\r\n  const artObj: ArtObjType = props.artObj;\r\n  const artObjBlock = useRef<HTMLDivElement>(null);\r\n  const artObjStyle = getStyle(artObj);\r\n\r\n  const pointLT = useRef<HTMLDivElement>(null);\r\n  const pointRT = useRef<HTMLDivElement>(null);\r\n  const pointLB = useRef<HTMLDivElement>(null);\r\n  const pointRB = useRef<HTMLDivElement>(null);\r\n\r\n  useStateBlock(artObj.id, artObjBlock, props.setSelectedBlock, props.resetSelectedBlock);\r\n  useDragAndDrop(artObjBlock, { x: artObj.x, y: artObj.y }, props.setPositionBlock);\r\n  useResize(\r\n    props.setSizeBlock,\r\n    props.setPositionBlock,\r\n    pointLT,\r\n    pointRT,\r\n    pointLB,\r\n    pointRB,\r\n    artObjBlock,\r\n    { x: artObj.x, y: artObj.y },\r\n    { width: artObj.width, height: artObj.height }\r\n  );\r\n  \r\n  const select: string = artObj.id === props.selectBlock ? styles.selected : \"\";\r\n\r\n  return (\r\n    <div\r\n      className={`${styles.block} ${select}`}\r\n      style={artObjStyle}\r\n      ref={artObjBlock}\r\n      onDragStart={(e) => e.preventDefault() }\r\n    >\r\n      <div className={styles.pointTopLeft} ref={pointLT}></div>\r\n      <div className={styles.pointTopRight} ref={pointRT}></div>\r\n      <img src={artObj.src}\r\n        alt=\"\"\r\n        className={styles.img}\r\n      />\r\n      <div className={styles.pointBottomLeft} ref={pointLB}></div>\r\n      <div className={styles.pointBottomRight} ref={pointRB}></div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  selectBlock: state.selectBlock,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    setPositionBlock: (x: number, y: number) => dispatch(setPositionBlock(x, y)),\r\n    setSizeBlock: (width: number, height: number) => dispatch(setSizeBlock(width, height)),\r\n    setSelectedBlock: (id: string) => dispatch(setSelectedBlock(id)),\r\n    resetSelectedBlock: () => dispatch(resetSelectedBlock()),\r\n  }\r\n}\r\n\r\nfunction getStyle(artObj: ArtObjType) {\r\n  return {\r\n    width: artObj.width,\r\n    height: artObj.height,\r\n    left: artObj.x,\r\n    top: artObj.y,\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ArtObj);\r\n","import styles from \"./Filter.module.css\";\nimport { Canvas, Filter as FilterType } from \"../../../store/types\";\nimport { connect } from \"react-redux\";\nimport { RootState } from \"../../../store/store\";\n\ntype FilterProps = {\n  canvas: Canvas\n  filter: FilterType | null,\n}\n\nfunction Filter(props: FilterProps) {\n  const canvas: Canvas = props.canvas;\n\n  let color: string = \"\";\n  let opacity: number = 0;\n  if (props.filter) {\n    color = props.filter.color;\n    opacity = props.filter.opacity;\n  } else {\n    color = canvas.filter.color;\n    opacity = canvas.filter.opacity;\n  }\n\n  const filterStyle = {\n    background: color,\n    opacity: opacity,\n  };\n\n  return (\n    <div className={styles.filter} style={filterStyle} id=\"filter\"></div>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    canvas: state.canvas,\n    filter: state.viewModel.filter,\n  }\n};\n\nexport default connect(mapStateToProps)(Filter);","import styles from \"./DeleteArea.module.css\";\nimport { ReactElement } from \"react\";\nimport { Area } from \"../../../store/types\";\nimport { connect } from \"react-redux\";\nimport { RootState } from \"../../../store/store\";\n\ntype DeleteAreaProps = { deleteArea: Area[] }\n\nfunction DeleteArea(props: DeleteAreaProps) {\n\n  if (props.deleteArea === []) {\n    return null;\n  }\n\n  const listBlock: ReactElement[] = [];\n  props.deleteArea.forEach((block: Area, index: number) => {\n    const deleteAreaStyle = {\n      width: block.width,\n      height: block.height,\n      left: block.x,\n      top: block.y,\n    };\n\n    listBlock.push(\n      <div className={styles.deleteArea}\n        key={index}\n        style={deleteAreaStyle}>\n      </div>\n    );\n  });\n\n  return (\n    <>\n      {listBlock}\n    </>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    deleteArea: state.canvas.deleteArea,\n  }\n};\n\nexport default connect(mapStateToProps)(DeleteArea);\n\n\n\n","import { store } from \"../store\"\n\nexport function setCanvasSize(width: number, height: number) {\n  return {\n    type: \"SET_CANVAS_SIZE\",\n    width: width,\n    height: height,\n  }\n}\n\nexport function setFilter(color: string, opacity: number) {\n  return {\n    type: \"SET_FILTER\",\n    color: color,\n    opacity: opacity,\n  }\n}\n\nexport function setBackgroundColor(color: string) {\n  return {\n    type: \"SET_BACKGROUND_COLOR\",\n    color: color,\n  }\n}\n\nexport function setBackgroundImg(src: string, width: number, height: number) {\n  return {\n    type: \"SET_BACKGROUND_IMG\",\n    src: src,\n    width: width,\n    height: height,\n  }\n}\n\nexport function resetBackground() {\n  return {\n    type: \"RESET_BACKGROUND\",\n  }\n}\n\nexport function inputBackgroundColor(color: string) {\n  return {\n    type: \"INPUT_BACKGROUND_COLOR\",\n    color: color,\n  }\n}\n\nexport function inputBackgroundImg(src: string, width: number, height: number) {\n  return {\n    type: \"INPUT_BACKGROUND_IMG\",\n    src: src,\n    width: width,\n    height: height,\n  }\n}\n\nexport function inputCanvasSize(width: number, height: number) {\n  return {\n    type: \"INPUT_CANVAS_SIZE\",\n    width: width,\n    height: height,\n  }\n}\n\nexport function inputFilter(color: string, opacity: number) {\n  return {\n    type: \"INPUT_FILTER\",\n    color: color,\n    opacity: opacity,\n  }\n}\n\nexport function areaSelection(x: number, y: number, width: number, height: number) {\n  return {\n    type: \"AREA_SELECTION\",\n    x: x,\n    y: y,\n    width: width,\n    height: height,\n  }\n}\n\nexport function resetAreaSelection() {\n  return {\n    type: \"RESET_AREA_SELECTION\",\n  }\n}\n\nexport function setPositionAreaSelection(x: number, y: number) {\n  return {\n    type: \"SET_POSITION_AREA_SELECTION\",\n    x: x,\n    y: y,\n  }\n}\n\nexport function deleteAreaSelection() {\n  return {\n    type: \"DELETE_AREA_SELECTION\",\n    area: store.getState().viewModel.areaSelection,\n  }\n}\n","import styles from \"./AreaSelection.module.css\";\nimport { Area } from \"../../../store/types\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../store/store\";\nimport { useDragAndDrop } from \"../useDragAndDrop\";\nimport { areaSelection, resetAreaSelection, setPositionAreaSelection } from \"../../../store/actionCreators/canvasActionCreators\";\nimport { ForwardedRef, forwardRef, RefObject, useRef } from \"react\";\nimport { useAreaSelection } from \"./useAreaSelection\";\n\ntype AreaSelectionProps = {\n  area: Area | null,\n  areaSelection: (x: number, y: number, width: number, height: number) => void,\n  resetAreaSelection: () => void,\n  setPositionAreaSelection: (x: number, y: number) => void,\n}\n\nconst AreaSelection = forwardRef((props: AreaSelectionProps, ref: ForwardedRef<HTMLDivElement>) => {\n  const area = useRef<HTMLDivElement>(null);\n\n  useAreaSelection(ref as RefObject<HTMLDivElement>, area, props.areaSelection, props.resetAreaSelection);\n\n  useDragAndDrop(\n    area,\n    {\n      x: props.area ? props.area.x : 0,\n      y: props.area ? props.area.y : 0,\n    },\n    props.setPositionAreaSelection);\n\n  if (!props.area) {\n    return null;\n  }\n\n  const areaSelectionStyle = {\n    left: props.area.x,\n    top: props.area.y,\n    width: props.area.width - 2,\n    height: props.area.height - 2,\n  }\n\n  return (\n    <>\n      {props.area && <div className={styles.areaSelection} style={areaSelectionStyle} ref={area}></div>}\n    </>\n  );\n});\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    area: state.viewModel.areaSelection,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    areaSelection: (x: number, y: number, width: number, height: number) => dispatch(areaSelection(x, y, width, height)),\n    resetAreaSelection: () => dispatch(resetAreaSelection()),\n    setPositionAreaSelection: (x: number, y: number) => dispatch(setPositionAreaSelection(x, y)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, { forwardRef: true })(AreaSelection);\n\n\n\n","import { useEffect, RefObject } from \"react\";\nimport { Position } from \"../../../store/types\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useAreaSelection(\n  canvas: RefObject<HTMLDivElement>,\n  area: RefObject<HTMLDivElement>,\n  areaSelection: (x: number, y: number, width: number, height: number) => void,\n  resetAreaSelection: () => void): void {\n\n  useEffect(() => {\n\n    const field: HTMLDivElement | null = canvas.current;\n    const selectArea: HTMLDivElement | null = area.current;\n\n    let startPos: Position;\n    let startOffsetPos: Position;\n\n    const div: HTMLDivElement = document.createElement(\"div\");\n    div.style.position = \"absolute\";\n    div.style.zIndex = \"1\";\n    div.style.pointerEvents = \"none\";\n\n    function handleMousedown(event: MouseEvent): void {\n      \n      if (!event.defaultPrevented && event.target === field) {\n        startPos = {\n          x: event.pageX,\n          y: event.pageY,\n        };\n\n        startOffsetPos = {\n          x: event.offsetX,\n          y: event.offsetY,\n        };\n\n        document.addEventListener(\"mousemove\", handleMouseMove);\n        document.addEventListener(\"mouseup\", handleMouseUp);\n\n        div.style.border = \"1px dashed #858585\";\n        div.style.width = \"0px\";\n        div.style.height = \"0px\";\n\n        div.style.left = `${event.offsetX}px`;\n        div.style.top = `${event.offsetY}px`;\n        if (field) field.appendChild(div);\n      }\n    }\n\n\n    function handleMouseMove(event: MouseEvent): void {\n\n      if (!event.defaultPrevented) {\n\n        const delta: Position = {\n          x: Math.abs(event.pageX - startPos.x),\n          y: Math.abs(event.pageY - startPos.y)\n        }\n\n        let moving: Position = { x: 0, y: 0 };\n\n        if (startPos.x >= event.pageX && startPos.y >= event.pageY) { // левый верхний\n          moving = { x: -delta.x, y: -delta.y };\n        } else if (startPos.x <= event.pageX && startPos.y >= event.pageY) { // правый верхний\n          moving = { x: 0, y: -delta.y };\n        } else if (startPos.x >= event.pageX && startPos.y <= event.pageY) { // левый нижний\n          moving = { x: -delta.x, y: 0 };\n        }\n\n        div.style.width = `${delta.x}px`;\n        div.style.height = `${delta.y}px`;\n\n        div.style.left = `${startOffsetPos.x + moving.x}px`;\n        div.style.top = `${startOffsetPos.y + moving.y}px`;\n      }\n    }\n\n    function handleMouseUp(): void {\n\n      if (div.offsetWidth > 2 && div.offsetHeight > 2) {\n        areaSelection(div.offsetLeft, div.offsetTop, div.offsetWidth, div.offsetHeight);\n      }\n      div.remove();\n\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n      document.removeEventListener(\"mouseup\", handleMouseUp);\n\n    }\n\n    function handleMousedownDocument(event: Event): void {\n      if (!event.defaultPrevented && area.current) {\n        event.preventDefault();\n        if (area.current !== event.target) {\n          resetAreaSelection();\n        }\n      }\n    }\n\n    function handleMousedownArea(event: MouseEvent) {\n      event.preventDefault();\n    }\n\n    \n    verify(field).addEventListener(\"mousedown\", handleMousedown);\n    if (selectArea) selectArea.addEventListener(\"mousedown\", handleMousedownArea);\n    document.addEventListener(\"mousedown\", handleMousedownDocument);\n    return () => {\n      if (field) field.removeEventListener(\"mousedown\", handleMousedown);\n      if (selectArea) selectArea.removeEventListener(\"mousedown\", handleMousedownArea);\n      document.removeEventListener(\"mousedown\", handleMousedownDocument);\n    };\n  }, [canvas, area, areaSelection, resetAreaSelection]);\n}","import styles from \"./Canvas.module.css\";\r\nimport { ReactElement, useRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Img from \"./img/Img\"\r\nimport Text from \"./text/Text\"\r\nimport ArtObj from \"./artObj/ArtObj\"\r\nimport Filter from \"./filter/Filter\"\r\nimport DeleteArea from \"./deleteArea/DeleteArea\"\r\nimport AreaSelection from \"./areaSelection/AreaSelection\";\r\nimport { Block, Canvas as CanvasType, Size, BlockTypes } from \"../../store/types\";\r\nimport { AppDispatch, RootState } from \"../../store/store\";\r\nimport { areaSelection, resetAreaSelection } from \"../../store/actionCreators/canvasActionCreators\";\r\nimport { calcSizeImgByCanvas } from \"../../utils/size\";\r\n\r\ntype CanvasProps = {\r\n  canvas: CanvasType,\r\n  bgColor: string | null,\r\n  canvasSize: Size | null,\r\n  areaSelection: (x: number, y: number, width: number, height: number) => void,\r\n  resetAreaSelection: () => void,\r\n}\r\n\r\nfunction Canvas(props: CanvasProps) {\r\n  const canvasStyle = getStyle(props.canvas, props.bgColor, props.canvasSize);\r\n  const listBlock: ReactElement[] = getListBlock(props.canvas.listBlock);\r\n  const canvas = useRef<HTMLDivElement>(null);\r\n\r\n  return (\r\n    <div className={styles.canvas} style={canvasStyle} ref={canvas}>\r\n      <AreaSelection ref={canvas} />\r\n      <DeleteArea />\r\n      <Filter />\r\n      {listBlock}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => {\r\n  return {\r\n    canvas: state.canvas,\r\n    area: state.viewModel.areaSelection,\r\n    bgColor: state.viewModel.bgColor,\r\n    canvasSize: state.viewModel.canvasSize,\r\n  }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    areaSelection: (x: number, y: number, width: number, height: number) => dispatch(areaSelection(x, y, width, height)),\r\n    resetAreaSelection: () => dispatch(resetAreaSelection()),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Canvas);\r\n\r\n\r\nfunction getListBlock(listBlock: Block[]): ReactElement[] {\r\n  let newListBlock: ReactElement[] = [];\r\n  listBlock.forEach((block: Block) => {\r\n    switch (block.type) {\r\n      case BlockTypes.text: newListBlock.push(<Text text={block} key={block.id} />);\r\n        break;\r\n      case BlockTypes.img: newListBlock.push(<Img img={block} key={block.id} />);\r\n        break;\r\n      case BlockTypes.artObj: newListBlock.push(<ArtObj artObj={block} key={block.id} />);\r\n        break;\r\n    }\r\n  });\r\n  return newListBlock;\r\n}\r\n\r\nfunction getStyle(canvas: CanvasType, bgColor: string | null, canvasSize: Size | null) {\r\n  let backgroundColor: string = \"#fff\";\r\n  let backgroundImage: string = \"\";\r\n\r\n  if (bgColor) {\r\n    backgroundColor = bgColor;\r\n  } else {\r\n    if (canvas.background.color) {\r\n      backgroundColor = canvas.background.color;\r\n    } else if (canvas.background.src) {\r\n      backgroundImage = `url(${canvas.background.src})`;\r\n    }\r\n  }\r\n\r\n  let width: number = 0;\r\n  let height: number = 0;\r\n  if (canvasSize) {\r\n    width = canvasSize.width;\r\n    height = canvasSize.height;\r\n  } else {\r\n    width = canvas.width;\r\n    height = canvas.height;\r\n  }\r\n\r\n  const bgWidth: number | null = canvas.background.width;\r\n  const bgHeight: number | null = canvas.background.height;\r\n\r\n  let bgSize: Size | null = null;\r\n\r\n  if (bgWidth && bgHeight) {\r\n    bgSize = calcSizeImgByCanvas(bgWidth, bgHeight, width, height);\r\n  }\r\n\r\n  return {\r\n    width: width,\r\n    height: height,\r\n    backgroundColor: backgroundColor,\r\n    backgroundImage: backgroundImage,\r\n    backgroundSize: bgSize ? `${bgSize.width}px ${bgSize.height}px` : \"\",\r\n  };\r\n}","import styles from \"./ButtonEditText.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { useEditStateText } from \"./useEditStateText\";\n\ntype ButtonEditTextProps = {\n  icon: IconDefinition,\n  enabled: boolean | null,\n  modifyFn: ((enabled: boolean) => void) | (() => void),\n  param: boolean,\n}\n\nfunction ButtonEditText(props: ButtonEditTextProps) {\n  const button = useRef<HTMLButtonElement>(null);\n\n  useEditStateText(button, props.enabled, props.modifyFn, props.param);\n\n  return (\n    <button className={`${styles.button} ${props.enabled ? styles.active : \"\"}`} ref={button}>\n      <FontAwesomeIcon icon={props.icon} />\n    </button>\n  );\n};\n\n\nexport default connect()(ButtonEditText);","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useEditStateText(\n  button: RefObject<HTMLButtonElement>,\n  enabled: boolean | null,\n  modifyFn: (() => void) | ((enabled: boolean) => void),\n  param: boolean) {\n\n  useEffect(() => {\n\n    const btn: HTMLButtonElement | null = button.current;\n\n    function handleClickButton(event: Event) {\n      if (enabled !== null) {\n        modifyFn(!enabled)\n        event.preventDefault();\n      } else if (!param) {\n        modifyFn(true)\n      }\n    }\n\n\n    verify(btn).addEventListener(\"click\", handleClickButton);\n    return () => {\n      if (btn) btn.removeEventListener(\"click\", handleClickButton);\n    };\n  }, [button, modifyFn, enabled, param]);\n}","import styles from \"./ColorPicker.module.css\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport { inputColorText, setColorText } from \"../../../../store/actionCreators/textBlockActionCreators\";\nimport { useEditColorText } from \"./useEditColorText\";\n\ntype ColorPickerProps = {\n  setColorText: (color: string) => void,\n  inputColorText: (color: string) => void,\n  color: string | null\n}\n\nfunction ColorPicker(props: ColorPickerProps) {\n  const colorPicker = useRef<HTMLInputElement>(null);\n  useEditColorText(props.color, colorPicker, props.setColorText, props.inputColorText);\n  return (\n    <input type=\"color\"\n      ref={colorPicker}\n      className={styles.input}\n    />\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    color: state.viewModel.text.color,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    setColorText: (color: string) => dispatch(setColorText(color)),\n    inputColorText: (color: string) => dispatch(inputColorText(color)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColorPicker);\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useEditColorText(\n  color: string | null,\n  colorPicker: RefObject<HTMLInputElement>,\n  setColorText: (color: string) => void,\n  inputColorText: (color: string) => void) {\n\n  useEffect(() => {\n\n    const inputColor: HTMLInputElement | null = colorPicker.current;\n\n    verify(inputColor).value = color ? color : \"#000000\";\n\n    function handleInput(event: Event) {\n      const target = event.target as HTMLInputElement;\n      inputColorText(target.value);\n    }\n  \n    function handleChange(event: Event) {\n      const target = event.target as HTMLInputElement;\n      setColorText(target.value);\n    }\n    \n    function handleClick(event: Event) {\n      event.stopImmediatePropagation();\n    }\n\n\n    verify(inputColor).addEventListener(\"input\", handleInput);\n    verify(inputColor).addEventListener(\"change\", handleChange);\n    verify(inputColor).addEventListener(\"click\", handleClick);\n    return () => {\n      if (inputColor) {\n        inputColor.removeEventListener(\"input\", handleInput);\n        inputColor.removeEventListener(\"change\", handleChange);\n        inputColor.removeEventListener(\"click\", handleClick);\n      }\n    };\n  }, [color, colorPicker, setColorText, inputColorText]);\n}","import styles from \"./InputNumber.module.css\";\nimport { connect } from \"react-redux\";\nimport { useEditFontSize } from \"./useEditFontSize\";\nimport { useRef } from \"react\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport { inputSizeText, setSizeText } from \"../../../../store/actionCreators/textBlockActionCreators\";\n\ntype InputNumberProps = {\n  size: number | null,\n  tempSize: number | null,\n  setSizeText: (size: number) => void,\n  inputSizeText: (size: number) => void,\n}\n\nfunction InputNumber(props: InputNumberProps) {\n  const inputNumber = useRef<HTMLInputElement>(null);\n  useEditFontSize(props.size, inputNumber, props.setSizeText, props.inputSizeText);\n\n  return (\n    <input type=\"number\"\n      ref={inputNumber}\n      className={styles.input__number}\n      min={10}\n      max={150}\n      step={1}\n    />\n  )\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    size: state.viewModel.text.size,\n    tempSize: state.viewModel.text.tempSize,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    setSizeText: (size: number) => dispatch(setSizeText(size)),\n    inputSizeText: (size: number) => dispatch(inputSizeText(size))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(InputNumber);\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useEditFontSize(\n  size: number | null,\n  input: RefObject<HTMLInputElement>,\n  setSizeText: (size: number) => void,\n  inputSizeText: (size: number) => void) {\n\n  useEffect(() => {\n\n    const defSize: number = 10;\n\n    const fieldSize: HTMLInputElement | null = input.current;\n\n    verify(fieldSize).value = size ? String(size) : `${defSize}`;\n\n    function handleInput(event: Event) {\n      const target = event.target as HTMLInputElement;\n      if (Number(target.value) > defSize) {\n        inputSizeText(Number(target.value));\n      } else {\n        inputSizeText(defSize);\n      }\n    }\n\n    function handleBlur(event: Event) {\n      const target = event.target as HTMLInputElement;\n      if (Number(target.value) > defSize) {\n        setSizeText(Number(target.value));\n      } else {\n        setSizeText(defSize);\n      }\n    }\n\n    function handleClick(event: Event) {\n      event.preventDefault();\n    }\n\n    function handlerKeydown(event: KeyboardEvent): void {\n      if (event.code === \"Delete\") {\n        event.preventDefault();\n      }\n    }\n\n    verify(fieldSize).addEventListener(\"input\", handleInput);\n    verify(fieldSize).addEventListener(\"blur\", handleBlur);\n    verify(fieldSize).addEventListener(\"click\", handleClick);\n    verify(fieldSize).addEventListener(\"keydown\", handlerKeydown);\n    return () => {\n      if (fieldSize) {\n        fieldSize.removeEventListener(\"input\", handleInput);\n        fieldSize.removeEventListener(\"blur\", handleBlur);\n        fieldSize.removeEventListener(\"click\", handleClick);\n      }\n    };\n  }, [size, input, setSizeText, inputSizeText]);\n}","import { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport styles from \"./SelectFontFamily.module.css\";\nimport { useRef } from \"react\";\nimport { useSelectFont } from \"./useSelectFont\";\nimport { setFontFamilyText } from \"../../../../store/actionCreators/textBlockActionCreators\";\n\ntype SelectFontFamilyProps = {\n  fontFamily: string | null,\n  setFontFamilyText: (fontFamily: string) => void,\n}\n\nfunction SelectFontFamily(props: SelectFontFamilyProps) {\n  const select = useRef<HTMLSelectElement>(null);\n\n  useSelectFont(select, props.setFontFamilyText);\n\n  const listParameters: {value: string, class: string}[] = [\n    { value: \"Roboto Slab\", class: styles.robotoSlab },\n    { value: \"Fantazyor\", class: styles.fantazyor },\n    { value: \"Piroucyrillic\", class: styles.piroucyrillic },\n    { value: \"Phenomena\", class: styles.phenomena },\n    { value: \"Sunday\", class: styles.sunday },\n    { value: \"Kurale\", class: styles.kurale },\n    { value: \"Sensei\", class: styles.sensei },\n    { value: \"Borsok\", class: styles.borsok },\n    { value: \"Summer\", class: styles.summer },\n    { value: \"Underdog\", class: styles.underdog },\n    { value: \"Montserrat\", class: styles.montserrat },\n    { value: \"OpenSans\", class: styles.openSans },\n    { value: \"Comfortaa\", class: styles.comfortaa },\n    { value: \"Rubik\", class: styles.rubik },\n    { value: \"Marta\", class: styles.marta },\n  ]\n\n  let fontFamilies: JSX.Element[] = listParameters.map((element, index) => {\n    return <option key={index} className={element.class} value={element.value}>{element.value}</option>\n  })\n\n  let currentStyle: string = fontFamilies[0].props.className;\n\n  fontFamilies = fontFamilies.map((element: JSX.Element) => {\n    if (element.props.value === props.fontFamily) {\n      currentStyle = element.props.className;\n      return {\n        ...element,\n        props: {\n          ...element.props,\n          selected: true\n        }\n      }\n    } else {\n      return element\n    }\n  });\n\n  return (\n    <select name=\"\" id=\"\" className={`${styles.select} ${currentStyle}`} ref={select}>\n      {fontFamilies}\n    </select>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    fontFamily: state.viewModel.text.fontFamily\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    setFontFamilyText: (fontFamily: string) => dispatch(setFontFamilyText(fontFamily)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SelectFontFamily);","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useSelectFont(\n  select: RefObject<HTMLSelectElement>,\n  setFontFamilyText: (fontFamily: string) => void) {\n\n  useEffect(() => {\n\n    const selectFontFamily: HTMLSelectElement | null = select.current;\n    \n    function handleClick(event: Event) {\n      event.preventDefault();\n    }\n\n    function handleChange(event: Event) {\n      const target = event.target as HTMLOptionElement;\n      setFontFamilyText(target.value);\n    }\n\n    \n    verify(selectFontFamily).addEventListener(\"click\", handleClick);\n    verify(selectFontFamily).addEventListener(\"change\", handleChange);\n    return () => {\n      if (selectFontFamily) {\n        selectFontFamily.removeEventListener(\"click\", handleClick);\n        selectFontFamily.removeEventListener(\"change\", handleChange);\n      }\n    };\n  }, [select, setFontFamilyText]);\n}","import styles from \"./ToolbarText.module.css\";\nimport { faBold, faItalic, faUnderline, faFont } from \"@fortawesome/free-solid-svg-icons\"\nimport { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../store/store\";\nimport {\n  createTextBlock,\n  setBoldText,\n  setItalicText,\n  setUnderlineText\n} from \"../../../store/actionCreators/textBlockActionCreators\";\nimport ButtonEditText from \"./buttonEditText/ButtonEditText\";\nimport ColorPicker from \"./colorPicker/ColorPicker\";\nimport InputNumber from \"./inputNumber/InputNumber\";\nimport SelectFontFamily from \"./selectFontFamily/SelectFontFamily\";\n\n\ntype ToolbarTextProps = {\n  createTextBlock: () => void,\n  setBoldText: (isBold: boolean) => void,\n  setItalicText: (isItalic: boolean) => void,\n  setUnderlineText: (isUnderline: boolean) => void,\n  bold: boolean | null,\n  italic: boolean | null,\n  underline: boolean | null,\n}\n\nfunction ToolbarText(props: ToolbarTextProps) {\n  return (\n    <div className={styles.toolbar}>\n\n      <div className={styles.toolbar__row}>\n        <SelectFontFamily />\n        <ButtonEditText icon={faFont} enabled={null} modifyFn={props.createTextBlock} param={false} />\n      </div>\n\n      <div className={styles.toolbar__row}>\n        <InputNumber />\n\n        <ButtonEditText icon={faBold} enabled={props.bold} modifyFn={props.setBoldText} param={true} />\n        <ButtonEditText icon={faItalic} enabled={props.italic} modifyFn={props.setItalicText} param={true} />\n        <ButtonEditText icon={faUnderline} enabled={props.underline} modifyFn={props.setUnderlineText} param={true} />\n        <div className={styles.colorPickerBox}>\n          <ColorPicker />\n        </div>\n      </div>\n\n    </div>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    bold: state.viewModel.text.bold,\n    italic: state.viewModel.text.italic,\n    underline: state.viewModel.text.underline,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createTextBlock: () => dispatch(createTextBlock()),\n    setBoldText: (isBold: boolean) => dispatch(setBoldText(isBold)),\n    setItalicText: (isItalic: boolean) => dispatch(setItalicText(isItalic)),\n    setUnderlineText: (isUnderline: boolean) => dispatch(setUnderlineText(isUnderline)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarText);\n","import styles from \"./DropdownMenu.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { connect } from \"react-redux\";\nimport { ReactElement } from \"react\";\n\ntype DropdownMenuProps = {\n  minWidth: number,\n  label: string,\n  icon: IconDefinition,\n  children: ReactElement[],\n}\nfunction DropdownMenu(props: DropdownMenuProps) {\n  return (\n    <div className={styles.dropdown}>\n      <button className={styles.dropbtn}>\n        <FontAwesomeIcon icon={props.icon} />\n        <span className={styles.dropdownText}>{props.label}</span>\n      </button>\n      <div className={styles.dropdownContent} style={{ minWidth: props.minWidth }}>\n        {props.children}\n      </div>\n    </div>\n  );\n}\n\nexport default connect()(DropdownMenu);\n","import styles from \"./AddImgButtonFile.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\n\ntype NavButtonProps = {\n  label: string,\n  icon: IconDefinition,\n}\n\nconst AddImgButton = forwardRef((props: NavButtonProps, ref: ForwardedRef<HTMLInputElement>) => (\n  <button className={styles.button}>\n    <label htmlFor=\"input-file-img\" className={styles.icon}>\n      <FontAwesomeIcon icon={props.icon} />\n    </label>\n    <input\n      className={styles.inputFile}\n      type=\"file\"\n      accept=\".png,.jpg,.jfif,.jpe,.jpeg\"\n      ref={ref}\n      id=\"input-file-img\"\n    />\n    <label className={styles.buttonText}\n      htmlFor=\"input-file-img\">\n      {props.label}\n    </label>\n  </button>\n));\n\nexport default connect(null, null, null, { forwardRef: true })(AddImgButton);","import styles from \"./PreviewArtObj.module.css\";\nimport { useCreateArtObj } from \"./useCreateArtObj\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../../store/store\";\nimport { createArtObjBlock } from \"../../../../store/actionCreators/artObjBlockActionCreators\";\n\ntype PreviewArtObjProps = {\n  src: string,\n  createArtObjBlock: (src: string) => void,\n}\n\nfunction PreviewArtObj(props: PreviewArtObjProps) {\n\n  const img = useRef<HTMLImageElement>(null);\n  useCreateArtObj(img, props.src, props.createArtObjBlock);\n  return (\n    <img src={props.src} alt=\"\" ref={img} className={styles.sticker} />\n  );\n}\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createArtObjBlock: (src: string) => dispatch(createArtObjBlock(src)),\n  }\n}\n\nexport default connect(null, mapDispatchToProps)(PreviewArtObj);","import { store } from \"../store\";\n\nexport function createArtObjBlock(src: string) {\n  return {\n    type: \"CREATE_ART_OBJ_BLOCK\",\n    src: src,\n    x: (store.getState().canvas.width / 2) - 75,\n    y: (store.getState().canvas.height / 2) - 75,\n  }\n}\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useCreateArtObj(\n  artObj: RefObject<HTMLElement>,\n  src: string,\n  createArtObjBlock: (src: string) => void) {\n\n  useEffect(() => {\n\n    const artObjPreview: HTMLElement | null = artObj.current;\n\n    function handleClickArtObj() {\n      createArtObjBlock(src);\n    }\n\n\n    verify(artObjPreview).addEventListener(\"click\", handleClickArtObj);\n    return () => {\n      if (artObjPreview) artObjPreview.removeEventListener(\"click\", handleClickArtObj);\n    };\n  }, [artObj, src, createArtObjBlock]);\n}","import { CardMaker } from \"../store/types\";\n\n// файл изображения в base64\nexport const getImgInformationFromFile = async (fileImg: File): Promise<HTMLImageElement> => {\n\n  const promise = new Promise((resolve, reject) => {\n    const reader: FileReader = new FileReader();\n    reader.readAsDataURL(fileImg);\n    reader.onload = async () => resolve(reader.result);\n    reader.onerror = reject;\n  });\n    const img: HTMLImageElement = new Image();\n    img.src = await promise as string;\n    await img.decode();\n    return img;\n}\n\n// json файл проекта в объект\nexport const getProjectFromFile = async (file: File): Promise<CardMaker> =>\n  JSON.parse(await new Promise((resolve, reject) => {\n    const reader: FileReader = new FileReader();\n    reader.readAsText(file);\n    reader.onload = () => resolve(reader.result as string);\n    reader.onerror = reject;\n  }));","import { store } from \"../store\"\nexport function createImgBlock(src: string, width: number, height: number) {\n  return {\n    type: \"CREATE_IMG_BLOCK\",\n    src: src,\n    width: width,\n    height: height,\n    x: (store.getState().canvas.width / 2) - (width / 2),\n    y: (store.getState().canvas.height / 2) - (height / 2),\n  }\n}","import { Dispatch, RefObject, SetStateAction, useEffect } from \"react\"\n\nexport function useGetPhotoAPI(\n  buttonSearch: RefObject<HTMLButtonElement>,\n  buttonNext: RefObject<HTMLButtonElement>,\n  buttonBack: RefObject<HTMLButtonElement>,\n  input: RefObject<HTMLInputElement>,\n  loadingIndicator: RefObject<HTMLDivElement>,\n  information: RefObject<HTMLDivElement>,\n  setImages: (value: string[]) => void,\n  next: string | null,\n  back: string | null,\n  setNext: Dispatch<SetStateAction<null>>,\n  setBack: Dispatch<SetStateAction<null>>\n): void {\n\n\n  useEffect(() => {\n\n    const btnSearch: HTMLButtonElement | null = buttonSearch.current\n    const btnNext: HTMLButtonElement | null = buttonNext.current\n    const btnBack: HTMLButtonElement | null = buttonBack.current\n\n    if (next && buttonNext.current) {\n      buttonNext.current.style.visibility = \"visible\";\n    } else if (buttonNext.current) {\n      buttonNext.current.style.visibility = \"hidden\";\n    }\n\n    if (back && buttonBack.current) {\n      buttonBack.current.style.visibility = \"visible\";\n    } else if (buttonBack.current) {\n      buttonBack.current.style.visibility = \"hidden\";\n    }\n\n    async function handlerClickSearch() {\n      if (input.current) {\n        if (loadingIndicator.current) {\n          loadingIndicator.current.style.display = \"block\";\n        }\n        try {\n          const result = await search(input.current.value);\n          renderImg(result.photos);\n          if (result.next_page) {\n            setNext(result.next_page);\n          } else if (next) {\n            setNext(null);\n          }\n          if (back) {\n            setBack(null);\n          }\n          if (result.photos.length > 0 && information.current) {\n            information.current.innerText = \"\";\n          }\n          if (result.photos.length === 0 && information.current) {\n            throw new Error();\n          }\n        } catch {\n          if (information.current) {\n            information.current.innerText = \"По данному запросу ничего не найдено\";\n          }\n        }\n        if (loadingIndicator.current) {\n          loadingIndicator.current.style.display = \"none\";\n        }\n      }\n    }\n\n    async function handlerClickLink(event: Event) {\n      const link: string | null = event.target === buttonNext.current ? next : back;\n      if (input.current) {\n        if (loadingIndicator.current) {\n          loadingIndicator.current.style.display = \"block\";\n        }\n        try {\n          const result = await search(input.current.value, link);\n          if (loadingIndicator.current) {\n            loadingIndicator.current.style.display = \"none\";\n          }\n          renderImg(result.photos);\n          if (result.next_page) {\n            setNext(result.next_page);\n          } else if (next) {\n            setNext(null);\n          }\n          if (result.prev_page) {\n            setBack(result.prev_page);\n          } else if (back) {\n            setBack(null);\n          }\n        } catch {\n          if (information.current) {\n            information.current.innerText = \"Ссылка недействительна\";\n          }\n        }\n      }\n    }\n\n    function renderImg(photos: any[]) {\n      const arr: string[] = [];\n      for (let item of photos) {\n        arr.push(item.src.large);\n      }\n      setImages(arr);\n    }\n\n\n    if (btnSearch) btnSearch.addEventListener(\"click\", handlerClickSearch);\n    if (btnNext) btnNext.addEventListener(\"click\", handlerClickLink);\n    if (btnBack) btnBack.addEventListener(\"click\", handlerClickLink);\n    return () => {\n      if (btnSearch) btnSearch.removeEventListener(\"click\", handlerClickSearch)\n      if (btnNext) btnNext.removeEventListener(\"click\", handlerClickLink)\n      if (btnBack) btnBack.removeEventListener(\"click\", handlerClickLink)\n    }\n  });\n}\n\nasync function search(query: string, src: string | null = null) {\n  if (query.split(\" \").join(\"\") !== \"\") {\n    let response: Response = await fetch(src ? src : \"https://api.pexels.com/v1/search?per_page=20&locale=ru-RU&query=\" + query, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"User-Agent\": \"Pexels/JavaScript\",\n        \"Authorization\": \"563492ad6f9170000100000107aa3c55704e4fccb227b495534c2ef1\",\n      },\n    });\n    return await response.json();\n  }\n\n}","import { RefObject, useRef } from \"react\";\nimport { connect } from \"react-redux\";\n\ntype ImgProps = {\n  src: string,\n  baseSrc: string,\n  useImg: (img: RefObject<HTMLImageElement>, url: string, setModal: (value: boolean) => void) => void,\n  setModal: (value: boolean) => void,\n}\n\nfunction Img(props: ImgProps) {\n  const img = useRef<HTMLImageElement>(null);\n  props.useImg(img, props.baseSrc, props.setModal);\n  return (\n    <img key={props.src} src={props.src} width={375} loading=\"lazy\" ref={img} alt=\"\" />\n  );\n}\n\nexport default connect()(Img);","import { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport styles from \"./LoadingIndicator.module.css\";\n\nconst LoadingIndicator = forwardRef((props: {}, ref: ForwardedRef<HTMLDivElement>) => {\n  return (\n    <div className={styles.cssloadSpinBox} ref={ref}></div>\n  )\n});\n\nexport default connect(null, null, null, { forwardRef: true })(LoadingIndicator);","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\"\nimport { RefObject, useEffect, useRef, useState } from \"react\"\nimport { connect } from \"react-redux\"\nimport styles from \"./ModalSearchImg.module.css\";\nimport { useGetPhotoAPI } from \"./useGetPhotoAPI\";\nimport Img from \"./Img\";\nimport LoadingIndicator from \"./loadingIndicator/LoadingIndicator\";\n\n// интерфейс для пропсов\ntype ModalSearchImgProps = {\n  visible: boolean,\n  setModal: (value: boolean) => void,\n  useImg: (img: RefObject<HTMLImageElement>, url: string, setModal: (value: boolean)=> void) => void,\n  onClose: () => void,\n}\n\nconst ModalSearchImg = ({\n  visible = false,\n  setModal,\n  useImg,\n  onClose,\n}: ModalSearchImgProps) => {\n\n  // c помощью useEffect цепляем обработчик к нажатию клавиш\n  useEffect(() => {\n    // создаем обработчик нажатия клавиши Esc\n    const onKeydown = ({ key }: KeyboardEvent) => {\n      switch (key) {\n        case \"Escape\":\n          onClose()\n          break\n      }\n    }\n    document.addEventListener(\"keydown\", onKeydown)\n    return () => document.removeEventListener(\"keydown\", onKeydown)\n  }, [onClose])\n\n  const buttonSearch = useRef<HTMLButtonElement>(null);\n  const buttonNext = useRef<HTMLButtonElement>(null);\n  const buttonBack = useRef<HTMLButtonElement>(null);\n  const input = useRef<HTMLInputElement>(null);\n  const loadingIndicator = useRef<HTMLDivElement>(null);\n  const information = useRef<HTMLDivElement>(null);\n\n\n\n  const [images, setImages] = useState([] as string[]);\n  const [next, setNext] = useState(null);\n  const [back, setBack] = useState(null);\n\n  useGetPhotoAPI(\n    buttonSearch,\n    buttonNext,\n    buttonBack,\n    input,\n    loadingIndicator,\n    information,\n    setImages,\n    next,\n    back,\n    setNext,\n    setBack\n  );\n\n  \n  useEffect(() => {\n    if (!visible) {\n      setImages([]);\n      setNext(null);\n      setBack(null);\n    }\n  }, [visible]);\n\n  // если компонент невидим, то не отображаем его\n  if (!visible) {\n    return null;\n  }\n  const images1 = [...images];\n  const images2 = images1.splice(images1.length / 2)\n\n  const onCloseModal = () => {\n    onClose();\n    setImages([]);\n    setNext(null);\n    setBack(null);\n  }\n\n  // или возвращаем верстку модального окна\n  return (\n    <div className={styles.modal} onClick={onCloseModal}>\n      <div className={styles.modalDialog} onClick={e => e.stopPropagation()}>\n        <div className={styles.modalHeader}>\n          <h3 className={styles.modalTitle}>Поиск фотографий</h3>\n          <span className={styles.modalClose} onClick={onCloseModal}>\n            <FontAwesomeIcon icon={faTimes} />\n          </span>\n        </div>\n\n        <div className={styles.modalHeader}>\n          <div className={styles.searchBox}>\n            <input type=\"text\" ref={input} />\n            <button ref={buttonSearch}>Поиск</button>\n            <LoadingIndicator ref={loadingIndicator} />\n          </div>\n          <div className={styles.navBox}>\n            <button ref={buttonBack}>Назад</button>\n            <button ref={buttonNext}>Вперед</button>\n          </div>\n\n        </div>\n\n        <div className={styles.modalBody}>\n          <div className={styles.modalContent}>\n            <div className={styles.information} ref={information}>Введите поисковой запрос</div>\n            <div style={{ display: \"inline-block\" }}>\n              {images1.map((src: string) => <Img key={src} setModal={setModal}\n                useImg={useImg}\n                src={src}\n                baseSrc={src} />)}\n            </div>\n            <div style={{ display: \"inline-block\" }}>\n              {images2.map((src: string) => <Img key={src} setModal={setModal}\n                useImg={useImg}\n                src={src}\n                baseSrc={src} />)}\n            </div>\n          </div>\n\n        </div>\n        <div className={styles.modalFooter}></div>\n      </div>\n    </div>\n  )\n}\n\nexport default connect()(ModalSearchImg)","import { RefObject, useEffect } from \"react\";\nimport { createImgBlock } from \"../../../../store/actionCreators/imgBlockActionCreators\";\nimport { store } from \"../../../../store/store\";\n\nexport function useCreateImgByUrl(\n  img: RefObject<HTMLImageElement>,\n  url: string,\n  setModal: (value: boolean) => void,\n) {\n  useEffect(() => {\n    const image: HTMLImageElement | null = img.current;\n    async function handlerClick() {\n      const newImage: HTMLImageElement = new Image();\n      newImage.src = url;\n      await newImage.decode();\n      store.dispatch(createImgBlock(newImage.src, newImage.width, newImage.height));\n      setModal(false);\n    }\n\n    if (image) image.addEventListener(\"click\", handlerClick);\n    return () => {\n      if (image) image.removeEventListener(\"click\", handlerClick)\n    }\n  }, [img, url, setModal]);\n}","import styles from \"./AddImgByUrlButton.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../../store/store\";\nimport { createImgBlock } from \"../../../../store/actionCreators/imgBlockActionCreators\";\nimport ModalSearchImg from \"../../modalSearchImg/ModalSearchImg\";\nimport { useCreateImgByUrl } from \"./useCreateImgByUrl\";\n\ntype NavButtonProps = {\n  label: string,\n  icon: IconDefinition,\n  createImgBlock: (src: string, width: number, height: number) => void,\n}\n\nconst AddImgByUrlButton = forwardRef((props: NavButtonProps, ref: ForwardedRef<HTMLButtonElement>) => {\n  const [isModal, setModal] = useState(false);\n  const onClose = () => setModal(false);\n\n  return (\n    <>\n      <button\n        onClick={() => setModal(true)}\n        ref={ref}\n        className={styles.button}>\n        <FontAwesomeIcon icon={props.icon} />\n        <span className={styles.buttonText}>{props.label}</span>\n      </button>\n      <ModalSearchImg visible={isModal} onClose={onClose} setModal={setModal} useImg={useCreateImgByUrl} />\n    </>\n  );\n});\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createImgBlock: (src: string, width: number, height: number) => dispatch(createImgBlock(src, width, height)),\n  }\n}\n\nexport default connect(null, mapDispatchToProps, null, { forwardRef: true })(AddImgByUrlButton);","import styles from \"./ToolbarImg.module.css\";\nimport { faDownload, faGlobe, faStickyNote } from \"@fortawesome/free-solid-svg-icons\"\nimport DropdownMenu from \"../../dropdownMenu/DropdownMenu\";\nimport AddImgButtonFile from \"./addImgButtonFile/AddImgButtonFile\";\nimport PreviewArtObj from \"./previewArtObj/PreviewArtObj\";\nimport { SetOfArtObject } from \"../../../store/types\";\nimport { useCreateImg } from \"./useCreateImg\";\nimport { ReactElement } from \"react\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../store/store\";\nimport { createImgBlock } from \"../../../store/actionCreators/imgBlockActionCreators\";\nimport AddImgByUrlButton from \"./addImgByUrlButton/AddImgByUrlButton\";\n\ntype ToolbarImgProps = {\n  createImgBlock: (src: string, width: number, height: number) => void,\n}\n\nfunction ToolbarImg(props: ToolbarImgProps) {\n\n  // формирование списка стикеров\n  const srcList: SetOfArtObject[] = Object.values(SetOfArtObject);\n  const imgList: ReactElement[] = [];\n  srcList.forEach((src, index) => {\n    imgList.push(<PreviewArtObj src={src} key={index} />);\n  });\n\n  const inputFile = useRef<HTMLInputElement>(null);\n\n  useCreateImg(inputFile, props.createImgBlock);\n\n  return (\n    <div className={styles.toolbar}>\n      <div className={styles.button_box}>\n        <AddImgButtonFile label=\"C компьютера\" icon={faDownload} ref={inputFile} />\n\n        <AddImgByUrlButton label=\"Из Pixels\" icon={faGlobe} />\n\n        <DropdownMenu minWidth={200} label=\"Стикеры\" icon={faStickyNote}>\n          {imgList}\n        </DropdownMenu>\n      </div>\n    </div>\n  );\n}\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createImgBlock: (src: string, width: number, height: number) => dispatch(createImgBlock(src, width, height)),\n  }\n}\n\nexport default connect(null, mapDispatchToProps)(ToolbarImg);","import { RefObject, useEffect } from \"react\";\nimport { getImgInformationFromFile } from \"../../../utils/files\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useCreateImg(\n  inputFile: RefObject<HTMLInputElement>,\n  createImgBlock: (src: string, width: number, height: number) => void) {\n\n  useEffect(() => {\n\n    const input = inputFile.current;\n\n    async function handlerChangeInput(): Promise<void> {\n\n      if (input) {\n        const files: FileList | null = input.files;\n        try {\n          if (files) {\n            const img: HTMLImageElement = await getImgInformationFromFile(files[0]);\n            createImgBlock(img.src, img.width, img.height);\n          }\n        } catch {\n          alert(\"Ошибка при импорте изображения. Проверьте исходный файл и повторите попытку\");\n        }\n        input.value = \"\";\n      }\n    }\n\n\n    verify(input).addEventListener(\"change\", handlerChangeInput);\n    return () => {\n      if (input) input.removeEventListener(\"change\", handlerChangeInput);\n    };\n  }, [inputFile, createImgBlock]);\n}","import styles from \"./ColorPicker.module.css\";\nimport { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\n\nconst ColorPicker = forwardRef((props: {}, ref: ForwardedRef<HTMLInputElement>) => (\n  <input type=\"color\"\n    ref={ref}\n    className={styles.input__color}\n  />\n));\n\nexport default connect(null, null, null, { forwardRef: true })(ColorPicker);\n","import styles from \"./ToolbarFilter.module.css\";\r\nimport ColorPicker from \"../colorPicker/ColorPicker\";\r\nimport { useRef } from \"react\";\r\nimport { useStateFilter } from \"./useStateFilter\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport { inputFilter, setFilter } from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { connect } from \"react-redux\";\r\nimport { Filter } from \"../../../store/types\";\r\n\r\ntype ToolbarFilterProps = {\r\n  inputFilter: (color: string, opacity: number) => void,\r\n  setFilter: (color: string, opacity: number) => void,\r\n  filter: Filter,\r\n}\r\n\r\nfunction ToolbarFilter(props: ToolbarFilterProps) {\r\n  const inputColor = useRef<HTMLInputElement>(null);\r\n  const inputRange = useRef<HTMLInputElement>(null);\r\n  useStateFilter(\r\n    inputColor,\r\n    inputRange,\r\n    props.inputFilter,\r\n    props.setFilter,\r\n    props.filter\r\n  );\r\n  return (\r\n    <>\r\n      <div className={styles.toolbar}>\r\n        <div className={styles.row}>\r\n          <label className={styles.label}>Цвет фильтра:</label>\r\n          <ColorPicker ref={inputColor} />\r\n        </div>\r\n        <input type=\"range\" min=\"0\" max=\"0.5\" step=\"0.025\" className={styles.inputRange} ref={inputRange} />\r\n      </div>\r\n\r\n    </>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  filter: state.canvas.filter,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    inputFilter: (color: string, opacity: number) => dispatch(inputFilter(color, opacity)),\r\n    setFilter: (color: string, opacity: number) => dispatch(setFilter(color, opacity)),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarFilter);\r\n","import { Filter } from \"../../../store/types\";\nimport { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useStateFilter(\n  inputColor: RefObject<HTMLInputElement>,\n  inputRange: RefObject<HTMLInputElement>,\n  inputFilter: (color: string, opacity: number) => void,\n  setFilter: (color: string, opacity: number) => void,\n  filter: Filter): void {\n\n  useEffect(() => {\n\n    const fieldColor: HTMLInputElement | null = inputColor.current;\n    const fieldRange: HTMLInputElement | null = inputRange.current;\n\n    verify(fieldColor).value = filter.color;\n    verify(fieldRange).value = String(filter.opacity);\n\n    function handleInputFilter(): void {\n      if (fieldRange && fieldColor) {\n        const color: string = fieldColor.value;\n        const opacity: number = Number(fieldRange.value);\n        inputFilter(color, opacity);\n      }\n    }\n\n    function handleChangeFilter(): void {\n      if (fieldRange && fieldColor) {\n        const opacity: number = Number(fieldRange.value);\n        const color: string = fieldColor.value;\n        setFilter(color, opacity);\n      }\n    }\n\n    verify(fieldColor).addEventListener(\"input\", handleInputFilter);\n    verify(fieldColor).addEventListener(\"change\", handleChangeFilter);\n    verify(fieldRange).addEventListener(\"input\", handleInputFilter);\n    verify(fieldRange).addEventListener(\"change\", handleChangeFilter);\n    return () => {\n      if (fieldColor) {\n        fieldColor.removeEventListener(\"input\", handleInputFilter);\n        fieldColor.removeEventListener(\"change\", handleChangeFilter);\n      }\n      if (fieldRange) {\n        fieldRange.removeEventListener(\"input\", handleInputFilter);\n        fieldRange.removeEventListener(\"change\", handleChangeFilter);\n      }\n    };\n  }, [inputColor, inputRange, inputFilter, setFilter, filter]);\n}","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\"\nimport { ReactElement, useEffect } from \"react\"\nimport { connect } from \"react-redux\"\nimport styles from \"./Modal.module.css\";\n\n// интерфейс для пропсов\ntype ModalProps = {\n  visible: boolean\n  title: string\n  content: ReactElement | string\n  footer: ReactElement | string\n  onClose: () => void\n}\n\nconst Modal = ({\n  visible = false,\n  title = \"\",\n  content = \"\",\n  footer = \"\",\n  onClose,\n}: ModalProps) => {\n\n  // c помощью useEffect цепляем обработчик к нажатию клавиш\n  useEffect(() => {\n    // создаем обработчик нажатия клавиши Esc\n    const onKeydown = ({ key }: KeyboardEvent) => {\n      switch (key) {\n        case \"Escape\":\n          onClose()\n          break\n      }\n    }\n    document.addEventListener(\"keydown\", onKeydown)\n    return () => document.removeEventListener(\"keydown\", onKeydown)\n  }, [onClose])\n\n  // если компонент невидим, то не отображаем его\n  if (!visible) {\n    return null;\n  }\n\n  // или возвращаем верстку модального окна\n  return (\n    <div className={styles.modal} onClick={onClose}>\n      <div className={styles.modalDialog} onClick={e => e.stopPropagation()}>\n        <div className={styles.modalHeader}>\n          <h3 className={styles.modalTitle}>{title}</h3>\n          <span className={styles.modalClose} onClick={onClose}>\n            <FontAwesomeIcon icon={faTimes} />\n          </span>\n        </div>\n        <div className={styles.modalBody}>\n          <div className={styles.modalContent}>{content}</div>\n        </div>\n        {footer && <div className={styles.modalFooter}>{footer}</div>}\n      </div>\n    </div>\n  )\n}\n\nexport default connect()(Modal)","import styles from \"./FileImgButton.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { useRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport Modal from \"../../../modal/Modal\";\nimport { useBackgroungImg } from \"../useBackgroungImg\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport {\n  inputBackgroundImg,\n  setBackgroundImg,\n  setCanvasSize\n} from \"../../../../store/actionCreators/canvasActionCreators\";\nimport { ViewModelBgImg } from \"../../../../store/types\";\n\ntype NavButtonProps = {\n  label: string,\n  icon: IconDefinition,\n  inputBackgroundImg: (src: string, width: number, height: number) => void,\n  setBackgroundImg: (src: string, width: number, height: number) => void,\n  setCanvasSize: (width: number, height: number) => void,\n  viewModelBgImg: ViewModelBgImg | null,\n}\n\nfunction AddImgButton(props: NavButtonProps) {\n\n  const inputFile = useRef<HTMLInputElement>(null);\n\n  const [isModal, setModal] = useState(false);\n  const onClose = () => setModal(false);\n\n  useBackgroungImg(inputFile, props.setBackgroundImg, props.inputBackgroundImg, setModal);\n\n  const bg: ViewModelBgImg = props.viewModelBgImg ?? {\n    width: 0,\n    height: 0,\n    src: \"\",\n  }\n\n  const onAcceptStretch = () => {\n    props.setCanvasSize(bg.width, bg.height);\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    onClose();\n  }\n  const onAcceptCrop = () => {\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    onClose();\n  }\n\n  const content: JSX.Element = <p>Исходное изображение больше размера холста</p>;\n\n  const footer: JSX.Element =\n    <>\n      <button onClick={onAcceptStretch}>Растянуть холст</button>\n      <button onClick={onAcceptCrop}>Обрезать изображение</button>\n      <button onClick={onClose}>Отмена</button>\n    </>\n\n  return (\n    <>\n      <Modal\n        visible={isModal}\n        title=\"Выберите действие\"\n        content={content}\n        footer={footer}\n        onClose={onClose}\n      />\n      <button className={styles.button}>\n        <label htmlFor=\"input-file-bg-img\" className={styles.icon}>\n          <FontAwesomeIcon icon={props.icon} />\n        </label>\n        <input\n          className={styles.inputFile}\n          type=\"file\"\n          accept=\".png,.jpg,.jfif,.jpe,.jpeg\"\n          id=\"input-file-bg-img\"\n          ref={inputFile}\n        />\n        <label className={styles.buttonText}\n          htmlFor=\"input-file-bg-img\">\n          {props.label}\n        </label>\n      </button>\n    </>\n  );\n};\n\nconst mapStateToProps = (state: RootState) => ({\n  viewModelBgImg: state.viewModel.bgImg,\n})\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    inputBackgroundImg: (src: string, width: number, height: number) => dispatch(inputBackgroundImg(src, width, height,)),\n    setBackgroundImg: (src: string, width: number, height: number) => dispatch(setBackgroundImg(src, width, height)),\n    setCanvasSize: (width: number, height: number) => dispatch(setCanvasSize(width, height)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddImgButton);","import { RefObject, useEffect } from \"react\";\r\nimport { getImgInformationFromFile } from \"../../../utils/files\";\r\nimport { verify } from \"../../../utils/permisions\";\r\nimport { store } from \"../../../store/store\";\r\nimport { Size } from \"../../../store/types\";\r\n\r\nexport function useBackgroungImg(\r\n  inputFile: RefObject<HTMLInputElement>,\r\n  setBackgroundImg: (src: string, width: number, height: number) => void,\r\n  inputBackgroundImg: (src: string, width: number, height: number) => void,\r\n  setModal: (state: boolean) => void\r\n) {\r\n\r\n  useEffect(() => {\r\n\r\n    const canvasSize: Size = {\r\n      width: store.getState().canvas.width,\r\n      height: store.getState().canvas.height,\r\n    };\r\n\r\n    const input: HTMLInputElement | null = inputFile.current;\r\n    async function handlerChange(): Promise<void> {\r\n\r\n      if (input) {\r\n        const files: FileList | null = input.files;\r\n        try {\r\n          if (files) {\r\n            const img: HTMLImageElement = await getImgInformationFromFile(files[0]);\r\n            if ((canvasSize.width < img.width) || (canvasSize.height < img.height)) {\r\n              inputBackgroundImg(img.src, img.width, img.height)\r\n              setModal(true);\r\n            } else {\r\n              setBackgroundImg(img.src, img.width, img.height);\r\n            }\r\n          }\r\n        } catch {\r\n          alert(\"Ошибка при импорте изображения. Проверьте исходный файл и повторите попытку\");\r\n        }\r\n        input.value = \"\";\r\n      }\r\n\r\n    }\r\n\r\n\r\n    verify(input).addEventListener(\"change\", handlerChange);\r\n    return () => {\r\n      if (input) input.removeEventListener(\"change\", handlerChange);\r\n    };\r\n  }, [inputFile, setBackgroundImg, inputBackgroundImg, setModal]);\r\n}","import { RefObject, useEffect } from \"react\";\nimport { inputBackgroundImg, setBackgroundImg } from \"../../../../store/actionCreators/canvasActionCreators\";\nimport { store } from \"../../../../store/store\";\n\nexport function useAddBackgroundByUrl(\n  image: RefObject<HTMLImageElement>,\n  url: string,\n  setModal: (value: boolean) => void,\n) {\n\n  useEffect(() => {\n\n    const photo: HTMLImageElement | null = image.current;\n\n    async function handlerClick() {\n\n      try {\n        const img: HTMLImageElement = new Image();\n        img.src = url;\n        await img.decode();\n        if ((store.getState().canvas.width < img.width) || (store.getState().canvas.height < img.height)) {\n          store.dispatch(inputBackgroundImg(img.src, img.width, img.height));\n          setModal(true)\n        } else {\n          store.dispatch(setBackgroundImg(img.src, img.width, img.height));\n        }\n      } catch {\n        alert(\"Ошибка при импорте изображения.\");\n      }\n    }\n\n    if (photo) photo.addEventListener(\"click\", handlerClick);\n    return () => {\n      if (photo) photo.removeEventListener(\"click\", handlerClick)\n    }\n  }, [image, setModal, url]);\n}","import styles from \"./AddBackgroundByUrlButton.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport ModalSearchImg from \"../../modalSearchImg/ModalSearchImg\";\nimport { useAddBackgroundByUrl } from \"./useAddBackgroundByUrl\";\nimport Modal from \"../../../modal/Modal\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport { inputBackgroundImg, setBackgroundImg, setCanvasSize } from \"../../../../store/actionCreators/canvasActionCreators\";\nimport { ViewModelBgImg } from \"../../../../store/types\";\n\ntype ButtonProps = {\n  label: string,\n  icon: IconDefinition,\n  inputBackgroundImg: (src: string, width: number, height: number) => void,\n  setBackgroundImg: (src: string, width: number, height: number) => void,\n  setCanvasSize: (width: number, height: number) => void,\n  viewModelBgImg: ViewModelBgImg | null,\n}\n\nconst Button = forwardRef((props: ButtonProps, ref: ForwardedRef<HTMLButtonElement>) => {\n  const [isModalSearchImg, setModalSearchImg] = useState(false);\n  const onCloseModalSearchImg = () => setModalSearchImg(false);\n\n  const [isModal, setModal] = useState(false);\n  const onClose = () => setModal(false);\n\n  const bg: ViewModelBgImg = props.viewModelBgImg ?? {\n    width: 0,\n    height: 0,\n    src: \"\",\n  }\n\n  const onAcceptStretch = () => {\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    props.setCanvasSize(bg.width, bg.height);\n    onClose();\n    onCloseModalSearchImg();\n  }\n  const onAcceptCrop = () => {\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    onClose();\n    onCloseModalSearchImg();\n  }\n\n  const content: JSX.Element = <p>Исходное изображение больше размера холста</p>;\n\n  const footer: JSX.Element =\n    <>\n      <button onClick={onAcceptStretch}>Растянуть холст</button>\n      <button onClick={onAcceptCrop}>Обрезать изображение</button>\n      <button onClick={onClose}>Отмена</button>\n    </>\n\n  return (\n    <>\n      <button\n        onClick={() => setModalSearchImg(true)}\n        className={styles.button}\n        ref={ref}\n      >\n        <FontAwesomeIcon icon={props.icon} />\n        <span className={styles.button_text}>{props.label}</span>\n      </button>\n\n      <ModalSearchImg\n        visible={isModalSearchImg}\n        onClose={onCloseModalSearchImg}\n        setModal={setModal}\n        useImg={useAddBackgroundByUrl}\n      />\n\n      <Modal\n        visible={isModal}\n        title=\"Выберите действие\"\n        content={content}\n        footer={footer}\n        onClose={onClose}\n      />\n    </>\n  );\n});\n\nconst mapStateToProps = (state: RootState) => ({\n  viewModelBgImg: state.viewModel.bgImg,\n})\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    inputBackgroundImg: (src: string, width: number, height: number) => dispatch(inputBackgroundImg(src, width, height,)),\n    setBackgroundImg: (src: string, width: number, height: number) => dispatch(setBackgroundImg(src, width, height)),\n    setCanvasSize: (width: number, height: number) => dispatch(setCanvasSize(width, height)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, { forwardRef: true })(Button);","import styles from \"./ToolbarBackground.module.css\";\r\nimport { faDownload, faGlobe, faRetweet } from \"@fortawesome/free-solid-svg-icons\"\r\nimport ColorPicker from \"../colorPicker/ColorPicker\";\r\nimport FileImgButton from \"./fileImgButton/FileImgButton\";\r\nimport { useRef } from \"react\";\r\nimport { useBackgroungColor } from \"./useBackgroungColor\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport {\r\n  inputBackgroundColor,\r\n  resetBackground,\r\n  setBackgroundColor\r\n} from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { connect } from \"react-redux\";\r\nimport { Background } from \"../../../store/types\";\r\nimport AddBackgroundByUrlButton from \"./addBackgroundByUrlButton/AddBackgroundByUrlButton\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\ntype ToolbarBackgroundProps = {\r\n  resetBackground: () => void,\r\n  inputBackgroundColor: (color: string) => void,\r\n  setBackgroundColor: (color: string) => void,\r\n  background: Background,\r\n}\r\n\r\nfunction ToolbarBackground(props: ToolbarBackgroundProps) {\r\n\r\n  const inputColor = useRef<HTMLInputElement>(null);\r\n  const buttonReset = useRef<HTMLButtonElement>(null);\r\n\r\n  useBackgroungColor(\r\n    props.resetBackground,\r\n    props.inputBackgroundColor,\r\n    props.setBackgroundColor,\r\n    props.background,\r\n    inputColor,\r\n    buttonReset\r\n  );\r\n\r\n  return (\r\n    <div className={styles.toolbar}>\r\n      <FileImgButton\r\n        label=\"C компьютера\"\r\n        icon={faDownload}\r\n      />\r\n      <AddBackgroundByUrlButton\r\n        label=\"Из Pixels\"\r\n        icon={faGlobe}\r\n      />\r\n\r\n      <div className={styles.row}>\r\n        <label className={styles.label}>Цвет фона:</label>\r\n        <ColorPicker ref={inputColor} />\r\n        <button ref={buttonReset} className={styles.reset}>\r\n          <FontAwesomeIcon icon={faRetweet} />\r\n        </button>\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  background: state.canvas.background,\r\n})\r\n\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    resetBackground: () => dispatch(resetBackground()),\r\n    inputBackgroundColor: (color: string) => dispatch(inputBackgroundColor(color)),\r\n    setBackgroundColor: (color: string) => dispatch(setBackgroundColor(color)),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarBackground);\r\n","import { useEffect, RefObject } from \"react\";\r\nimport { Background } from \"../../../store/types\";\r\nimport { verify } from \"../../../utils/permisions\";\r\n\r\nexport function useBackgroungColor(\r\n  resetBackground: () => void,\r\n  inputBackgroundColor: (color: string) => void,\r\n  setBackgroundColor: (color: string) => void,\r\n  background: Background,\r\n  inputColor: RefObject<HTMLInputElement>,\r\n  buttonReset: RefObject<HTMLButtonElement>): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const input: HTMLInputElement | null = inputColor.current;\r\n    const button: HTMLButtonElement | null = buttonReset.current;\r\n\r\n    function handlerClickResetColor(): void {\r\n      resetBackground();\r\n    }\r\n  \r\n    function handlerInputColor(event: Event): void {\r\n      const inputColor = event.target as HTMLInputElement;\r\n      inputBackgroundColor(inputColor.value);\r\n    }\r\n  \r\n    function handleerChangeColor(event: Event): void {\r\n      const inputColor = event.target as HTMLInputElement;\r\n      const color: string = inputColor.value;\r\n      setBackgroundColor(color);\r\n    }\r\n\r\n\r\n    verify(input).addEventListener(\"input\", handlerInputColor);\r\n    verify(input).addEventListener(\"change\", handleerChangeColor);\r\n    verify(button).addEventListener(\"click\", handlerClickResetColor);\r\n    return () => {\r\n      if (input) {\r\n        input.removeEventListener(\"input\", handlerInputColor);\r\n        input.removeEventListener(\"change\", handleerChangeColor);\r\n      }\r\n      if (button) button.removeEventListener(\"click\", handlerClickResetColor);\r\n\r\n    };\r\n  }, [resetBackground, inputBackgroundColor, setBackgroundColor, background, inputColor, buttonReset]);\r\n\r\n  // изменение цвета input на белый при сбросе фона\r\n  useEffect(() => {\r\n    const input: HTMLInputElement | null = inputColor.current;\r\n    verify(input).value = background.color ? background.color : \"#ffffff\";\r\n  }, [inputColor, background]);\r\n\r\n\r\n}","import styles from \"./Button.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\n\ntype ButtonProps = {\n  label: string,\n  icon: IconDefinition,\n}\n\nconst Button = forwardRef((props: ButtonProps, ref: ForwardedRef<HTMLButtonElement>) => (\n  <button\n    className={styles.button}\n    ref={ref}\n  >\n    <FontAwesomeIcon icon={props.icon} />\n    <span className={styles.buttonText}>{props.label}</span>\n  </button>\n));\n\nexport default connect(null, null, null, { forwardRef: true })(Button);","import styles from \"./ToolbarObject.module.css\";\nimport { faArrowUp, faArrowDown, faTrash } from \"@fortawesome/free-solid-svg-icons\"\nimport Button from \"../button/Button\";\nimport { useBlockLevel } from \"./useBlockLevel\";\nimport { useBlockDelete } from \"./useBlockDelete\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../store/store\";\nimport { deleteBlock, shiftDownBlock, shiftUpBlock } from \"../../../store/actionCreators/blockActionCreators\";\n\ntype ToolbarObjectProps = {\n  shiftUpBlock: () => void,\n  shiftDownBlock: () => void,\n  deleteBlock: () => void,\n}\n\nfunction ToolbarObject(props: ToolbarObjectProps) {\n  const buttonUp = useRef<HTMLButtonElement>(null);\n  const buttonDown = useRef<HTMLButtonElement>(null);\n  const buttonDelete = useRef<HTMLButtonElement>(null);\n  useBlockLevel(buttonUp, buttonDown, props.shiftUpBlock, props.shiftDownBlock);\n  useBlockDelete(buttonDelete, props.deleteBlock);\n  return (\n    <div className={styles.toolbar}>\n      <Button\n        ref={buttonUp}\n        label=\"На слой вверх\"\n        icon={faArrowUp}\n      />\n      <Button\n        ref={buttonDown}\n        label=\"На слой вниз\"\n        icon={faArrowDown}\n      />\n      <Button\n        ref={buttonDelete}\n        label=\"Удалить\"\n        icon={faTrash}\n      />\n    </div>\n  );\n}\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    shiftUpBlock: () => dispatch(shiftUpBlock()),\n    shiftDownBlock: () => dispatch(shiftDownBlock()),\n    deleteBlock: () => dispatch(deleteBlock()),\n  }\n}\n\nexport default connect(null, mapDispatchToProps)(ToolbarObject);\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useBlockLevel(\n  buttonUp: RefObject<HTMLButtonElement>,\n  buttonDown: RefObject<HTMLButtonElement>,\n  shiftUpBlock: () => void,\n  shiftDownBlock: () => void): void {\n\n  useEffect(() => {\n\n    const btnUp: HTMLButtonElement | null = buttonUp.current;\n    const btnDown: HTMLButtonElement | null = buttonDown.current;\n\n    function handlerClickShiftUp(event: Event): void {\n      event.preventDefault();\n      shiftUpBlock();\n    }\n  \n    function handlerClickShiftDown(event: Event): void {\n      event.preventDefault();\n      shiftDownBlock();\n    }\n\n\n    verify(btnUp).addEventListener(\"click\", handlerClickShiftUp);\n    verify(btnDown).addEventListener(\"click\", handlerClickShiftDown);\n    return () => {\n      if (btnUp) btnUp.removeEventListener(\"click\", handlerClickShiftUp);\n      if (btnDown) btnDown.removeEventListener(\"click\", handlerClickShiftDown);\n    };\n  }, [buttonUp, buttonDown, shiftUpBlock, shiftDownBlock]);\n}\n\n\n","import { RefObject, useEffect } from \"react\";\r\nimport { verify } from \"../../../utils/permisions\";\r\n\r\nexport function useBlockDelete(buttonDelete: RefObject<HTMLButtonElement>, deleteBlock: () => void): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const button: HTMLButtonElement | null = buttonDelete.current;\r\n\r\n    function handlerClickDelete(): void {\r\n      deleteBlock();\r\n    }\r\n\r\n    function handlerKeydown(event: KeyboardEvent): void {\r\n      if (event.code === \"Delete\") {\r\n        if (!event.defaultPrevented) {\r\n          deleteBlock();\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    \r\n    verify(button).addEventListener(\"click\", handlerClickDelete);\r\n    document.addEventListener(\"keydown\", handlerKeydown);\r\n    return () => {\r\n      if (button) button.removeEventListener(\"click\", handlerClickDelete);\r\n      document.removeEventListener(\"keydown\", handlerKeydown);\r\n    };\r\n  }, [buttonDelete, deleteBlock]);\r\n}\r\n\r\n\r\n","import styles from \"./ToolbarCanvas.module.css\";\r\nimport { useRef } from \"react\";\r\nimport { useStateCanvasSize } from \"./useStateCanvasSize\";\r\nimport { connect } from \"react-redux\";\r\nimport { inputCanvasSize, setCanvasSize } from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport { faEraser } from \"@fortawesome/free-solid-svg-icons\"\r\nimport Button from \"../button/Button\";\r\nimport { deleteAreaSelection, resetAreaSelection } from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { useDeleteArea } from \"./useDeleteArea\";\r\n\r\ntype ToolbarCanvasProps = {\r\n  inputCanvasSize: (width: number, height: number) => void,\r\n  setCanvasSize: (width: number, height: number) => void,\r\n  width: number,\r\n  height: number,\r\n  deleteAreaSelection: () => void,\r\n  resetAreaSelection: () => void,\r\n}\r\n\r\nfunction ToolbarCanvas(props: ToolbarCanvasProps) {\r\n\r\n  const inputWidth = useRef<HTMLInputElement>(null);\r\n  const inputHeight = useRef<HTMLInputElement>(null);\r\n  useStateCanvasSize(\r\n    inputWidth,\r\n    inputHeight,\r\n    props.inputCanvasSize,\r\n    props.setCanvasSize,\r\n    props.width,\r\n    props.height,\r\n  );\r\n\r\n  const buttonDelete = useRef<HTMLButtonElement>(null);\r\n\r\n  useDeleteArea(buttonDelete, props.deleteAreaSelection, props.resetAreaSelection);\r\n\r\n  return (\r\n    <div className={styles.toolbar}>\r\n\r\n      <div className={styles.row}>\r\n        <label className={styles.label}>Ширина:</label>\r\n        <input type=\"number\" className={styles.inputNumber} min=\"0\" ref={inputWidth} />\r\n        <span className={styles.unitsLabel}>px</span>\r\n      </div>\r\n\r\n      <div className={styles.row}>\r\n        <label className={styles.label}>Высота:</label>\r\n        <input type=\"number\" className={styles.inputNumber} min=\"0\" ref={inputHeight} />\r\n        <span className={styles.unitsLabel}>px</span>\r\n      </div>\r\n\r\n      <Button\r\n        ref={buttonDelete}\r\n        label=\"Удалить область\"\r\n        icon={faEraser}\r\n      />\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  width: state.canvas.width,\r\n  height: state.canvas.height,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    inputCanvasSize: (width: number, height: number) => dispatch(inputCanvasSize(width, height)),\r\n    setCanvasSize: (width: number, height: number) => dispatch(setCanvasSize(width, height)),\r\n    deleteAreaSelection: () => dispatch(deleteAreaSelection()),\r\n    resetAreaSelection: () => dispatch(resetAreaSelection()),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarCanvas);\r\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useStateCanvasSize(\n  inputWidth: RefObject<HTMLInputElement>,\n  inputHeight: RefObject<HTMLInputElement>,\n  inputCanvasSize: (width: number, height: number) => void,\n  setCanvasSize: (width: number, height: number) => void,\n  width: number,\n  height: number\n): void {\n\n  useEffect(() => {\n    const fieldWidth: HTMLInputElement | null = inputWidth.current;\n    const fieldHeight: HTMLInputElement | null = inputHeight.current;\n\n    verify(fieldWidth).value = String(width);\n    verify(fieldHeight).value = String(height);\n\n    function handleChangeSize(): void {\n      if (fieldWidth && fieldHeight) {\n        const width: number = Number(fieldWidth.value);\n        const height: number = Number(fieldHeight.value);\n        inputCanvasSize(width, height);\n      }\n    }\n\n    function handleBlurSize(): void {\n      if (fieldWidth && fieldHeight) {\n        const width: number = Number(fieldWidth.value);\n        const height: number = Number(fieldHeight.value);\n        setCanvasSize(width, height);\n      }\n    }\n\n\n    verify(fieldWidth).addEventListener(\"change\", handleChangeSize);\n    verify(fieldWidth).addEventListener(\"blur\", handleBlurSize);\n    verify(fieldHeight).addEventListener(\"change\", handleChangeSize);\n    verify(fieldHeight).addEventListener(\"blur\", handleBlurSize);\n    return () => {\n      if (fieldWidth) {\n        fieldWidth.removeEventListener(\"change\", handleChangeSize);\n        fieldWidth.removeEventListener(\"blur\", handleBlurSize);\n      }\n      if (fieldHeight) {\n        fieldHeight.removeEventListener(\"change\", handleChangeSize);\n        fieldHeight.removeEventListener(\"blur\", handleBlurSize);\n      }\n    };\n  }, [inputWidth, inputHeight, inputCanvasSize, setCanvasSize, width, height]);\n}","import { RefObject, useEffect } from \"react\"\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useDeleteArea(\n  buttonDelete: RefObject<HTMLButtonElement>,\n  deleteAreaSelection: () => void,\n  resetAreaSelection: () => void) {\n\n    useEffect(() => {\n\n      const button: HTMLButtonElement | null = buttonDelete.current;\n\n      function handleClickButton() {\n        deleteAreaSelection();\n        resetAreaSelection();\n      }\n      function handleMousedownButton(event: MouseEvent) {\n        event.preventDefault();\n      }\n  \n  \n      verify(button).addEventListener(\"click\", handleClickButton);\n      verify(button).addEventListener(\"mousedown\", handleMousedownButton);\n      return () => {\n        if (button) button.removeEventListener(\"click\", handleClickButton);\n        if (button) button.removeEventListener(\"mousedown\", handleMousedownButton);\n      };\n    }, [buttonDelete, deleteAreaSelection, resetAreaSelection]);\n  }","import styles from \"./NavButton.module.css\";\r\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { ForwardedRef, forwardRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\ntype NavButtonProps = {\r\n  label: string,\r\n  icon: IconDefinition,\r\n  onClick: null | (() => void),\r\n}\r\n\r\nconst NavButton = forwardRef((props: NavButtonProps, ref: ForwardedRef<HTMLButtonElement>) => {\r\n  return (\r\n    <button\r\n      onClick={props.onClick ? props.onClick : ()=>{}}\r\n      className={styles.button}\r\n      ref={ref}>\r\n      <FontAwesomeIcon icon={props.icon} />\r\n      {props.label !== \"\" &&\r\n        <span className={styles.button__text}>{props.label}</span>\r\n      }\r\n    </button>\r\n  )\r\n});\r\n\r\nexport default connect(null, null, null, { forwardRef: true })(NavButton);","import styles from \"./NavFileButton.module.css\";\r\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { ForwardedRef, forwardRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\ntype NavFileButtonProps = {\r\n  label: string,\r\n  icon: IconDefinition,\r\n}\r\n\r\nconst NavFileButton = forwardRef((props: NavFileButtonProps, ref: ForwardedRef<HTMLInputElement>) => (\r\n  <button className={styles.button}>\r\n    <label htmlFor=\"input-file\" className={styles.icon}>\r\n      <FontAwesomeIcon icon={props.icon} />\r\n    </label>\r\n    <input\r\n      className={styles.inputFile}\r\n      type=\"file\"\r\n      accept=\".json\"\r\n      ref={ref}\r\n      id=\"input-file\"\r\n    />\r\n    {props.label !== \"\" &&\r\n      <label className={styles.button__text}\r\n        htmlFor=\"input-file\">\r\n        {props.label}\r\n      </label>\r\n    }\r\n  </button>\r\n));\r\n\r\nexport default connect(null, null, null, { forwardRef: true })(NavFileButton);","import { CardMaker } from \"../types\";\n\nexport function newCardMaker() {\n  return {\n    type: \"NEW_CARD_MAKER\",\n  }\n}\n\nexport function applyFileProject(cardMaker: CardMaker) {\n  return {\n    type: \"APPLY_FILE_PROJECT\",\n    project: cardMaker,\n  }\n}\n","import { faPiedPiperSquare } from \"@fortawesome/free-brands-svg-icons\"\r\nimport { connect } from \"react-redux\";\r\nimport { useState } from \"react\";\r\nimport { AppDispatch } from \"../../../../../../store/store\";\r\nimport { newCardMaker } from \"../../../../../../store/actionCreators/cardMakerActionCreators\";\r\nimport NavButton from \"../NavButton/NavButton\";\r\nimport Modal from \"../../../../../modal/Modal\";\r\n\r\ntype NewProjectButtonProps = {\r\n  newCardMaker: () => void,\r\n}\r\n\r\nfunction NewProjectButton(props: NewProjectButtonProps) {\r\n  const [isModal, setModal] = useState(false)\r\n  const onClose = () => setModal(false)\r\n  const onAccept = () => {\r\n    props.newCardMaker();\r\n    onClose()\r\n  }\r\n\r\n  const content: JSX.Element =\r\n    <>\r\n      <p>Несохраненные изменения будут потеряны</p>\r\n      <p>Вы хотите продолжить ?</p>\r\n    </>\r\n\r\n  const footer: JSX.Element =\r\n    <>\r\n      <button onClick={onAccept}>Да</button>\r\n      <button onClick={onClose}>Нет</button>\r\n    </>\r\n\r\n\r\n  return (\r\n    <>\r\n      <NavButton label=\"Новый проект\" icon={faPiedPiperSquare} onClick={() => setModal(true)} />\r\n      <Modal\r\n        visible={isModal}\r\n        title=\"Новая открытка\"\r\n        content={content}\r\n        footer={footer}\r\n        onClose={onClose}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    newCardMaker: () => dispatch(newCardMaker()),\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(NewProjectButton);","import { RGB } from \"../store/types\";\n\n// конвертирование hex в rgb\nexport function convertColor(color: string): RGB {\n  if (color.substring(0, 1) === \"#\") {\n    color = color.substring(1);\n  }\n  const rgbColor: RGB = {\n    r: 255,\n    g: 255,\n    b: 255,\n  };\n  rgbColor.r = parseInt(color.substring(0, 2), 16);\n  rgbColor.g = parseInt(color.substring(2, 4), 16);\n  rgbColor.b = parseInt(color.substring(4), 16);\n  return rgbColor;\n}","\nimport { store } from \"../store/store\";\nimport { Block, BlockTypes, Background, Filter, Size, Text, Img, ArtObj, Canvas, RGB, Area } from \"../store/types\";\nimport { convertColor } from \"./color\";\nimport { calcSizeImgByCanvas } from \"./size\";\n\nexport async function exportInImage(type: string): Promise<void> {\n\n  const canvas: Canvas = store.getState().canvas;\n\n  const canvasWidth: number = canvas.width;\n  const canvasHeight: number = canvas.height;\n  const background: Background = canvas.background;\n  const filter: Filter = canvas.filter;\n  const elements: Block[] = canvas.listBlock;\n  const deleteAreas: Area[] = canvas.deleteArea;\n\n  const canvasElement: HTMLCanvasElement = document.createElement(\"canvas\");\n  canvasElement.width = canvasWidth;\n  canvasElement.height = canvasHeight;\n  const ctx: CanvasRenderingContext2D | null = canvasElement.getContext(\"2d\");\n\n  if (ctx) {\n    // отрисовка фона\n    if (background.src) {\n      const img: HTMLImageElement = new Image();\n      img.crossOrigin = \"anonymous\"\n      img.src = background.src;\n      await img.decode();\n      let size: Size = calcSizeImgByCanvas(img.width, img.height, canvasWidth, canvasHeight);\n      ctx.drawImage(img, 0, 0, size.width, size.height);\n    } else if (background.color) {\n      ctx.fillStyle = background.color;\n      ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n    }\n\n    // отрисовка блоков\n    for (let element of elements) {\n      await renderBlock(element, ctx);\n    }\n\n    // отрисовка фильтра\n    const color: RGB = convertColor(filter.color);\n    ctx.fillStyle = `rgba(${color.r}, ${color.g}, ${color.b}, ${filter.opacity})`;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    // отрисовка удаленных областей\n    ctx.fillStyle = \"#ffffff\";\n    deleteAreas.forEach(element => {\n      ctx.fillRect(element.x, element.y, element.width, element.height);\n    });\n\n    const dataURL: string = canvasElement.toDataURL(type);\n    const link: HTMLAnchorElement = document.createElement(\"a\");\n    link.href = dataURL;\n    link.download = \"new_card\";\n    link.click();\n  }\n}\n\nasync function renderBlock(element: Block, ctx: CanvasRenderingContext2D) {\n  switch (element.type) {\n    case BlockTypes.text: renderText(element, ctx);\n      break;\n    case BlockTypes.img:\n      await renderImg(element, ctx);\n      break;\n    case BlockTypes.artObj:\n      await renderArtObj(element, ctx);\n      break;\n  }\n}\n\n// формирование стилей для текстового блока\nfunction getStyle(text: Text) {\n  return {\n    x: text.x,\n    y: text.y,\n    color: text.color,\n    size: text.size,\n    weight: text.bold ? \"700\" : \"\",\n    italic: text.italic ? \"italic\" : \"\",\n    family: text.fontFamily,\n  };\n}\n\n\nfunction renderText(element: Text, ctx: CanvasRenderingContext2D) {\n      // внутрений отступ \n      const paddingText: number = 5;\n      // высота строки\n      const lineHeight: number = 1.2;\n      const style = getStyle(element);\n      const textBlock: HTMLDivElement = document.createElement(\"div\");\n      textBlock.innerHTML = element.text;\n      // сдивг строки\n      let shift = 0;\n      // отрисовка строк\n      for (let str of Array.from(textBlock.children) as HTMLDivElement[]) {\n\n        ctx.fillStyle = style.color;\n        ctx.font = `${style.italic} ${style.weight} ${style.size}px ${style.family}`;\n        ctx.fillText(str.innerText, element.x + paddingText, element.y + shift + style.size);\n        // подчеркивание\n        if (element.underline) {\n          const textWidth: number = ctx.measureText(str.innerText).width;\n          let chars = 0;\n          let underline = \"\";\n          while (str.innerText.length > chars) {\n            underline += \"__\";\n            chars++;\n          }\n          ctx.font = `700 ${style.size}px openSans`;\n          ctx.fillText(underline, element.x + paddingText, element.y + shift + style.size, textWidth);\n        }\n        shift += element.size * lineHeight;\n      }\n}\n\nasync function renderImg(element: Img, ctx: CanvasRenderingContext2D) {\n  const img: HTMLImageElement = new Image();\n  img.crossOrigin = \"anonymous\"\n  img.src = element.src;\n  await img.decode();\n  ctx.drawImage(img, element.x, element.y, element.width, element.height);\n}\n\nasync function renderArtObj(element: ArtObj, ctx: CanvasRenderingContext2D) {\n  const artObj: HTMLImageElement = new Image();\n  artObj.crossOrigin = \"anonymous\"\n  artObj.src = element.src;\n  await artObj.decode();\n  ctx.drawImage(artObj, element.x, element.y, element.width, element.height)\n}","import { faImage } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { connect } from \"react-redux\";\r\nimport { useRef, useState } from \"react\";\r\nimport NavButton from \"../NavButton/NavButton\";\r\nimport Modal from \"../../../../../modal/Modal\";\r\nimport { exportInImage } from \"../../../../../../utils/exportInImage\";\r\n\r\nfunction ExportImgButton() {\r\n\r\n  const downloadImg = useRef<HTMLButtonElement>(null);\r\n\r\n  const [isModal, setModal] = useState(false)\r\n  const onClose = () => setModal(false)\r\n\r\n  const onAcceptJpg = () => {\r\n    exportInImage(\"image/jpeg\");\r\n    onClose();\r\n  }\r\n\r\n  const onAcceptPng = () => {\r\n    exportInImage(\"image/png\");\r\n    onClose();\r\n  }\r\n\r\n  const content: JSX.Element = <p>Выберите формат сохраняемого файла</p>\r\n\r\n  const footer: JSX.Element =\r\n    <>\r\n      <button onClick={onAcceptJpg}>jpg</button>\r\n      <button onClick={onAcceptPng}>png</button>\r\n      <button onClick={onClose}>Отмена</button>\r\n    </>\r\n\r\n\r\n  return (\r\n    <>\r\n      <NavButton label=\"Сохранить как jpg/png\" icon={faImage} onClick={() => setModal(true)} ref={downloadImg} />\r\n      <Modal\r\n        visible={isModal}\r\n        title=\"Сохранить как...\"\r\n        content={content}\r\n        footer={footer}\r\n        onClose={onClose}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default connect()(ExportImgButton);","import styles from \"./PreviewTemplate.module.css\";\r\nimport { useRef, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { AppDispatch } from \"../../../../../store/store\";\r\nimport Modal from \"../../../../modal/Modal\";\r\nimport { CardMaker } from \"../../../../../store/types\";\r\nimport { applyFileProject } from \"../../../../../store/actionCreators/cardMakerActionCreators\";\r\n\r\ntype PreviewTemplateProps = {\r\n  name: string,\r\n  srcImg: string,\r\n  srcJson: string,\r\n  applyFileProject: (tepmlate: CardMaker) => void,\r\n}\r\n\r\nfunction PreviewTemplate(props: PreviewTemplateProps) {\r\n\r\n  const [isModal, setModal] = useState(false)\r\n  const onClose = () => setModal(false)\r\n  \r\n  const onAccept = async () => {\r\n    const response: Response = await fetch(props.srcJson);\r\n    props.applyFileProject(await response.json());\r\n    onClose()\r\n  }\r\n\r\n  const content: JSX.Element =\r\n    <>\r\n      <p>Несохраненные изменения будут потеряны</p>\r\n      <p>Вы хотите продолжить ?</p>\r\n    </>\r\n\r\n  const footer: JSX.Element =\r\n    <>\r\n      <button onClick={onAccept}>Да</button>\r\n      <button onClick={onClose}>Нет</button>\r\n    </>\r\n\r\n\r\n  const img = useRef<HTMLImageElement>(null);\r\n  return (\r\n    <>\r\n      <div className={styles.preview} onClick={() => setModal(true)}>\r\n        <img src={props.srcImg} alt=\"\" ref={img} className={styles.img} />\r\n        <p>{props.name}</p>\r\n      </div>\r\n      <Modal\r\n        visible={isModal}\r\n        title=\"Применение шаблона\"\r\n        content={content}\r\n        footer={footer}\r\n        onClose={onClose}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    applyFileProject: (template: CardMaker) => dispatch(applyFileProject(template)),\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(PreviewTemplate);","import styles from \"./Navbar.module.css\";\r\nimport { faClone, faUndo, faRedo, faFileExport, faFolderOpen } from \"@fortawesome/free-solid-svg-icons\"\r\nimport NavButton from \"./navButton/NavButton/NavButton\";\r\nimport NavFileButton from \"./navButton/NavFileButton/NavFileButton\";\r\nimport { ReactElement, useRef } from \"react\";\r\nimport { useImportFileProject } from \"./useImportFileProject\";\r\nimport { useStateHistory } from \"./useStateHistory\";\r\nimport { connect } from \"react-redux\";\r\nimport { undo, redo } from \"../../../../store/actionCreators/historyActionCreators\";\r\nimport { applyFileProject } from \"../../../../store/actionCreators/cardMakerActionCreators\";\r\nimport { CardMaker, templates } from \"../../../../store/types\";\r\nimport { AppDispatch } from \"../../../../store/store\";\r\nimport { useExportFileProject } from \"./useExportFileProject\";\r\nimport NewProjectButton from \"./navButton/NewProjectButton/NewProjectButton\";\r\nimport ExportImgButton from \"./navButton/ExportImgButton/ExportImgButton\";\r\nimport DropdownMenu from \"../../../dropdownMenu/DropdownMenu\";\r\nimport PreviewTemplate from \"./previewTemplate/PreviewTemplate\";\r\n\r\ntype NavbarProps = {\r\n  undo: () => void,\r\n  redo: () => void,\r\n  applyFileProject: (file: CardMaker) => void,\r\n}\r\n\r\nfunction Navbar(props: NavbarProps) {\r\n  const buttonUndo = useRef<HTMLButtonElement>(null);\r\n  const buttonRedo = useRef<HTMLButtonElement>(null);\r\n  useStateHistory(\r\n    buttonUndo,\r\n    buttonRedo,\r\n    props.undo,\r\n    props.redo,\r\n  );\r\n\r\n  const inputFile = useRef<HTMLInputElement>(null);\r\n  const downloadFile = useRef<HTMLButtonElement>(null);\r\n\r\n  useImportFileProject(inputFile, props.applyFileProject);\r\n  useExportFileProject(downloadFile);\r\n\r\n\r\n  // формирование списка стикеров\r\n  const srcList: {name: string, json: string, preview: string}[] = Object.values(templates);\r\n  const previewList: ReactElement[] = [];\r\n  srcList.forEach((tmp, index) => {\r\n    previewList.push(<PreviewTemplate name={tmp.name} srcImg={tmp.preview} srcJson={tmp.json} key={index} />);\r\n  });\r\n\r\n\r\n  return (\r\n    <>\r\n      <nav className={styles.navbar}>\r\n        <NewProjectButton />\r\n        <NavFileButton label=\"Открыть проект\" icon={faFolderOpen} ref={inputFile} />\r\n        <NavButton label=\"Сохранить проект\" icon={faFileExport} ref={downloadFile} onClick={null} />\r\n        <ExportImgButton />\r\n        <div>\r\n          <DropdownMenu minWidth={450} label=\"Шаблоны\" icon={faClone}>\r\n            {previewList}\r\n          </DropdownMenu>\r\n        </div>\r\n\r\n        <NavButton label=\"\" icon={faUndo} ref={buttonUndo} onClick={null} />\r\n        <NavButton label=\"\" icon={faRedo} ref={buttonRedo} onClick={null} />\r\n      </nav>\r\n    </>\r\n  );\r\n}\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    undo: () => dispatch(undo()),\r\n    redo: () => dispatch(redo()),\r\n    applyFileProject: (file: CardMaker) => dispatch(applyFileProject(file)),\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(Navbar);\r\n","import { RefObject, useEffect } from \"react\";\r\nimport { verify } from \"../../../../utils/permisions\";\r\n\r\nexport function useStateHistory(\r\n  buttonUndo: RefObject<HTMLButtonElement>,\r\n  buttonRedo: RefObject<HTMLButtonElement>,\r\n  undo: () => void,\r\n  redo: () => void,\r\n): void {\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    const btnUndo: HTMLButtonElement | null = buttonUndo.current;\r\n    const btnRedo: HTMLButtonElement | null = buttonRedo.current;\r\n\r\n    function handlerClickUndo(): void {\r\n      undo();\r\n    }\r\n  \r\n    function handlerClickRedo(): void {\r\n      redo();\r\n    }\r\n  \r\n    function handlerKeydown(event: KeyboardEvent): void {\r\n      if (event.code === \"KeyZ\" && (event.ctrlKey || event.metaKey)) {\r\n        event.preventDefault();\r\n        undo();\r\n      }\r\n      if (event.code === \"KeyY\" && (event.ctrlKey || event.metaKey)) {\r\n        event.preventDefault();\r\n        redo();\r\n      }\r\n    }\r\n    \r\n    \r\n    verify(btnUndo).addEventListener(\"click\", handlerClickUndo);\r\n    verify(btnRedo).addEventListener(\"click\", handlerClickRedo);\r\n    document.addEventListener(\"keydown\", handlerKeydown);\r\n    return () => {\r\n      if (btnUndo) btnUndo.removeEventListener(\"click\", handlerClickUndo);\r\n      if (btnRedo) btnRedo.removeEventListener(\"click\", handlerClickRedo);\r\n      document.removeEventListener(\"keydown\", handlerKeydown);\r\n    };\r\n  }, [buttonUndo, buttonRedo, undo, redo]);\r\n}","import { RefObject, useEffect } from \"react\";\r\nimport { store } from \"../../../../store/store\";\r\nimport { CardMaker } from \"../../../../store/types\";\r\nimport { verify } from \"../../../../utils/permisions\";\r\n\r\nexport function useExportFileProject(downloadButton: RefObject<HTMLButtonElement>): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const button: HTMLButtonElement | null = downloadButton.current;\r\n\r\n    function handlerClickSaveToJson(): void {\r\n      const cardMaker: CardMaker = store.getState();\r\n      const json: string = JSON.stringify({\r\n        ...cardMaker,\r\n        selectBlock: null,\r\n        history: {\r\n          listState: [cardMaker.canvas],\r\n          currentIndex: 0,\r\n        }\r\n      });\r\n      const file: Blob = new Blob([json], { type: \"application/json\" });\r\n      const link: HTMLAnchorElement = document.createElement(\"a\");\r\n      link.href = URL.createObjectURL(file);\r\n      link.download = \"Новый проект.json\";\r\n      link.click();\r\n    }\r\n\r\n    \r\n    verify(button).addEventListener(\"click\", handlerClickSaveToJson);\r\n    return () => {\r\n      if (button) button.removeEventListener(\"click\", handlerClickSaveToJson);\r\n    };\r\n  }, [downloadButton]);\r\n}","import { getProjectFromFile } from \"../../../../utils/files\";\r\nimport { RefObject, useEffect } from \"react\";\r\nimport { CardMaker } from \"../../../../store/types\";\r\nimport { verify } from \"../../../../utils/permisions\";\r\n\r\nexport function useImportFileProject(\r\n  inputFile: RefObject<HTMLInputElement>,\r\n  applyFileProject: (file: CardMaker) => void): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const input: HTMLInputElement | null = inputFile.current;\r\n\r\n    async function handlerChangeInputFile(): Promise<void> {\r\n\r\n      if (input) {\r\n        const files: FileList | null = input.files;\r\n        try {\r\n          if (files) {\r\n            applyFileProject(await getProjectFromFile(files[0]))\r\n          }\r\n        } catch {\r\n          alert(\"Ошибка при импорте проекта. Проверьте исходный фаил и повторите попытку\")\r\n        }\r\n        input.value = \"\";\r\n      }\r\n      \r\n    }\r\n\r\n\r\n    verify(input).addEventListener(\"change\", handlerChangeInputFile);\r\n    return () => {\r\n      if (input) input.removeEventListener(\"change\", handlerChangeInputFile);\r\n    };\r\n  }, [inputFile, applyFileProject]);\r\n}","import { connect } from \"react-redux\";\nimport styles from \"./TopToolbar.module.css\";\nimport Navbar from \"./navbar/Navbar\";\n\nfunction Header() {\n  return (\n    <header className={styles.header}>\n      <div className={styles.mainLabel}>Card Maker</div>\n      <Navbar />\n    </header >\n  );\n}\n\nexport default connect()(Header);\n","import styles from \"./Toolbar.module.css\";\nimport ToolbarText from \"./toolbarText/ToolbarText\";\nimport ToolbarImg from \"./toolbarImg/ToolbarImg\";\nimport ToolbarFilter from \"./toolbarFilter/ToolbarFilter\";\nimport ToolbarBackground from \"./toolbarBackground/ToolbarBackground\";\nimport ToolbarObject from \"./toolbarObject/ToolbarObject\";\nimport ToolbarCanvas from \"./toolbarCanvas/ToolbarCanvas\";\nimport { connect } from \"react-redux\";\nimport TopToolbar from \"./topToolbar/TopToolbar\";\n\nfunction Toolbar() {\n  return (\n    <div className={styles.toolbar}>\n      <TopToolbar />\n      <label>Текст</label>\n      <ToolbarText />\n      <label>Изображения</label>\n      <ToolbarImg />\n      <label>Фон</label>\n      <ToolbarBackground />\n      <label>Фильтр</label>\n      <ToolbarFilter />\n      <label>Объекты</label>\n      <ToolbarObject />\n      <label>Холст</label>\n      <ToolbarCanvas />\n    </div>\n  );\n}\n\nexport default connect()(Toolbar);\n","import styles from \"./CardMaker.module.css\";\r\nimport Canvas from \"./canvas/Canvas\";\r\nimport { connect } from \"react-redux\";\r\nimport Toolbar from \"./toolbar/Toolbar\";\r\n\r\nfunction CardMaker() {\r\n  return (\r\n    <>\r\n      <main className={styles.main}>\r\n        <Canvas />\r\n      </main>\r\n      <Toolbar />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default connect()(CardMaker);\r\n","import \"./index.css\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport CardMaker from \"./cardMaker/CardMaker\";\r\nimport { store } from \"./store/store\";\r\nimport { Provider } from \"react-redux\";\r\n\r\nwindow.addEventListener(\"beforeunload\", (event: BeforeUnloadEvent) => event.returnValue = false);\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <CardMaker />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}