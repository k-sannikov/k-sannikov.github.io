{"version":3,"sources":["cardMaker/toolbar/toolbarText/selectFontFamily/SelectFontFamily.module.css","cardMaker/toolbar/modalSearchImg/ModalSearchImg.module.css","cardMaker/toolbar/toolbarCanvas/ToolbarCanvas.module.css","cardMaker/modal/Modal.module.css","cardMaker/canvas/img/Img.module.css","cardMaker/canvas/artObj/ArtObj.module.css","cardMaker/header/navbar/navButton/NavFileButton/NavFileButton.module.css","cardMaker/dropdownMenu/DropdownMenu.module.css","cardMaker/toolbar/toolbarText/ToolbarText.module.css","cardMaker/toolbar/toolbarImg/addImgButtonFile/AddImgButtonFile.module.css","cardMaker/toolbar/toolbarFilter/ToolbarFilter.module.css","cardMaker/toolbar/toolbarBackground/ToolbarBackground.module.css","cardMaker/toolbar/toolbarBackground/fileImgButton/FileImgButton.module.css","cardMaker/header/Header.module.css","cardMaker/header/navbar/navButton/NavButton/NavButton.module.css","cardMaker/header/navbar/previewTemplate/PreviewTemplate.module.css","cardMaker/canvas/text/Text.module.css","cardMaker/toolbar/toolbarText/buttonEditText/ButtonEditText.module.css","cardMaker/toolbar/toolbarImg/ToolbarImg.module.css","cardMaker/toolbar/toolbarImg/addImgByUrlButton/AddImgByUrlButton.module.css","cardMaker/toolbar/toolbarBackground/addBackgroundByUrlButton/AddBackgroundByUrlButton.module.css","cardMaker/toolbar/button/Button.module.css","cardMaker/CardMaker.module.css","cardMaker/header/navbar/Navbar.module.css","cardMaker/canvas/Canvas.module.css","cardMaker/canvas/filter/Filter.module.css","cardMaker/canvas/deleteArea/DeleteArea.module.css","cardMaker/canvas/areaSelection/AreaSelection.module.css","cardMaker/toolbar/Toolbar.module.css","cardMaker/toolbar/toolbarText/colorPicker/ColorPicker.module.css","cardMaker/toolbar/toolbarText/inputNumber/InputNumber.module.css","cardMaker/toolbar/toolbarImg/previewArtObj/PreviewArtObj.module.css","cardMaker/toolbar/modalSearchImg/loadingIndicator/LoadingIndicator.module.css","cardMaker/toolbar/colorPicker/ColorPicker.module.css","cardMaker/toolbar/toolbarObject/ToolbarObject.module.css","store/types.ts","cardMaker/header/navbar/navButton/NavButton/NavButton.tsx","cardMaker/header/navbar/navButton/NavFileButton/NavFileButton.tsx","utils/files.ts","utils/elementList.ts","utils/permisions.ts","store/actionCreators/cardMakerActionCreators.ts","store/reducers/BackgroundReducer.ts","store/reducers/FilterReducer.ts","store/reducers/HeightCanvasReducer.ts","utils/guid.ts","store/reducers/ListBlockReducer.ts","store/reducers/WidthCanvasReducer.ts","store/reducers/CanvasReducer.ts","store/reducers/SelectBlockReducer.ts","store/reducers/HistoryReducer.ts","store/reducers/ViewModelReducer.ts","store/initialState.ts","store/store.ts","store/reducers/CardMakerReducer.ts","store/actionCreators/historyActionCreators.ts","cardMaker/modal/Modal.tsx","cardMaker/header/navbar/navButton/NewProjectButton/NewProjectButton.tsx","utils/color.ts","utils/size.ts","utils/exportInImage.ts","cardMaker/header/navbar/navButton/ExportImgButton/ExportImgButton.tsx","cardMaker/dropdownMenu/DropdownMenu.tsx","cardMaker/header/navbar/previewTemplate/PreviewTemplate.tsx","cardMaker/header/navbar/Navbar.tsx","cardMaker/header/navbar/useStateHistory.ts","cardMaker/header/navbar/useExportFileProject.ts","cardMaker/header/navbar/useImportFileProject.ts","cardMaker/header/Header.tsx","cardMaker/canvas/useStateBlock.ts","cardMaker/canvas/useDragAndDrop.ts","cardMaker/canvas/useResize.ts","store/actionCreators/blockActionCreators.ts","cardMaker/canvas/img/Img.tsx","store/actionCreators/textBlockActionCreators.ts","cardMaker/canvas/text/Text.tsx","cardMaker/canvas/text/useEditText.ts","cardMaker/canvas/artObj/ArtObj.tsx","cardMaker/canvas/filter/Filter.tsx","cardMaker/canvas/deleteArea/DeleteArea.tsx","store/actionCreators/canvasActionCreators.ts","cardMaker/canvas/areaSelection/AreaSelection.tsx","cardMaker/canvas/areaSelection/useAreaSelection.ts","cardMaker/canvas/Canvas.tsx","cardMaker/toolbar/toolbarText/buttonEditText/ButtonEditText.tsx","cardMaker/toolbar/toolbarText/buttonEditText/useEditStateText.ts","cardMaker/toolbar/toolbarText/colorPicker/ColorPicker.tsx","cardMaker/toolbar/toolbarText/colorPicker/useEditColorText.ts","cardMaker/toolbar/toolbarText/inputNumber/InputNumber.tsx","cardMaker/toolbar/toolbarText/inputNumber/useEditFontSize.ts","cardMaker/toolbar/toolbarText/selectFontFamily/SelectFontFamily.tsx","cardMaker/toolbar/toolbarText/selectFontFamily/useSelectFont.ts","cardMaker/toolbar/toolbarText/ToolbarText.tsx","cardMaker/toolbar/toolbarImg/addImgButtonFile/AddImgButtonFile.tsx","cardMaker/toolbar/toolbarImg/previewArtObj/PreviewArtObj.tsx","store/actionCreators/artObjBlockActionCreators.ts","cardMaker/toolbar/toolbarImg/previewArtObj/useCreateArtObj.ts","store/actionCreators/imgBlockActionCreators.ts","cardMaker/toolbar/modalSearchImg/useGetPhotoAPI.ts","cardMaker/toolbar/modalSearchImg/Img.tsx","cardMaker/toolbar/modalSearchImg/loadingIndicator/LoadingIndicator.tsx","cardMaker/toolbar/modalSearchImg/ModalSearchImg.tsx","cardMaker/toolbar/toolbarImg/addImgByUrlButton/useCreateImgByUrl.ts","cardMaker/toolbar/toolbarImg/addImgByUrlButton/AddImgByUrlButton.tsx","cardMaker/toolbar/toolbarImg/ToolbarImg.tsx","cardMaker/toolbar/toolbarImg/useCreateImg.ts","cardMaker/toolbar/colorPicker/ColorPicker.tsx","cardMaker/toolbar/toolbarFilter/ToolbarFilter.tsx","cardMaker/toolbar/toolbarFilter/useStateFilter.ts","cardMaker/toolbar/toolbarBackground/fileImgButton/FileImgButton.tsx","cardMaker/toolbar/toolbarBackground/useBackgroungImg.ts","cardMaker/toolbar/toolbarBackground/addBackgroundByUrlButton/useAddBackgroundByUrl.ts","cardMaker/toolbar/toolbarBackground/addBackgroundByUrlButton/AddBackgroundByUrlButton.tsx","cardMaker/toolbar/toolbarBackground/ToolbarBackground.tsx","cardMaker/toolbar/toolbarBackground/useBackgroungColor.ts","cardMaker/toolbar/button/Button.tsx","cardMaker/toolbar/toolbarObject/ToolbarObject.tsx","cardMaker/toolbar/toolbarObject/useBlockLevel.ts","cardMaker/toolbar/toolbarObject/useBlockDelete.ts","cardMaker/toolbar/toolbarCanvas/ToolbarCanvas.tsx","cardMaker/toolbar/toolbarCanvas/useStateCanvasSize.ts","cardMaker/toolbar/toolbarCanvas/useDeleteArea.ts","cardMaker/toolbar/Toolbar.tsx","cardMaker/CardMaker.tsx","index.tsx"],"names":["module","exports","BlockTypes","NavButton","forwardRef","props","ref","onClick","className","styles","button","icon","label","button__text","connect","NavFileButton","htmlFor","inputFile","type","accept","id","getImgInformationFromFile","fileImg","a","promise","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","img","Image","src","decode","getProjectFromFile","file","JSON","readAsText","parse","setComponentFields","listBlock","modifiableFields","newListBlock","forEach","component","push","getIndexById","foundIndex","block","index","verify","value","Error","applyFileProject","cardMaker","project","SetOfArtObject","templates","birthday_1","name","json","preview","birthday_2","february_23_1","march_8_1","march_8_2","new_year_1","new_year_2","new_year_3","september_1_1","background","action","color","width","height","filter","opacity","heightCanvas","createGUID","gen","join","count","out","i","Math","random","toString","substring","text","x","y","size","bold","italic","underline","fontFamily","isBold","isItalic","isUnderline","artObj","copyListBlock","Boolean","isSelectedBlock","splice","length","isShiftUpAvailable","flipValue","isShiftDownAvailable","widthCanvas","canvas","deleteArea","area","selectBlock","history","listState","currentIndex","newListState","newCanvas","newCurrentIndex","isUndoAvailable","isRedoAvailable","areaSelection","viewModel","bgColor","bgImg","canvasSize","list","defState","tempColor","tempSize","testCanvas","testCardMaker","exceptions","store","createStore","applyMiddleware","next","oldState","getState","includes","newState","stringify","console","log","dispatch","visible","title","content","footer","onClose","useEffect","onKeydown","key","document","addEventListener","removeEventListener","modal","modalDialog","e","stopPropagation","modalHeader","modalTitle","modalClose","faTimes","modalBody","modalContent","modalFooter","newCardMaker","useState","isModal","setModal","faPiedPiperSquare","convertColor","rgbColor","r","g","b","parseInt","calcWidthByHeight","initWidth","initHeight","baseHeight","calcHeightByWidth","baseWidth","calcSizeImgByCanvas","imgW","imgH","canvasW","canvasH","newHeight","calcSizeByWidth","newWidth","calcSizeByHeight","exportInImage","canvasWidth","canvasHeight","elements","deleteAreas","canvasElement","createElement","ctx","getContext","crossOrigin","drawImage","fillStyle","fillRect","element","renderBlock","dataURL","toDataURL","link","href","download","click","renderText","renderImg","renderArtObj","style","weight","family","textBlock","innerHTML","shift","Array","from","children","str","font","fillText","innerText","textWidth","measureText","chars","downloadImg","useRef","faImage","dropdown","dropbtn","dropdownText","dropdownContent","minWidth","template","onAccept","fetch","srcJson","response","srcImg","alt","undo","redo","buttonUndo","buttonRedo","btnUndo","current","btnRedo","handlerClickUndo","handlerClickRedo","handlerKeydown","event","code","ctrlKey","metaKey","useStateHistory","downloadButton","downloadFile","input","handlerChangeInputFile","files","alert","useImportFileProject","handlerClickSaveToJson","Blob","URL","createObjectURL","srcList","Object","values","previewList","tmp","navbar","faFolderOpen","faFileExport","faClone","faUndo","faRedo","header","mainLabel","useStateBlock","blockId","setSelectedBlock","resetSelectedBlock","currentBlock","mouseDownCurrentBlock","handleMousedownBlock","setTimeout","handleClickDocument","isDefPrev","defaultPrevented","isSelectedID","target","useDragAndDrop","defPos","setPositionBlock","startPos","newPos","handleMousedown","pageX","pageY","handleMouseMove","handleMouseUp","preventDefault","delta","left","top","useResize","setSizeBlock","LT","RT","LB","RB","defSize","point","pointLT","pointRT","pointLB","pointRB","offsetX","offsetY","prevWidth","prevHeight","moving","calculateSize","deleteBlock","state","imgStyle","getStyle","imgBlock","select","selected","onDragStart","pointTopLeft","pointTopRight","pointBottomLeft","pointBottomRight","setBoldText","setItalicText","setUnderlineText","setTextInTextBlock","clickOnText","handleClickBlock","handleDblclickBlock","setAttribute","focus","handleBlur","getAttribute","stopImmediatePropagation","execCommand","handlerPaste","clipboardData","getData","handlerInput","textStyle","fontSize","fontWeight","textDecoration","fontStyle","contentEditable","suppressContentEditableWarning","dangerouslySetInnerHTML","__html","artObjBlock","artObjStyle","filterStyle","deleteAreaStyle","setCanvasSize","setBackgroundImg","inputBackgroundImg","AreaSelection","resetAreaSelection","startOffsetPos","field","selectArea","div","border","appendChild","abs","offsetWidth","offsetHeight","offsetLeft","offsetTop","remove","handleMousedownDocument","handleMousedownArea","position","zIndex","pointerEvents","useAreaSelection","setPositionAreaSelection","areaSelectionStyle","canvasStyle","backgroundColor","backgroundImage","bgWidth","bgHeight","bgSize","backgroundSize","getListBlock","enabled","modifyFn","param","btn","handleClickButton","useEditStateText","active","setColorText","inputColorText","colorPicker","inputColor","handleInput","handleChange","handleClick","useEditColorText","setSizeText","inputSizeText","inputNumber","fieldSize","Number","String","input__number","min","max","step","setFontFamilyText","selectFontFamily","useSelectFont","fontFamilies","class","robotoSlab","fantazyor","piroucyrillic","phenomena","sunday","kurale","sensei","borsok","summer","underdog","montserrat","openSans","comfortaa","rubik","marta","map","currentStyle","createTextBlock","toolbar","toolbar__row","faFont","faBold","faItalic","faUnderline","colorPickerBox","AddImgButton","buttonText","createArtObjBlock","artObjPreview","handleClickArtObj","sticker","createImgBlock","search","query","split","headers","useImg","baseSrc","loading","LoadingIndicator","cssloadSpinBox","buttonSearch","buttonNext","buttonBack","loadingIndicator","information","images","setImages","setNext","back","setBack","btnSearch","btnNext","btnBack","handlerClickSearch","display","photos","next_page","handlerClickLink","prev_page","arr","item","large","visibility","useGetPhotoAPI","images1","images2","onCloseModal","searchBox","navBox","useCreateImgByUrl","url","image","handlerClick","newImage","AddImgByUrlButton","imgList","handlerChangeInput","useCreateImg","button_box","AddImgButtonFile","faDownload","faGlobe","faStickyNote","ColorPicker","input__color","inputFilter","setFilter","inputRange","fieldColor","fieldRange","handleInputFilter","handleChangeFilter","useStateFilter","row","viewModelBgImg","handlerChange","useBackgroungImg","bg","useAddBackgroundByUrl","photo","Button","isModalSearchImg","setModalSearchImg","onCloseModalSearchImg","button_text","resetBackground","inputBackgroundColor","setBackgroundColor","buttonReset","handlerClickResetColor","handlerInputColor","handleerChangeColor","useBackgroungColor","FileImgButton","AddBackgroundByUrlButton","reset","faRetweet","shiftUpBlock","shiftDownBlock","buttonUp","buttonDown","buttonDelete","btnUp","btnDown","handlerClickShiftUp","handlerClickShiftDown","useBlockLevel","handlerClickDelete","useBlockDelete","faArrowUp","faArrowDown","faTrash","inputCanvasSize","deleteAreaSelection","inputWidth","inputHeight","fieldWidth","fieldHeight","handleChangeSize","handleBlurSize","useStateCanvasSize","handleMousedownButton","useDeleteArea","unitsLabel","faEraser","main","window","returnValue","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.1e8f9242.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"select\":\"SelectFontFamily_select__-xsBg\",\"robotoSlab\":\"SelectFontFamily_robotoSlab__27hZJ\",\"fantazyor\":\"SelectFontFamily_fantazyor__M9yoI\",\"piroucyrillic\":\"SelectFontFamily_piroucyrillic__29ewu\",\"phenomena\":\"SelectFontFamily_phenomena__NRqnd\",\"sunday\":\"SelectFontFamily_sunday__1H2GQ\",\"kurale\":\"SelectFontFamily_kurale__3Hg9L\",\"sensei\":\"SelectFontFamily_sensei__M0k1g\",\"borsok\":\"SelectFontFamily_borsok__uN7nG\",\"summer\":\"SelectFontFamily_summer__1iu_f\",\"underdog\":\"SelectFontFamily_underdog__1VSS1\",\"montserrat\":\"SelectFontFamily_montserrat__2gZbq\",\"openSans\":\"SelectFontFamily_openSans__20d1g\",\"comfortaa\":\"SelectFontFamily_comfortaa__3j5F8\",\"rubik\":\"SelectFontFamily_rubik__3P7MR\",\"marta\":\"SelectFontFamily_marta__JO1cQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"ModalSearchImg_modal__uBBh1\",\"appear\":\"ModalSearchImg_appear__1G1Sw\",\"modalDialog\":\"ModalSearchImg_modalDialog__1idJU\",\"animatetop\":\"ModalSearchImg_animatetop__lbfEH\",\"slide-in\":\"ModalSearchImg_slide-in__3tA5h\",\"modalHeader\":\"ModalSearchImg_modalHeader__3KLzI\",\"modalFooter\":\"ModalSearchImg_modalFooter__2HKjX\",\"modalClose\":\"ModalSearchImg_modalClose__3YhCx\",\"modalBody\":\"ModalSearchImg_modalBody__dyHSE\",\"modalContent\":\"ModalSearchImg_modalContent__2Q6UH\",\"modalTitle\":\"ModalSearchImg_modalTitle__1vEB0\",\"searchBox\":\"ModalSearchImg_searchBox__1QOP1\",\"navBox\":\"ModalSearchImg_navBox__1nyG-\",\"information\":\"ModalSearchImg_information__3v8sD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarCanvas_toolbar__1lWFF\",\"inputNumber\":\"ToolbarCanvas_inputNumber__3FE9W\",\"row\":\"ToolbarCanvas_row__1CFS7\",\"label\":\"ToolbarCanvas_label__1kyuR\",\"unitsLabel\":\"ToolbarCanvas_unitsLabel__2Sp-N\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"Modal_modal__3Ldwj\",\"modalDialog\":\"Modal_modalDialog__3Du5z\",\"modalHeader\":\"Modal_modalHeader__1ppBy\",\"modalFooter\":\"Modal_modalFooter__lSAfT\",\"modalClose\":\"Modal_modalClose__3GnIC\",\"modalBody\":\"Modal_modalBody__12nPW\",\"modalContent\":\"Modal_modalContent__35CCy\",\"modalTitle\":\"Modal_modalTitle__bNkET\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"Img_block__r3fmB\",\"img\":\"Img_img__3Hans\",\"selected\":\"Img_selected__vEyvs\",\"pointBottomRight\":\"Img_pointBottomRight__1Z-pj\",\"pointTopLeft\":\"Img_pointTopLeft__3ZXB8\",\"pointTopRight\":\"Img_pointTopRight__2cXMJ\",\"pointBottomLeft\":\"Img_pointBottomLeft__x6rWq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"ArtObj_block__1DyCD\",\"img\":\"ArtObj_img__3ltZN\",\"selected\":\"ArtObj_selected__1oJ2Z\",\"pointBottomRight\":\"ArtObj_pointBottomRight__3og1x\",\"pointTopLeft\":\"ArtObj_pointTopLeft__2iQK4\",\"pointTopRight\":\"ArtObj_pointTopRight__19xjD\",\"pointBottomLeft\":\"ArtObj_pointBottomLeft__1BMY1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"NavFileButton_button__31bRb\",\"button__text\":\"NavFileButton_button__text__2WzyS\",\"inputFile\":\"NavFileButton_inputFile__3SOw7\",\"icon\":\"NavFileButton_icon__1R6pk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dropbtn\":\"DropdownMenu_dropbtn__2-JiC\",\"dropdown\":\"DropdownMenu_dropdown__2_ubm\",\"dropdownContent\":\"DropdownMenu_dropdownContent__3ihyt\",\"dropdownText\":\"DropdownMenu_dropdownText__TLnH9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarText_toolbar__3Q1B2\",\"toolbar__row\":\"ToolbarText_toolbar__row__2xbEr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"AddImgButtonFile_button__2-aES\",\"buttonText\":\"AddImgButtonFile_buttonText__QVBcl\",\"inputFile\":\"AddImgButtonFile_inputFile__2htQZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarFilter_toolbar__33oQI\",\"inputRange\":\"ToolbarFilter_inputRange__3VgvX\",\"row\":\"ToolbarFilter_row__2v8k_\",\"label\":\"ToolbarFilter_label__1iRk3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarBackground_toolbar__1Rsa9\",\"row\":\"ToolbarBackground_row__Jz_7E\",\"label\":\"ToolbarBackground_label__iB0N8\",\"reset\":\"ToolbarBackground_reset__28bz6\",\"active\":\"ToolbarBackground_active__2f4Mq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"FileImgButton_button__YkRnP\",\"buttonText\":\"FileImgButton_buttonText__zV9Xx\",\"inputFile\":\"FileImgButton_inputFile__3s8el\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__1rLmw\",\"panel\":\"Header_panel__29H5m\",\"mainLabel\":\"Header_mainLabel__3rCOx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"NavButton_button__UL2Cr\",\"button__text\":\"NavButton_button__text__C4Sqv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"preview\":\"PreviewTemplate_preview__IUSm5\",\"img\":\"PreviewTemplate_img__ajmyo\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"block\":\"Text_block__Fvt_5\",\"selected\":\"Text_selected__2uNOO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"ButtonEditText_button__2hfGq\",\"active\":\"ButtonEditText_active__Ffbj1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarImg_toolbar__GYlq5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"AddImgByUrlButton_button__1EEtm\",\"buttonText\":\"AddImgByUrlButton_buttonText__OVCrG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"AddBackgroundByUrlButton_button__JwlsP\",\"button_text\":\"AddBackgroundByUrlButton_button_text__1Me2L\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"Button_button__35p3U\",\"buttonText\":\"Button_buttonText__22v9d\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"CardMaker_main__qNuoq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"navbar\":\"Navbar_navbar__2UjT7\",\"input\":\"Navbar_input__1lW6o\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"canvas\":\"Canvas_canvas__Ak89z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"filter\":\"Filter_filter__16erS\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"deleteArea\":\"DeleteArea_deleteArea__2KQym\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"areaSelection\":\"AreaSelection_areaSelection__1Syux\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"Toolbar_toolbar__apu1b\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input\":\"ColorPicker_input__3Kdsq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input__number\":\"InputNumber_input__number__2Dr6G\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sticker\":\"PreviewArtObj_sticker__yjFpD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cssloadSpinBox\":\"LoadingIndicator_cssloadSpinBox__27Etq\",\"cssload-spin\":\"LoadingIndicator_cssload-spin__3fpV3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"input__color\":\"ColorPicker_input__color__29NBt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toolbar\":\"ToolbarObject_toolbar__29GLR\"};","export enum BlockTypes {\n  img,\n  artObj,\n  text\n}\n\nexport const templates = {\n  birthday_1: {\n    name: \"С днем рождения!\",\n    json: \"./templates/birthday_1.json\",\n    preview: \"./templates/birthday_1.png\",\n  },\n  birthday_2: {\n    name: \"С днем рождения!\",\n    json: \"./templates/birthday_2.json\",\n    preview: \"./templates/birthday_2.png\",\n  },\n  february_23_1: {\n    name: \"С 23 февраля!\",\n    json: \"./templates/february_23_1.json\",\n    preview: \"./templates/february_23_1.png\",\n  },\n  march_8_1: {\n    name: \"С 8 марта!\",\n    json: \"./templates/march_8_1.json\",\n    preview: \"./templates/march_8_1.png\",\n  },\n  march_8_2: {\n    name: \"С 8 марта!\",\n    json: \"./templates/march_8_2.json\",\n    preview: \"./templates/march_8_2.png\",\n  },\n  new_year_1: {\n    name: \"С новым годом!\",\n    json: \"./templates/new_year_1.json\",\n    preview: \"./templates/new_year_1.png\",\n  },\n  new_year_2: {\n    name: \"С новым годом!\",\n    json: \"./templates/new_year_2.json\",\n    preview: \"./templates/new_year_2.png\",\n  },\n  new_year_3: {\n    name: \"С новым годом!\",\n    json: \"./templates/new_year_3.json\",\n    preview: \"./templates/new_year_3.png\",\n  },\n  september_1_1: {\n    name: \"С 1 сентября!\",\n    json: \"./templates/september_1_1.json\",\n    preview: \"./templates/september_1_1.png\",\n  },\n}\n\n\nexport enum SetOfArtObject {\n  ball_1 = \"./img/artObj/ball_1.svg\",\n  bouquet_1 = \"./img/artObj/bouquet_1.svg\",\n  bouquet_2 = \"./img/artObj/bouquet_2.svg\",\n  bouquet_3 = \"./img/artObj/bouquet_3.svg\",\n  bouquet_4 = \"./img/artObj/bouquet_4.svg\",\n  bouquet_5 = \"./img/artObj/bouquet_5.svg\",\n  bow = \"./img/artObj/bow.svg\",\n  branch_1 = \"./img/artObj/branch_1.svg\",\n  branch_2 = \"./img/artObj/branch_2.svg\",\n  branch_3 = \"./img/artObj/branch_3.svg\",\n  camera_1 = \"./img/artObj/camera_1.svg\",\n  camera_2 = \"./img/artObj/camera_2.svg\",\n  flower_1 = \"./img/artObj/flower_1.svg\",\n  flower_2 = \"./img/artObj/flower_2.svg\",\n  flower_3 = \"./img/artObj/flower_3.svg\",\n  gift_1 = \"./img/artObj/gift_1.svg\",\n  gift_2 = \"./img/artObj/gift_2.svg\",\n  gift_3 = \"./img/artObj/gift_3.svg\",\n  sun_1 = \"./img/artObj/sun_1.svg\",\n  tree_1 = \"./img/artObj/tree_1.svg\",\n}\n\nexport type ActionHistory = Readonly<{\n  listState: Canvas[],\n  currentIndex: number,\n}>\n\nexport type Position = Readonly<{\n  x: number,\n  y: number,\n}>\n\nexport type UnifiedBlock = Readonly<{\n  id: string,\n}> & Position\n\nexport type ArtObj = Readonly<{\n  src: string,\n  type: BlockTypes.artObj\n}> & UnifiedBlock & Size\n\nexport type Img = Readonly<{\n  src: string,\n  type: BlockTypes.img\n}> & UnifiedBlock & Size\n\nexport type Text = Readonly<{\n  text: string,\n  color: string,\n  size: number,\n  bold: boolean,\n  italic: boolean,\n  underline: boolean,\n  fontFamily: string,\n  type: BlockTypes.text\n}> & UnifiedBlock\n\nexport type Block = Readonly<Text | Img | ArtObj>;\n\nexport type Background = Readonly<{\n  color: string | null,\n  src: string | null,\n  width: number | null,\n  height: number | null,\n}>\n\nexport type Filter = Readonly<{\n  color: string,\n  opacity: number,\n}>\n\nexport type Area = Readonly<{\n  x: number,\n  y: number,\n}> & Size\n\nexport type Canvas = Readonly<{\n  filter: Filter,\n  listBlock: Block[];\n  deleteArea: Area[],\n  background: Background,\n}> & Size\n\nexport type Size = Readonly<{\n  width: number,\n  height: number,\n}>\n\nexport type ViewModelText = Readonly<{\n  color: string | null,\n  size: number | null,\n  bold: boolean | null,\n  italic: boolean | null,\n  underline: boolean | null,\n  fontFamily: string | null,\n  tempColor: string | null,\n  tempSize: number | null,\n}>\n\nexport type ViewModelBgImg = Readonly<{\n  width: number,\n  height: number,\n  src: string,\n}>\n\nexport type ViewModel = Readonly<{\n  bgColor: string | null,\n  bgImg: ViewModelBgImg | null,\n  canvasSize: Size | null,\n  filter: Filter | null,\n  text: ViewModelText,\n  areaSelection: Area | null,\n}>\n\nexport type CardMaker = Readonly<{\n  canvas: Canvas,\n  selectBlock: string | null,\n  history: ActionHistory,\n  viewModel: ViewModel,\n}>\n\nexport type RGB = {\n  r: number,\n  g: number,\n  b: number\n}\n","import styles from \"./NavButton.module.css\";\r\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { ForwardedRef, forwardRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\ntype NavButtonProps = {\r\n  label: string,\r\n  icon: IconDefinition,\r\n  onClick: null | (() => void),\r\n}\r\n\r\nconst NavButton = forwardRef((props: NavButtonProps, ref: ForwardedRef<HTMLButtonElement>) => {\r\n  return (\r\n    <button\r\n      onClick={props.onClick ? props.onClick : ()=>{}}\r\n      className={styles.button}\r\n      ref={ref}>\r\n      <FontAwesomeIcon icon={props.icon} />\r\n      {props.label !== \"\" &&\r\n        <span className={styles.button__text}>{props.label}</span>\r\n      }\r\n    </button>\r\n  )\r\n});\r\n\r\nexport default connect(null, null, null, { forwardRef: true })(NavButton);","import styles from \"./NavFileButton.module.css\";\r\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\r\nimport { ForwardedRef, forwardRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\ntype NavFileButtonProps = {\r\n  label: string,\r\n  icon: IconDefinition,\r\n}\r\n\r\nconst NavFileButton = forwardRef((props: NavFileButtonProps, ref: ForwardedRef<HTMLInputElement>) => (\r\n  <button className={styles.button}>\r\n    <label htmlFor=\"input-file\" className={styles.icon}>\r\n      <FontAwesomeIcon icon={props.icon} />\r\n    </label>\r\n    <input\r\n      className={styles.inputFile}\r\n      type=\"file\"\r\n      accept=\".json\"\r\n      ref={ref}\r\n      id=\"input-file\"\r\n    />\r\n    {props.label !== \"\" &&\r\n      <label className={styles.button__text}\r\n        htmlFor=\"input-file\">\r\n        {props.label}\r\n      </label>\r\n    }\r\n  </button>\r\n));\r\n\r\nexport default connect(null, null, null, { forwardRef: true })(NavFileButton);","import { CardMaker } from \"../store/types\";\n\n// файл изображения в base64\nexport const getImgInformationFromFile = async (fileImg: File): Promise<HTMLImageElement> => {\n\n  const promise = new Promise((resolve, reject) => {\n    const reader: FileReader = new FileReader();\n    reader.readAsDataURL(fileImg);\n    reader.onload = async () => resolve(reader.result);\n    reader.onerror = reject;\n  });\n    const img: HTMLImageElement = new Image();\n    img.src = await promise as string;\n    await img.decode();\n    return img;\n}\n\n// json файл проекта в объект\nexport const getProjectFromFile = async (file: File): Promise<CardMaker> =>\n  JSON.parse(await new Promise((resolve, reject) => {\n    const reader: FileReader = new FileReader();\n    reader.readAsText(file);\n    reader.onload = () => resolve(reader.result as string);\n    reader.onerror = reject;\n  }));","import { Block } from \"../store/types\";\n\n// проверка выделен ли блок\nexport function isSelectedBlock(id: string | null): boolean {\n  return Boolean(id)\n}\n\n// установка значений полю/полям одного элемента из списка элементов\nexport function setComponentFields(listBlock: Block[], id: string, modifiableFields: object): Block[] {\n  let newListBlock: Block[] = [];\n  listBlock.forEach((component: Block) => {\n    if (component.id === id) {\n      newListBlock.push({\n        ...component,\n        ...modifiableFields,\n      });\n    } else {\n      newListBlock.push(component);\n    }\n  });\n  return newListBlock;\n}\n\n// получить индекс элемента по id\nexport function getIndexById(listBlock: Block[], id: string): number {\n  let foundIndex: number = -1;\n  listBlock.forEach((block: Block, index: number) => {\n    if (block.id === id) {\n      foundIndex = index;\n      return;\n    }\n  });\n  return foundIndex;\n}","import { ActionHistory, Block } from \"../store/types\";\nimport { getIndexById } from \"./elementList\";\n\n// провера доступности операции undo\nexport function isUndoAvailable(history: ActionHistory): boolean {\n  const length: number = history.listState.length;\n  const index: number = history.currentIndex;\n  return length > 1 && index > 0;\n}\n\n// проверка доступности операции redo\nexport function isRedoAvailable(history: ActionHistory): boolean {\n  const length: number = history.listState.length;\n  const index: number = history.currentIndex;\n  return index + 1 < length;\n}\n\n// проверка доступности операции перемещения слоя вверх\nexport function isShiftUpAvailable(id: string | null, listBlock: Block[]): boolean {\n  const length: number = listBlock.length;\n  return Boolean(id && getIndexById(listBlock, id) < length - 1)\n}\n\n// проверка доступности операции перемещения слоя вниз\nexport function isShiftDownAvailable(id: string | null, listBlock: Block[]): boolean {\n  return Boolean(id && getIndexById(listBlock, id) > 0)\n}\n\n// проверка на !null значение\nexport function verify<T>(value: T | null | undefined): T {\n  if (!value) {\n    throw new Error(\"Assertion failed\");\n  }\n  return value;\n}","import { CardMaker } from \"../types\";\n\nexport function newCardMaker() {\n  return {\n    type: \"NEW_CARD_MAKER\",\n  }\n}\n\nexport function applyFileProject(cardMaker: CardMaker) {\n  return {\n    type: \"APPLY_FILE_PROJECT\",\n    project: cardMaker,\n  }\n}\n","import { Background } from \"../types\";\n\nexport type BackgroundAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"RESET_BACKGROUND\",\n} | {\n  type: \"SET_BACKGROUND_COLOR\",\n  color: string,\n} | {\n  type: \"SET_BACKGROUND_IMG\",\n  src: string,\n  width: number,\n  height: number,\n}\n\nfunction background(background: Background, action: BackgroundAction): Background {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return {\n        color: \"#ffffff\",\n        src: null,\n        width: null,\n        height: null,\n      };\n\n    case \"RESET_BACKGROUND\":\n      return {\n        color: \"#ffffff\",\n        src: null,\n        width: null,\n        height: null,\n      };\n\n    case \"SET_BACKGROUND_COLOR\":\n      return {\n        color: action.color,\n        src: null,\n        width: null,\n        height: null,\n      };\n\n    case \"SET_BACKGROUND_IMG\":\n      return {\n        color: null,\n        src: action.src,\n        width: action.width,\n        height: action.height,\n      };\n\n    default:\n      return background;\n  }\n}\n\nexport default background;","import { Filter } from \"../types\";\n\nexport type FilterAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"SET_FILTER\",\n  color: string,\n  opacity: number,\n}\n\nfunction filter(filter: Filter, action: FilterAction): Filter {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return {\n        color: \"#ffffff\",\n        opacity: 0,\n      };\n\n    case \"SET_FILTER\":\n      return {\n        color: action.color,\n        opacity: action.opacity,\n      };\n\n    default:\n      return filter;\n  }\n}\n\nexport default filter;","export type HeightAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"SET_CANVAS_SIZE\",\n  height: number,\n}\n\nfunction heightCanvas(height: number, action: HeightAction): number {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return 600;\n\n    case \"SET_CANVAS_SIZE\":\n      return action.height;\n\n    default:\n      return height;\n  }\n}\n\nexport default heightCanvas;","export function createGUID() {\n  return [gen(2), gen(1), gen(1), gen(1), gen(3)].join(\"-\");\n}\n\nfunction gen(count: number) {\n  let out = \"\";\n  for (let i: number = 0; i < count; i++) {\n    out += (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n  }\n  return out;\n}","import { Block, BlockTypes } from \"../types\";\nimport { setComponentFields, getIndexById, isSelectedBlock } from \"../../utils/elementList\"\nimport { isShiftUpAvailable, isShiftDownAvailable } from \"../../utils/permisions\"\nimport { createGUID } from \"../../utils/guid\";\n\nexport type ListBlockAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"CREATE_TEXT_BLOCK\",\n  x: number,\n  y: number,\n} | {\n  type: \"SET_SIZE_BLOCK\",\n  id: string,\n  width: number,\n  height: number,\n} | {\n  type: \"SET_TEXT_IN_TEXT_BLOCK\",\n  id: string,\n  text: string,\n} | {\n  type: \"SET_FONT_FAMILY_TEXT\",\n  id: string,\n  fontFamily: string,\n} | {\n  type: \"SET_BOLD_TEXT\",\n  id: string,\n  isBold: boolean,\n} | {\n  type: \"SET_ITALIC_TEXT\",\n  id: string,\n  isItalic: boolean,\n} | {\n  type: \"SET_UNDERLINE_TEXT\",\n  id: string,\n  isUnderline: boolean,\n} | {\n  type: \"SET_SIZE_TEXT\",\n  id: string,\n  size: number,\n} | {\n  type: \"SET_COLOR_TEXT\",\n  id: string,\n  color: string,\n} | {\n  type: \"CREATE_IMG_BLOCK\",\n  width: number,\n  height: number,\n  src: string,\n  x: number,\n  y: number,\n} | {\n  type: \"CREATE_ART_OBJ_BLOCK\",\n  src: string,\n  x: number,\n  y: number,\n} | {\n  type: \"DELETE_BLOCK\",\n  id: string,\n} | {\n  type: \"SET_POSITION_BLOCK\",\n  id: string,\n  x: number,\n  y: number,\n} | {\n  type: \"SHIFT_UP_BLOCK\",\n  id: string,\n} | {\n  type: \"SHIFT_DOWN_BLOCK\",\n  id: string,\n}\n\nfunction listBlock(listBlock: Block[], action: ListBlockAction): Block[] {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return [];\n\n    case \"CREATE_TEXT_BLOCK\":\n      return [\n        ...listBlock,\n        {\n          id: createGUID(),\n          type: BlockTypes.text,\n          color: \"#898989\",\n          x: action.x - 45,\n          y: action.y - 25,\n          text: \"<div>Текст<br></div>\",\n          size: 50,\n          bold: false,\n          italic: false,\n          underline: false,\n          fontFamily: \"OpenSans\",\n        }\n      ];\n\n    case \"SET_SIZE_BLOCK\":\n      return setComponentFields(listBlock, action.id, {\n        width: action.width,\n        height: action.height,\n      });\n\n    case \"SET_TEXT_IN_TEXT_BLOCK\":\n      return setComponentFields(listBlock, action.id, {\n        text: action.text,\n      });\n\n    case \"SET_FONT_FAMILY_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        fontFamily: action.fontFamily,\n      });\n\n    case \"SET_BOLD_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        bold: action.isBold,\n      });\n\n    case \"SET_ITALIC_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        italic: action.isItalic,\n      });\n\n    case \"SET_UNDERLINE_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        underline: action.isUnderline,\n      });\n\n    case \"SET_SIZE_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        size: action.size,\n      });\n\n    case \"SET_COLOR_TEXT\":\n      return setComponentFields(listBlock, action.id, {\n        color: action.color,\n      });\n\n    case \"CREATE_IMG_BLOCK\":\n      return [\n        ...listBlock,\n        {\n          id: createGUID(),\n          type: BlockTypes.img,\n          width: action.width,\n          height: action.height,\n          x: action.x,\n          y: action.y,\n          src: action.src,\n        }\n      ];\n\n    case \"CREATE_ART_OBJ_BLOCK\":\n      return [\n        ...listBlock,\n        {\n          id: createGUID(),\n          type: BlockTypes.artObj,\n          width: 150,\n          height: 150,\n          x: action.x,\n          y: action.y,\n          src: action.src,\n        }\n      ];\n\n    case \"DELETE_BLOCK\":\n      const copyListBlock: Block[] = [...listBlock];\n      if (isSelectedBlock(action.id)) {\n        copyListBlock.forEach((component, index) => {\n          if (component.id === action.id) {\n            copyListBlock.splice(index, 1);\n            return false;\n          }\n        });\n      }\n      return copyListBlock;\n\n    case \"SET_POSITION_BLOCK\":\n      return setComponentFields(listBlock, action.id, {\n        x: action.x,\n        y: action.y,\n      });\n\n    case \"SHIFT_UP_BLOCK\":\n      {\n        const newListBlock: Block[] = [...listBlock];\n        if (isShiftUpAvailable(action.id, listBlock)) {\n          const id: string = action.id;\n          const index: number = getIndexById(newListBlock, id);\n          const flipValue: Block[] = [newListBlock[index + 1], newListBlock[index]];\n          newListBlock.splice(index, 2, ...flipValue);\n        }\n        return newListBlock;\n      }\n\n    case \"SHIFT_DOWN_BLOCK\":\n      {\n        const newListBlock: Block[] = [...listBlock];\n        if (isShiftDownAvailable(action.id, listBlock)) {\n          const id: string = action.id;\n          const index: number = getIndexById(newListBlock, id);\n          const flipValue: Block[] = [newListBlock[index], newListBlock[index - 1]];\n          newListBlock.splice(index - 1, 2, ...flipValue);\n        }\n        return newListBlock;\n      }\n\n    default:\n      return listBlock;\n  }\n}\n\nexport default listBlock;","export type WidthAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"SET_CANVAS_SIZE\",\n  width: number,\n}\n\nfunction widthCanvas(width: number, action: WidthAction): number {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return 800;\n\n    case \"SET_CANVAS_SIZE\":\n      return action.width;\n\n    default:\n      return width;\n  }\n}\nexport default widthCanvas;","import { Canvas, Area } from \"../types\";\nimport background, { BackgroundAction } from \"./BackgroundReducer\";\nimport filter, { FilterAction } from \"./FilterReducer\";\nimport heightCanvas, { HeightAction } from \"./HeightCanvasReducer\";\nimport listBlock, { ListBlockAction } from \"./ListBlockReducer\";\nimport widthCanvas, { WidthAction } from \"./WidthCanvasReducer\";\n\nexport type CanvasAction = WidthAction | HeightAction | FilterAction | ListBlockAction | BackgroundAction | DeleteAreaAction;\n\nfunction canvas(canvas: Canvas, action: CanvasAction): Canvas {\n  return {\n    width: widthCanvas(canvas.width, action as WidthAction),\n    height: heightCanvas(canvas.height, action as HeightAction),\n    filter: filter(canvas.filter, action as FilterAction),\n    listBlock: listBlock(canvas.listBlock, action as ListBlockAction),\n    background: background(canvas.background, action as BackgroundAction),\n    deleteArea: deleteArea(canvas.deleteArea, action as DeleteAreaAction),\n  };\n}\n\nexport default canvas;\n\ntype DeleteAreaAction = {\n  type: \"DELETE_AREA_SELECTION\",\n  area: Area | null\n} | {\n  type: \"NEW_CARD_MAKER\",\n}\n\nfunction deleteArea(deleteArea: Area[], action: DeleteAreaAction): Area[] {\n  switch (action.type) {\n    case \"DELETE_AREA_SELECTION\":\n      if (action.area) {\n        return [\n          ...deleteArea,\n          action.area as Area,\n        ];\n      } else {\n        return deleteArea;\n      }\n    case \"NEW_CARD_MAKER\":\n      return [];\n  \n    default:\n      return deleteArea;\n  }\n}","export type SelectBlockAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"RESET_SELECTED_BLOCK\",\n  width: number,\n} | {\n  type: \"SET_SELECTED_BLOCK\",\n  id: string,\n} | {\n  type: \"DELETE_BLOCK\",\n}\n\nfunction selectBlock(selectBlock: null | string, action: SelectBlockAction): string | null {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return null;\n\n    case \"RESET_SELECTED_BLOCK\":\n      return null;\n\n    case \"SET_SELECTED_BLOCK\":\n      return action.id;\n\n    case \"DELETE_BLOCK\":\n      return null;\n\n    default:\n      return selectBlock;\n  }\n}\n\nexport default selectBlock;","import { Canvas, ActionHistory } from \"../types\";\nimport { isUndoAvailable, isRedoAvailable } from \"../../utils/permisions\"\nimport canvas from \"./CanvasReducer\";\n\nexport type HistoryAction = {\n  type: \"NEW_CARD_MAKER\",\n} | {\n  type: \"ADD_HISTORY\",\n  newCanvas: Canvas,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\",\n}\n\nfunction history(history: ActionHistory, action: HistoryAction): ActionHistory {\n  switch (action.type) {\n\n    case \"NEW_CARD_MAKER\":\n      return {\n        listState: [canvas({} as Canvas, action)],\n        currentIndex: 0,\n      };\n\n    case \"ADD_HISTORY\":\n      {\n        const listState: Canvas[] = history.listState;\n        const currentIndex: number = history.currentIndex;\n        const newListState: Canvas[] = [...history.listState];\n        if (currentIndex !== listState.length - 1) {\n          newListState.splice(currentIndex + 1, listState.length - currentIndex + 1);\n        }\n        newListState.push(action.newCanvas);\n        return {\n          currentIndex: currentIndex + 1,\n          listState: newListState,\n        };\n      }\n\n    case \"UNDO\":\n      {\n        const currentIndex: number = history.currentIndex;\n        const newCurrentIndex: number = isUndoAvailable(history) ? currentIndex - 1 : currentIndex;\n        return {\n          ...history,\n          currentIndex: newCurrentIndex,\n        }\n      }\n\n    case \"REDO\":\n      {\n        const currentIndex: number = history.currentIndex;\n        const newCurrentIndex: number = isRedoAvailable(history) ? currentIndex + 1 : currentIndex;\n        return {\n          ...history,\n          currentIndex: newCurrentIndex,\n        }\n      }\n\n    default:\n      return history;\n  }\n}\n\nexport default history;","import { CardMaker, Size, Filter, ViewModelText, Block, Text, Area } from \"../types\";\nimport { getIndexById } from \"../../utils/elementList\";\n\nexport type ViewModelAction = { type: \"NEW_CARD_MAKER\" } | BgColorAction | BgImgAction | CanvasSizeAction | FilterAction | TextAction;\n\nfunction viewModel(cardMaker: CardMaker = {} as CardMaker, action: ViewModelAction) {\n  if (action.type === \"NEW_CARD_MAKER\") {\n    return {\n      bgColor: null,\n      bgImg: null,\n      canvasSize: null,\n      filter: null,\n      text: {\n        color: null,\n        size: null,\n        bold: null,\n        italic: null,\n        underline: null,\n        fontFamily: null,\n        tempColor: null,\n        tempSize: null,\n      },\n      areaSelection: null,\n    }\n  }\n  return {\n    bgColor: bgColor(cardMaker, action as BgColorAction),\n    bgImg: bgImg(cardMaker, action as BgImgAction),\n    canvasSize: canvasSize(cardMaker, action as CanvasSizeAction),\n    filter: filter(cardMaker, action as FilterAction),\n    text: text(cardMaker, action as TextAction),\n    areaSelection: areaSelection(cardMaker, action as AreaSelectionAction),\n  }\n}\n\ntype AreaSelectionAction = {\n  type: \"AREA_SELECTION\",\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n} | {\n  type: \"RESET_AREA_SELECTION\",\n} | {\n  type: \"SET_POSITION_AREA_SELECTION\",\n  x: number,\n  y: number,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nfunction areaSelection(cardMaker: CardMaker, action: AreaSelectionAction): Area | null {\n  switch (action.type) {\n    case \"AREA_SELECTION\":\n      return {\n        x: action.x,\n        y: action.y,\n        width: action.width,\n        height: action.height,\n      }\n    case \"SET_POSITION_AREA_SELECTION\":\n      return {\n        ...cardMaker.viewModel.areaSelection as Area,\n        x: action.x,\n        y: action.y,\n      };\n    case \"RESET_AREA_SELECTION\": return null;\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default: return cardMaker.viewModel.areaSelection;\n  }\n}\n\ntype BgColorAction = {\n  type: \"INPUT_BACKGROUND_COLOR\",\n  color: string,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nfunction bgColor(cardMaker: CardMaker, action: BgColorAction): string | null {\n  switch (action.type) {\n    case \"INPUT_BACKGROUND_COLOR\": return action.color;\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default: return cardMaker.canvas.background.color;\n  }\n}\n\ntype BgImgAction = {\n  type: \"INPUT_BACKGROUND_IMG\",\n  width: number,\n  height: number,\n  src: string,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nfunction bgImg(cardMaker: CardMaker, action: BgImgAction): Size & { src: string } | null {\n  switch (action.type) {\n    case \"INPUT_BACKGROUND_IMG\":\n      return {\n        width: action.width,\n        height: action.height,\n        src: action.src,\n      };\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default: return null;\n  }\n}\n\ntype CanvasSizeAction = {\n  type: \"INPUT_CANVAS_SIZE\",\n  width: number,\n  height: number,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nfunction canvasSize(cardMaker: CardMaker, action: CanvasSizeAction): Size | null {\n  switch (action.type) {\n    case \"INPUT_CANVAS_SIZE\":\n      return {\n        width: action.width,\n        height: action.height,\n      };\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default:\n      return cardMaker.viewModel.canvasSize\n  }\n}\n\ntype FilterAction = {\n  type: \"INPUT_FILTER\",\n  color: string,\n  opacity: number,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nfunction filter(cardMaker: CardMaker, action: FilterAction): Filter | null {\n  switch (action.type) {\n    case \"INPUT_FILTER\":\n      return {\n        color: action.color,\n        opacity: action.opacity,\n      };\n    case \"UNDO\": return null;\n    case \"REDO\": return null;\n    default:\n      return cardMaker.viewModel.filter\n  }\n}\n\ntype TextAction = {\n  type: \"CLICK_ON_TEXT\",\n  id: string,\n} | {\n  type: \"RESET_SELECTED_BLOCK\",\n} | {\n  type: \"SET_SELECTED_BLOCK\",\n  id: string,\n} | {\n  type: \"SET_FONT_FAMILY_TEXT\",\n  id: string,\n  fontFamily: string,\n} | {\n  type: \"INPUT_COLOR_TEXT\",\n  color: string,\n} | {\n  type: \"INPUT_SIZE_TEXT\",\n  size: number,\n} | {\n  type: \"SET_BOLD_TEXT\",\n  id: string,\n  isBold: boolean,\n} | {\n  type: \"SET_ITALIC_TEXT\",\n  id: string,\n  isItalic: boolean,\n} | {\n  type: \"SET_UNDERLINE_TEXT\",\n  id: string,\n  isUnderline: boolean,\n} | {\n  type: \"UNDO\",\n} | {\n  type: \"REDO\"\n}\n\nfunction text(cardMaker: CardMaker, action: TextAction): ViewModelText {\n  const defState: ViewModelText = {\n    color: null,\n    size: null,\n    bold: null,\n    italic: null,\n    underline: null,\n    fontFamily: null,\n    tempColor: null,\n    tempSize: null,\n  }\n\n  let list: Block[]\n  switch (action.type) {\n\n    case \"CLICK_ON_TEXT\":\n      list = cardMaker.canvas.listBlock;\n      const { color, size, bold, italic, underline, fontFamily } = list[getIndexById(list, action.id)] as Text;\n      return { color, tempColor: null, tempSize: null, size, bold, italic, underline, fontFamily }\n\n    case \"SET_FONT_FAMILY_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        fontFamily: action.fontFamily\n      };\n\n    case \"INPUT_COLOR_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        tempColor: action.color\n      };\n\n    case \"INPUT_SIZE_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        tempSize: action.size\n      };\n\n    case \"SET_BOLD_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        bold: action.isBold\n      };\n\n    case \"SET_ITALIC_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        italic: action.isItalic\n      };\n\n    case \"SET_UNDERLINE_TEXT\":\n      return {\n        ...cardMaker.viewModel.text,\n        underline: action.isUnderline\n      };\n\n    case \"SET_SELECTED_BLOCK\": return defState;\n    case \"RESET_SELECTED_BLOCK\": return defState;\n\n    case \"UNDO\": return defState;\n\n    case \"REDO\": return defState;\n\n    default:\n      return cardMaker.viewModel.text\n  }\n}\n\nexport default viewModel;","import {\n  ActionHistory,\n  Background,\n  Filter,\n  Canvas,\n  CardMaker,\n  ViewModel,\n} from \"./types\";\n\nconst testBackground: Background = {\n  color: '#ffffff',\n  src: null,\n  width: null,\n  height: null,\n}\n\nconst testFilter: Filter = {\n  color: \"#ffffff\",\n  opacity: 0,\n}\n\nconst testCanvas: Canvas = {\n  width: 800,\n  height: 600,\n  filter: testFilter,\n  listBlock: [],\n  deleteArea: [],\n  background: testBackground,\n}\n\nconst testActionHistory: ActionHistory = {\n  listState:\n    [\n      testCanvas,\n    ],\n  currentIndex: 0,\n}\n\nconst viewModel: ViewModel = {\n  bgColor: null,\n  bgImg: null,\n  canvasSize: null,\n  filter: null,\n  text: {\n    color: null,\n    size: null,\n    bold: null,\n    italic: null,\n    underline: null,\n    fontFamily: null,\n    tempColor: null,\n    tempSize: null,\n  },\n  areaSelection: null,\n}\n\nexport const testCardMaker: CardMaker = {\n  canvas: testCanvas,\n  selectBlock: null,\n  history: testActionHistory,\n  viewModel: viewModel,\n}","import { createStore, applyMiddleware, Store, MiddlewareAPI, Dispatch, AnyAction } from \"redux\";\nimport { cardMakerReducer } from \"./reducers/CardMakerReducer\";\nimport { testCardMaker } from \"./initialState\";\nimport { Canvas, CardMaker } from \"./types\";\n\nimport { addHistory, afterChangeHistory } from \"./actionCreators/historyActionCreators\";\n\n\nconst exceptions: string[] = [\n  \"UNDO\",\n  \"REDO\",\n  \"ADD_HISTORY\",\n  \"AFTER_CHANGE_HISTORY\",\n  \"SET_SELECTED_BLOCK\",\n  \"SET_SIZE_TEXT\",\n  \"SET_POSITION_AREA_SELECTION\",\n  \"RESET_SELECTED_BLOCK\",\n  \"RESET_AREA_SELECTION\",\n  \"APPLY_FILE_PROJECT\",\n  \"NEW_CARD_MAKER\",\n  \"AREA_SELECTION\",\n  \"CLICK_ON_TEXT\",\n  \"INPUT_SIZE_TEXT\",\n  \"INPUT_COLOR_TEXT\",\n  \"INPUT_FILTER\",\n  \"INPUT_CANVAS_SIZE\",\n  \"INPUT_BACKGROUND_IMG\",\n  \"INPUT_BACKGROUND_COLOR\",\n];\n\nconst storeHistory = (store: MiddlewareAPI<Dispatch<AnyAction>, CardMaker>) =>\n  (next: AppDispatch) => (action: AnyAction) => {\n\n    const oldState: CardMaker = store.getState();\n    const result: AnyAction = next(action)\n    \n    if (!exceptions.includes(action.type)) {\n      const newState: CardMaker = store.getState();\n      if (JSON.stringify(oldState.canvas) !== JSON.stringify(newState.canvas)) {\n        console.log(\"сохранение истории\");\n        store.dispatch(addHistory(newState.canvas));\n      }\n    }\n    return result\n  }\n\nconst movingHistory = (store: MiddlewareAPI<Dispatch<AnyAction>, CardMaker>) =>\n  (next: AppDispatch) => (action: AnyAction) => {\n\n    const result: AnyAction = next(action)\n\n    if ([\"UNDO\", \"REDO\"].includes(action.type)) {\n      const currentIndex: number = store.getState().history.currentIndex;\n      const canvas: Canvas = store.getState().history.listState[currentIndex];\n      const newState: CardMaker = {\n        ...store.getState(),\n        canvas,\n      }\n      store.dispatch(afterChangeHistory(newState));\n    }\n    return result\n  }\n\nexport const store: Store<CardMaker> = createStore(\n  cardMakerReducer,\n  testCardMaker,\n  applyMiddleware(storeHistory, movingHistory)\n);\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type AppDispatch = typeof store.dispatch","import { CardMaker } from \"../types\";\nimport canvas, { CanvasAction } from \"./CanvasReducer\";\nimport selectBlock, { SelectBlockAction } from \"./SelectBlockReducer\";\nimport history, { HistoryAction } from \"./HistoryReducer\";\nimport viewModel, { ViewModelAction } from \"./ViewModelReducer\";\n\nexport type CardMakerReducerAction = {\n  type: \"AFTER_CHANGE_HISTORY\",\n  cardMaker: CardMaker,\n} | {\n  type: \"APPLY_FILE_PROJECT\",\n  project: CardMaker,\n} | CanvasAction | SelectBlockAction | HistoryAction | ViewModelAction;\n\nexport function cardMakerReducer(cardMaker = {} as CardMaker, action: CardMakerReducerAction): CardMaker {\n  switch (action.type) {\n\n    case \"AFTER_CHANGE_HISTORY\":\n      return action.cardMaker;\n\n    case \"APPLY_FILE_PROJECT\":\n      return action.project;\n\n    default:\n      return {\n        canvas: canvas(cardMaker.canvas, action as CanvasAction),\n        selectBlock: selectBlock(cardMaker.selectBlock, action as SelectBlockAction),\n        history: history(cardMaker.history, action as HistoryAction),\n        viewModel: viewModel(cardMaker, action as ViewModelAction)\n      }\n  }\n}\n\n","import { Canvas, CardMaker } from \"../types\";\n\nexport function addHistory(newCanvas: Canvas) {\n  return {\n    type: \"ADD_HISTORY\",\n    newCanvas: newCanvas,\n  }\n}\n\nexport function undo() {\n  return {\n    type: \"UNDO\",\n  }\n}\n\nexport function redo() {\n  return {\n    type: \"REDO\",\n  }\n}\n\nexport function afterChangeHistory(cardMaker: CardMaker) {\n  return {\n    type: \"AFTER_CHANGE_HISTORY\",\n    cardMaker: cardMaker,\n  }\n}","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\"\nimport { ReactElement, useEffect } from \"react\"\nimport { connect } from \"react-redux\"\nimport styles from \"./Modal.module.css\";\n\n// интерфейс для пропсов\ntype ModalProps = {\n  visible: boolean\n  title: string\n  content: ReactElement | string\n  footer: ReactElement | string\n  onClose: () => void\n}\n\nconst Modal = ({\n  visible = false,\n  title = \"\",\n  content = \"\",\n  footer = \"\",\n  onClose,\n}: ModalProps) => {\n\n  // c помощью useEffect цепляем обработчик к нажатию клавиш\n  useEffect(() => {\n    // создаем обработчик нажатия клавиши Esc\n    const onKeydown = ({ key }: KeyboardEvent) => {\n      switch (key) {\n        case \"Escape\":\n          onClose()\n          break\n      }\n    }\n    document.addEventListener(\"keydown\", onKeydown)\n    return () => document.removeEventListener(\"keydown\", onKeydown)\n  }, [onClose])\n\n  // если компонент невидим, то не отображаем его\n  if (!visible) {\n    return null;\n  }\n\n  // или возвращаем верстку модального окна\n  return (\n    <div className={styles.modal} onClick={onClose}>\n      <div className={styles.modalDialog} onClick={e => e.stopPropagation()}>\n        <div className={styles.modalHeader}>\n          <h3 className={styles.modalTitle}>{title}</h3>\n          <span className={styles.modalClose} onClick={onClose}>\n            <FontAwesomeIcon icon={faTimes} />\n          </span>\n        </div>\n        <div className={styles.modalBody}>\n          <div className={styles.modalContent}>{content}</div>\n        </div>\n        {footer && <div className={styles.modalFooter}>{footer}</div>}\n      </div>\n    </div>\n  )\n}\n\nexport default connect()(Modal)","import { faPiedPiperSquare } from \"@fortawesome/free-brands-svg-icons\"\r\nimport { connect } from \"react-redux\";\r\nimport { useState } from \"react\";\r\nimport { AppDispatch } from \"../../../../../store/store\";\r\nimport { newCardMaker } from \"../../../../../store/actionCreators/cardMakerActionCreators\";\r\nimport NavButton from \"../NavButton/NavButton\";\r\nimport Modal from \"../../../../modal/Modal\";\r\n\r\ntype NewProjectButtonProps = {\r\n  newCardMaker: () => void,\r\n}\r\n\r\nfunction NewProjectButton(props: NewProjectButtonProps) {\r\n  const [isModal, setModal] = useState(false)\r\n  const onClose = () => setModal(false)\r\n  const onAccept = () => {\r\n    props.newCardMaker();\r\n    onClose()\r\n  }\r\n\r\n  const content: JSX.Element =\r\n    <>\r\n      <p>Несохраненные изменения будут потеряны</p>\r\n      <p>Вы хотите продолжить ?</p>\r\n    </>\r\n\r\n  const footer: JSX.Element =\r\n    <>\r\n      <button onClick={onAccept}>Да</button>\r\n      <button onClick={onClose}>Нет</button>\r\n    </>\r\n\r\n\r\n  return (\r\n    <>\r\n      <NavButton label=\"Новый проект\" icon={faPiedPiperSquare} onClick={() => setModal(true)} />\r\n      <Modal\r\n        visible={isModal}\r\n        title=\"Новая открытка\"\r\n        content={content}\r\n        footer={footer}\r\n        onClose={onClose}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    newCardMaker: () => dispatch(newCardMaker()),\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(NewProjectButton);","import { RGB } from \"../store/types\";\n\n// конвертирование hex в rgb\nexport function convertColor(color: string): RGB {\n  if (color.substring(0, 1) === \"#\") {\n    color = color.substring(1);\n  }\n  const rgbColor: RGB = {\n    r: 255,\n    g: 255,\n    b: 255,\n  };\n  rgbColor.r = parseInt(color.substring(0, 2), 16);\n  rgbColor.g = parseInt(color.substring(2, 4), 16);\n  rgbColor.b = parseInt(color.substring(4), 16);\n  return rgbColor;\n}","import { Size } from \"../store/types\";\n\n// пропорциональный перерасчет ширины отностиельно новой высоты\nexport function calcWidthByHeight(initWidth: number, initHeight: number, baseHeight: number): number {\n  return initWidth * baseHeight / initHeight\n}\n\n// пропорциональный перерасчет высоты отностиельно новой ширины\nexport function calcHeightByWidth(initWidth: number, initHeight: number, baseWidth: number): number {\n  return initHeight * baseWidth / initWidth\n}\n\n// пропорциональный перерасчет размеров относительно новой ширины\nexport function calcSizeByWidth(initWidth: number, initHeight: number, baseWidth: number): Size {\n  const newHeight: number = (initHeight * baseWidth) / initWidth;\n  const newWidth: number = (initWidth * newHeight) / initHeight;\n  return {\n    width: newWidth,\n    height: newHeight,\n  }\n}\n\n// пропорциональный перерасчет размеров относительно новой высоты\nexport function calcSizeByHeight(initWidth: number, initHeight: number, baseHeight: number): Size {\n  const newWidth: number = calcWidthByHeight(initWidth, initHeight, baseHeight);\n  const newHeight: number = calcHeightByWidth(initWidth, initHeight, newWidth);\n  return {\n    width: newWidth,\n    height: newHeight,\n  }\n}\n\n// пропорциональный расчет размера изображения для полного заполнения холста\nexport function calcSizeImgByCanvas(imgW: number, imgH: number, canvasW: number, canvasH: number): Size {\n  let size = {\n    width: imgW,\n    height: imgH,\n  }\n  if (imgW < canvasW) {\n    size = calcSizeByWidth(imgW, imgH, canvasW);\n  }\n  if (imgH < canvasH) {\n    size = calcSizeByHeight(imgW, imgH, canvasH);\n  }\n  return size;\n}","\nimport { store } from \"../store/store\";\nimport { Block, BlockTypes, Background, Filter, Size, Text, Img, ArtObj, Canvas, RGB, Area } from \"../store/types\";\nimport { convertColor } from \"./color\";\nimport { calcSizeImgByCanvas } from \"./size\";\n\nexport async function exportInImage(type: string): Promise<void> {\n\n  const canvas: Canvas = store.getState().canvas;\n\n  const canvasWidth: number = canvas.width;\n  const canvasHeight: number = canvas.height;\n  const background: Background = canvas.background;\n  const filter: Filter = canvas.filter;\n  const elements: Block[] = canvas.listBlock;\n  const deleteAreas: Area[] = canvas.deleteArea;\n\n  const canvasElement: HTMLCanvasElement = document.createElement(\"canvas\");\n  canvasElement.width = canvasWidth;\n  canvasElement.height = canvasHeight;\n  const ctx: CanvasRenderingContext2D | null = canvasElement.getContext(\"2d\");\n\n  if (ctx) {\n    // отрисовка фона\n    if (background.src) {\n      const img: HTMLImageElement = new Image();\n      img.crossOrigin = \"anonymous\"\n      img.src = background.src;\n      await img.decode();\n      let size: Size = calcSizeImgByCanvas(img.width, img.height, canvasWidth, canvasHeight);\n      ctx.drawImage(img, 0, 0, size.width, size.height);\n    } else if (background.color) {\n      ctx.fillStyle = background.color;\n      ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n    }\n\n    // отрисовка блоков\n    for (let element of elements) {\n      await renderBlock(element, ctx);\n    }\n\n    // отрисовка фильтра\n    const color: RGB = convertColor(filter.color);\n    ctx.fillStyle = `rgba(${color.r}, ${color.g}, ${color.b}, ${filter.opacity})`;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    // отрисовка удаленных областей\n    ctx.fillStyle = \"#ffffff\";\n    deleteAreas.forEach(element => {\n      ctx.fillRect(element.x, element.y, element.width, element.height);\n    });\n\n    const dataURL: string = canvasElement.toDataURL(type);\n    const link: HTMLAnchorElement = document.createElement(\"a\");\n    link.href = dataURL;\n    link.download = \"new_card\";\n    link.click();\n  }\n}\n\nasync function renderBlock(element: Block, ctx: CanvasRenderingContext2D) {\n  switch (element.type) {\n    case BlockTypes.text: renderText(element, ctx);\n      break;\n    case BlockTypes.img:\n      await renderImg(element, ctx);\n      break;\n    case BlockTypes.artObj:\n      await renderArtObj(element, ctx);\n      break;\n  }\n}\n\n// формирование стилей для текстового блока\nfunction getStyle(text: Text) {\n  return {\n    x: text.x,\n    y: text.y,\n    color: text.color,\n    size: text.size,\n    weight: text.bold ? \"700\" : \"\",\n    italic: text.italic ? \"italic\" : \"\",\n    family: text.fontFamily,\n  };\n}\n\n\nfunction renderText(element: Text, ctx: CanvasRenderingContext2D) {\n      // внутрений отступ \n      const paddingText: number = 5;\n      // высота строки\n      const lineHeight: number = 1.2;\n      const style = getStyle(element);\n      const textBlock: HTMLDivElement = document.createElement(\"div\");\n      textBlock.innerHTML = element.text;\n      // сдивг строки\n      let shift = 0;\n      // отрисовка строк\n      for (let str of Array.from(textBlock.children) as HTMLDivElement[]) {\n\n        ctx.fillStyle = style.color;\n        ctx.font = `${style.italic} ${style.weight} ${style.size}px ${style.family}`;\n        ctx.fillText(str.innerText, element.x + paddingText, element.y + shift + style.size);\n        // подчеркивание\n        if (element.underline) {\n          const textWidth: number = ctx.measureText(str.innerText).width;\n          let chars = 0;\n          let underline = \"\";\n          while (str.innerText.length > chars) {\n            underline += \"__\";\n            chars++;\n          }\n          ctx.font = `700 ${style.size}px openSans`;\n          ctx.fillText(underline, element.x + paddingText, element.y + shift + style.size, textWidth);\n        }\n        shift += element.size * lineHeight;\n      }\n}\n\nasync function renderImg(element: Img, ctx: CanvasRenderingContext2D) {\n  const img: HTMLImageElement = new Image();\n  img.crossOrigin = \"anonymous\"\n  img.src = element.src;\n  await img.decode();\n  ctx.drawImage(img, element.x, element.y, element.width, element.height);\n}\n\nasync function renderArtObj(element: ArtObj, ctx: CanvasRenderingContext2D) {\n  const artObj: HTMLImageElement = new Image();\n  artObj.crossOrigin = \"anonymous\"\n  artObj.src = element.src;\n  await artObj.decode();\n  ctx.drawImage(artObj, element.x, element.y, element.width, element.height)\n}","import { faImage } from \"@fortawesome/free-solid-svg-icons\"\r\nimport { connect } from \"react-redux\";\r\nimport { useRef, useState } from \"react\";\r\nimport NavButton from \"../NavButton/NavButton\";\r\nimport Modal from \"../../../../modal/Modal\";\r\nimport { exportInImage } from \"../../../../../utils/exportInImage\";\r\n\r\nfunction ExportImgButton() {\r\n\r\n  const downloadImg = useRef<HTMLButtonElement>(null);\r\n\r\n  const [isModal, setModal] = useState(false)\r\n  const onClose = () => setModal(false)\r\n\r\n  const onAcceptJpg = () => {\r\n    exportInImage(\"image/jpeg\");\r\n    onClose();\r\n  }\r\n\r\n  const onAcceptPng = () => {\r\n    exportInImage(\"image/png\");\r\n    onClose();\r\n  }\r\n\r\n  const content: JSX.Element = <p>Выберите формат сохраняемого файла</p>\r\n\r\n  const footer: JSX.Element =\r\n    <>\r\n      <button onClick={onAcceptJpg}>jpg</button>\r\n      <button onClick={onAcceptPng}>png</button>\r\n      <button onClick={onClose}>Отмена</button>\r\n    </>\r\n\r\n\r\n  return (\r\n    <>\r\n      <NavButton label=\"Сохранить как jpg/png\" icon={faImage} onClick={() => setModal(true)} ref={downloadImg} />\r\n      <Modal\r\n        visible={isModal}\r\n        title=\"Сохранить как...\"\r\n        content={content}\r\n        footer={footer}\r\n        onClose={onClose}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default connect()(ExportImgButton);","import styles from \"./DropdownMenu.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { connect } from \"react-redux\";\n\ntype DropdownMenuProps = {\n  minWidth: number,\n  label: string,\n  icon: IconDefinition,\n  children: React.ReactElement[],\n}\nfunction DropdownMenu(props: DropdownMenuProps) {\n  return (\n    <div className={styles.dropdown}>\n      <button className={styles.dropbtn}>\n        <FontAwesomeIcon icon={props.icon} />\n        <span className={styles.dropdownText}>{props.label}</span>\n      </button>\n      <div className={styles.dropdownContent} style={{ minWidth: props.minWidth }}>\n        {props.children}\n      </div>\n    </div>\n  );\n}\n\nexport default connect()(DropdownMenu);\n","import styles from \"./PreviewTemplate.module.css\";\r\nimport { useRef, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { AppDispatch } from \"../../../../store/store\";\r\nimport Modal from \"../../../modal/Modal\";\r\nimport { CardMaker } from \"../../../../store/types\";\r\nimport { applyFileProject } from \"../../../../store/actionCreators/cardMakerActionCreators\";\r\n\r\ntype PreviewTemplateProps = {\r\n  name: string,\r\n  srcImg: string,\r\n  srcJson: string,\r\n  applyFileProject: (tepmlate: CardMaker) => void,\r\n}\r\n\r\nfunction PreviewTemplate(props: PreviewTemplateProps) {\r\n\r\n  const [isModal, setModal] = useState(false)\r\n  const onClose = () => setModal(false)\r\n  \r\n  const onAccept = async () => {\r\n    const response: Response = await fetch(props.srcJson);\r\n    props.applyFileProject(await response.json());\r\n    onClose()\r\n  }\r\n\r\n  const content: JSX.Element =\r\n    <>\r\n      <p>Несохраненные изменения будут потеряны</p>\r\n      <p>Вы хотите продолжить ?</p>\r\n    </>\r\n\r\n  const footer: JSX.Element =\r\n    <>\r\n      <button onClick={onAccept}>Да</button>\r\n      <button onClick={onClose}>Нет</button>\r\n    </>\r\n\r\n\r\n  const img = useRef<HTMLImageElement>(null);\r\n  return (\r\n    <>\r\n      <div className={styles.preview} onClick={() => setModal(true)}>\r\n        <img src={props.srcImg} alt=\"\" ref={img} className={styles.img} />\r\n        <p>{props.name}</p>\r\n      </div>\r\n      <Modal\r\n        visible={isModal}\r\n        title=\"Применение шаблона\"\r\n        content={content}\r\n        footer={footer}\r\n        onClose={onClose}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    applyFileProject: (template: CardMaker) => dispatch(applyFileProject(template)),\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(PreviewTemplate);","import styles from \"./Navbar.module.css\";\r\nimport { faClone, faUndo, faRedo, faFileExport, faFolderOpen } from \"@fortawesome/free-solid-svg-icons\"\r\nimport NavButton from \"./navButton/NavButton/NavButton\";\r\nimport NavFileButton from \"./navButton/NavFileButton/NavFileButton\";\r\nimport { ReactElement, useRef } from \"react\";\r\nimport { useImportFileProject } from \"./useImportFileProject\";\r\nimport { useStateHistory } from \"./useStateHistory\";\r\nimport { connect } from \"react-redux\";\r\nimport { undo, redo } from \"../../../store/actionCreators/historyActionCreators\";\r\nimport { applyFileProject } from \"../../../store/actionCreators/cardMakerActionCreators\";\r\nimport { CardMaker, templates } from \"../../../store/types\";\r\nimport { AppDispatch } from \"../../../store/store\";\r\nimport { useExportFileProject } from \"./useExportFileProject\";\r\nimport NewProjectButton from \"./navButton/NewProjectButton/NewProjectButton\";\r\nimport ExportImgButton from \"./navButton/ExportImgButton/ExportImgButton\";\r\nimport DropdownMenu from \"../../dropdownMenu/DropdownMenu\";\r\nimport PreviewTemplate from \"./previewTemplate/PreviewTemplate\";\r\n\r\ntype NavbarProps = {\r\n  undo: () => void,\r\n  redo: () => void,\r\n  applyFileProject: (file: CardMaker) => void,\r\n}\r\n\r\nfunction Navbar(props: NavbarProps) {\r\n  const buttonUndo = useRef<HTMLButtonElement>(null);\r\n  const buttonRedo = useRef<HTMLButtonElement>(null);\r\n  useStateHistory(\r\n    buttonUndo,\r\n    buttonRedo,\r\n    props.undo,\r\n    props.redo,\r\n  );\r\n\r\n  const inputFile = useRef<HTMLInputElement>(null);\r\n  const downloadFile = useRef<HTMLButtonElement>(null);\r\n\r\n  useImportFileProject(inputFile, props.applyFileProject);\r\n  useExportFileProject(downloadFile);\r\n\r\n\r\n  // формирование списка стикеров\r\n  const srcList: {name: string, json: string, preview: string}[] = Object.values(templates);\r\n  const previewList: ReactElement[] = [];\r\n  srcList.forEach((tmp, index) => {\r\n    previewList.push(<PreviewTemplate name={tmp.name} srcImg={tmp.preview} srcJson={tmp.json} key={index} />);\r\n  });\r\n\r\n\r\n  return (\r\n    <>\r\n      <nav className={styles.navbar}>\r\n        <NewProjectButton />\r\n        <NavFileButton label=\"Открыть проект\" icon={faFolderOpen} ref={inputFile} />\r\n        <NavButton label=\"Сохранить проект\" icon={faFileExport} ref={downloadFile} onClick={null} />\r\n        <ExportImgButton />\r\n        <div>\r\n          <DropdownMenu minWidth={450} label=\"Шаблоны\" icon={faClone}>\r\n            {previewList}\r\n          </DropdownMenu>\r\n        </div>\r\n\r\n        <NavButton label=\"\" icon={faUndo} ref={buttonUndo} onClick={null} />\r\n        <NavButton label=\"\" icon={faRedo} ref={buttonRedo} onClick={null} />\r\n      </nav>\r\n    </>\r\n  );\r\n}\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    undo: () => dispatch(undo()),\r\n    redo: () => dispatch(redo()),\r\n    applyFileProject: (file: CardMaker) => dispatch(applyFileProject(file)),\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(Navbar);\r\n","import { RefObject, useEffect } from \"react\";\r\nimport { verify } from \"../../../utils/permisions\";\r\n\r\nexport function useStateHistory(\r\n  buttonUndo: RefObject<HTMLButtonElement>,\r\n  buttonRedo: RefObject<HTMLButtonElement>,\r\n  undo: () => void,\r\n  redo: () => void,\r\n): void {\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    const btnUndo: HTMLButtonElement | null = buttonUndo.current;\r\n    const btnRedo: HTMLButtonElement | null = buttonRedo.current;\r\n\r\n    function handlerClickUndo(): void {\r\n      undo();\r\n    }\r\n  \r\n    function handlerClickRedo(): void {\r\n      redo();\r\n    }\r\n  \r\n    function handlerKeydown(event: KeyboardEvent): void {\r\n      if (event.code === \"KeyZ\" && (event.ctrlKey || event.metaKey)) {\r\n        undo();\r\n      }\r\n      if (event.code === \"KeyY\" && (event.ctrlKey || event.metaKey)) {\r\n        redo();\r\n      }\r\n    }\r\n    \r\n    \r\n    verify(btnUndo).addEventListener(\"click\", handlerClickUndo);\r\n    verify(btnRedo).addEventListener(\"click\", handlerClickRedo);\r\n    document.addEventListener(\"keydown\", handlerKeydown);\r\n    return () => {\r\n      if (btnUndo) btnUndo.removeEventListener(\"click\", handlerClickUndo);\r\n      if (btnRedo) btnRedo.removeEventListener(\"click\", handlerClickRedo);\r\n      document.removeEventListener(\"keydown\", handlerKeydown);\r\n    };\r\n  }, [buttonUndo, buttonRedo, undo, redo]);\r\n}","import { RefObject, useEffect } from \"react\";\r\nimport { store } from \"../../../store/store\";\r\nimport { CardMaker } from \"../../../store/types\";\r\nimport { verify } from \"../../../utils/permisions\";\r\n\r\nexport function useExportFileProject(downloadButton: RefObject<HTMLButtonElement>): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const button: HTMLButtonElement | null = downloadButton.current;\r\n\r\n    function handlerClickSaveToJson(): void {\r\n      const cardMaker: CardMaker = store.getState();\r\n      const json: string = JSON.stringify({\r\n        ...cardMaker,\r\n        selectBlock: null,\r\n        history: {\r\n          listState: [cardMaker.canvas],\r\n          currentIndex: 0,\r\n        }\r\n      });\r\n      const file: Blob = new Blob([json], { type: \"application/json\" });\r\n      const link: HTMLAnchorElement = document.createElement(\"a\");\r\n      link.href = URL.createObjectURL(file);\r\n      link.download = \"Новый проект.json\";\r\n      link.click();\r\n    }\r\n\r\n    \r\n    verify(button).addEventListener(\"click\", handlerClickSaveToJson);\r\n    return () => {\r\n      if (button) button.removeEventListener(\"click\", handlerClickSaveToJson);\r\n    };\r\n  }, [downloadButton]);\r\n}","import { getProjectFromFile } from \"../../../utils/files\";\r\nimport { RefObject, useEffect } from \"react\";\r\nimport { CardMaker } from \"../../../store/types\";\r\nimport { verify } from \"../../../utils/permisions\";\r\n\r\nexport function useImportFileProject(\r\n  inputFile: RefObject<HTMLInputElement>,\r\n  applyFileProject: (file: CardMaker) => void): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const input: HTMLInputElement | null = inputFile.current;\r\n\r\n    async function handlerChangeInputFile(): Promise<void> {\r\n\r\n      if (input) {\r\n        const files: FileList | null = input.files;\r\n        try {\r\n          if (files) {\r\n            applyFileProject(await getProjectFromFile(files[0]))\r\n          }\r\n        } catch {\r\n          alert(\"Ошибка при импорте проекта. Проверьте исходный фаил и повторите попытку\")\r\n        }\r\n        input.value = \"\";\r\n      }\r\n      \r\n    }\r\n\r\n\r\n    verify(input).addEventListener(\"change\", handlerChangeInputFile);\r\n    return () => {\r\n      if (input) input.removeEventListener(\"change\", handlerChangeInputFile);\r\n    };\r\n  }, [inputFile, applyFileProject]);\r\n}","import { connect } from \"react-redux\";\nimport styles from \"./Header.module.css\";\nimport Navbar from \"./navbar/Navbar\";\n\nfunction Header() {\n  return (\n    <header className={styles.header}>\n      <div className={styles.mainLabel}>Card Maker</div>\n      <Navbar />\n    </header >\n  );\n}\n\nexport default connect()(Header);\n","import { useEffect, RefObject } from \"react\";\nimport { store } from \"../../store/store\";\nimport { verify } from \"../../utils/permisions\";\n\nexport function useStateBlock(\n  blockId: string,\n  block: RefObject<HTMLElement>,\n  setSelectedBlock: (id: string) => void,\n  resetSelectedBlock: () => void,\n): void {\n\n  useEffect(() => {\n\n    const currentBlock: HTMLElement | null = block.current;\n\n    let mouseDownCurrentBlock: boolean = false;\n\n    function handleMousedownBlock(): void {\n      mouseDownCurrentBlock = true;\n      if (store.getState().selectBlock !== blockId) {\n        setTimeout(() => {\n          setSelectedBlock(blockId);\n        });\n      }\n    }\n\n    function handleClickDocument(event: Event): void {\n      const isDefPrev: boolean = event.defaultPrevented;\n      const isSelectedID: boolean = store.getState().selectBlock === blockId;\n      if (!isDefPrev && isSelectedID && (event.target !== currentBlock) && !mouseDownCurrentBlock) {\n        resetSelectedBlock();\n      }\n      mouseDownCurrentBlock = false;\n    }\n\n\n    document.addEventListener(\"click\", handleClickDocument);\n    verify(currentBlock).addEventListener(\"mousedown\", handleMousedownBlock);\n    return () => {\n      if (currentBlock) currentBlock.removeEventListener(\"mousedown\", handleMousedownBlock);\n      document.removeEventListener(\"click\", handleClickDocument);\n    };\n  }, [blockId, block, setSelectedBlock, resetSelectedBlock]);\n}","import { useEffect, RefObject } from \"react\";\r\nimport { Position } from \"../../store/types\";\r\nimport { verify } from \"../../utils/permisions\";\r\n\r\nexport function useDragAndDrop(\r\n  block: RefObject<HTMLElement>,\r\n  defPos: Position,\r\n  setPositionBlock: (x: number, y: number) => void\r\n): void {\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    const currentBlock: HTMLElement | null = block.current;\r\n\r\n    let startPos: Position;\r\n\r\n    function handleMousedown(event: MouseEvent): void {\r\n      startPos = {\r\n        x: event.pageX,\r\n        y: event.pageY,\r\n      };\r\n      document.addEventListener(\"mousemove\", handleMouseMove);\r\n      document.addEventListener(\"mouseup\", handleMouseUp);\r\n    }\r\n\r\n    let newPos: Position;\r\n\r\n    function handleMouseMove(event: MouseEvent): void {\r\n      if (!event.defaultPrevented) {\r\n        event.preventDefault();\r\n        const delta: Position = {\r\n          x: event.pageX - startPos.x,\r\n          y: event.pageY - startPos.y\r\n        }\r\n        newPos = {\r\n          x: defPos.x + delta.x,\r\n          y: defPos.y + delta.y\r\n        }\r\n        verify(currentBlock).style.left = `${newPos.x}px`;\r\n        verify(currentBlock).style.top = `${newPos.y}px`;\r\n      }\r\n    }\r\n\r\n    function handleMouseUp(): void {\r\n      if (newPos) {\r\n        setPositionBlock(newPos.x, newPos.y);\r\n      }\r\n      document.removeEventListener(\"mousemove\", handleMouseMove);\r\n      document.removeEventListener(\"mouseup\", handleMouseUp);\r\n    }\r\n\r\n\r\n    if (currentBlock) currentBlock.addEventListener(\"mousedown\", handleMousedown);\r\n    return () => {\r\n      if (currentBlock) currentBlock.removeEventListener(\"mousedown\", handleMousedown);\r\n    };\r\n  }, [block, defPos, setPositionBlock]);\r\n}","import { useEffect, RefObject } from \"react\";\nimport { Position, Size } from \"../../store/types\";\nimport { verify } from \"../../utils/permisions\";\nimport { calcHeightByWidth, calcWidthByHeight } from \"../../utils/size\";\n\nexport function useResize(\n  setSizeBlock: (width: number, height: number) => void,\n  setPositionBlock: (x: number, y: number) => void,\n  LT: RefObject<HTMLElement>,\n  RT: RefObject<HTMLElement>,\n  LB: RefObject<HTMLElement>,\n  RB: RefObject<HTMLElement>,\n  block: RefObject<HTMLElement>,\n  defPos: Position,\n  defSize: Size\n): void {\n\n\n  useEffect(() => {\n\n    const currentBlock: HTMLElement | null = block.current;\n    const pointLT: HTMLElement | null = LT.current;\n    const pointRT: HTMLElement | null = RT.current;\n    const pointLB: HTMLElement | null = LB.current;\n    const pointRB: HTMLElement | null = RB.current;\n\n    let startPos: Position;\n    let point: string;\n\n    function handleMousedown(event: MouseEvent): void {\n      event.preventDefault();\n      switch (event.target) {\n        case pointLT:\n          point = \"LT\";\n          break;\n        case pointRT:\n          point = \"RT\";\n          break;\n        case pointLB:\n          point = \"LB\";\n          break;\n        case pointRB:\n          point = \"RB\";\n          break;\n      }\n\n      startPos = {\n        x: event.pageX + (5 - event.offsetX),\n        y: event.pageY + (5 - event.offsetY)\n      };\n\n      document.addEventListener(\"mousemove\", handleMouseMove);\n      document.addEventListener(\"mouseup\", handleMouseUp);\n    }\n\n    let newWidth: number = defSize.width;\n    let newHeight: number = defSize.height;\n    let prevWidth: number = defSize.width;\n    let prevHeight: number = defSize.height;\n    let newPos: Position;\n\n    function handleMouseMove(event: MouseEvent): void {\n      event.preventDefault();\n      const delta: Position = {\n        x: event.pageX - startPos.x,\n        y: event.pageY - startPos.y,\n      }\n\n      // перемещение при изменении размеров\n      let moving: Position = { x: 0, y: 0 };\n      switch (point) {\n        case \"LT\":\n          [newWidth, newHeight] = calculateSize({ x: -delta.x, y: -delta.y }, prevWidth, prevHeight);\n          moving = { x: defSize.width - newWidth, y: defSize.height - newHeight };\n          break;\n        case \"RT\":\n          [newWidth, newHeight] = calculateSize({ x: delta.x, y: -delta.y }, prevWidth, prevHeight);\n          moving = { x: 0, y: defSize.height - newHeight };\n          break;\n        case \"LB\":\n          [newWidth, newHeight] = calculateSize({ x: -delta.x, y: delta.y }, prevWidth, prevHeight);\n          moving = { x: defSize.width - newWidth, y: 0 };\n          break;\n        case \"RB\":\n          [newWidth, newHeight] = calculateSize(delta, prevWidth, prevHeight);\n          break;\n      }\n\n      verify(currentBlock).style.width = `${newWidth}px`;\n      verify(currentBlock).style.height = `${newHeight}px`;\n\n      newPos = {\n        x: defPos.x + moving.x,\n        y: defPos.y + moving.y\n      }\n\n      verify(currentBlock).style.left = `${newPos.x}px`;\n      verify(currentBlock).style.top = `${newPos.y}px`;\n\n      prevWidth = newWidth;\n      prevHeight = newHeight;\n    }\n\n    function calculateSize(delta: Position, prevWidth: number, prevHeight: number) {\n      if ((delta.x / prevWidth) < (delta.y / prevHeight)) {\n        newHeight = defSize.height + delta.y;\n        newHeight = newHeight < 20 ? 20 : newHeight;\n        newWidth = calcWidthByHeight(prevWidth, prevHeight, newHeight);\n      } else {\n        newWidth = defSize.width + delta.x;\n        newWidth = newWidth < 20 ? 20 : newWidth;\n        newHeight = calcHeightByWidth(prevWidth, prevHeight, newWidth);\n      }\n      return [newWidth, newHeight];\n    }\n\n    function handleMouseUp(): void {\n      setSizeBlock(newWidth, newHeight);\n      if (newPos) setPositionBlock(newPos.x, newPos.y);\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n      document.removeEventListener(\"mouseup\", handleMouseUp);\n    }\n\n\n    verify(pointLT).addEventListener(\"mousedown\", handleMousedown);\n    verify(pointRT).addEventListener(\"mousedown\", handleMousedown);\n    verify(pointLB).addEventListener(\"mousedown\", handleMousedown);\n    verify(pointRB).addEventListener(\"mousedown\", handleMousedown);\n    return () => {\n      if (pointLT) pointLT.removeEventListener(\"mousedown\", handleMousedown);\n      if (pointRT) pointRT.removeEventListener(\"mousedown\", handleMousedown);\n      if (pointLB) pointLB.removeEventListener(\"mousedown\", handleMousedown);\n      if (pointRB) pointRB.removeEventListener(\"mousedown\", handleMousedown);\n    };\n  }, [setSizeBlock, setPositionBlock, LT, RT, LB, RB, block, defPos, defSize]);\n}","import { store } from \"../store\";\n\nexport function setSelectedBlock(id: string) {\n  return {\n    type: \"SET_SELECTED_BLOCK\",\n    id: id,\n  }\n}\n\nexport function resetSelectedBlock() {\n  return {\n    type: \"RESET_SELECTED_BLOCK\",\n  }\n}\n\nexport function setSizeBlock(width: number, height: number) {\n  return {\n    type: \"SET_SIZE_BLOCK\",\n    id: store.getState().selectBlock,\n    width: width,\n    height: height,\n  }\n}\n\nexport function deleteBlock() {\n  return {\n    type: \"DELETE_BLOCK\",\n    id: store.getState().selectBlock,\n  }\n}\n\nexport function setPositionBlock(x: number, y: number) {\n  return {\n    type: \"SET_POSITION_BLOCK\",\n    id: store.getState().selectBlock,\n    x: x,\n    y: y,\n  }\n}\n\nexport function shiftUpBlock() {\n  return {\n    type: \"SHIFT_UP_BLOCK\",\n    id: store.getState().selectBlock,\n  }\n}\n\nexport function shiftDownBlock() {\n  return {\n    type: \"SHIFT_DOWN_BLOCK\",\n    id: store.getState().selectBlock,\n  }\n}\n\nexport function clickOnText() {\n  return {\n    type: \"CLICK_ON_TEXT\",\n    id: store.getState().selectBlock,\n  }\n}\n","import styles from \"./Img.module.css\";\r\nimport { Img as ImgType } from \"../../../store/types\";\r\nimport { useRef } from \"react\";\r\nimport { useStateBlock } from \"../useStateBlock\";\r\nimport { useDragAndDrop } from \"../useDragAndDrop\";\r\nimport { useResize } from \"../useResize\";\r\nimport { connect } from \"react-redux\";\r\nimport { resetSelectedBlock, setPositionBlock, setSelectedBlock, setSizeBlock } from \"../../../store/actionCreators/blockActionCreators\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\n\r\ntype ImgProps = {\r\n  img: ImgType,\r\n  selectBlock: string | null,\r\n  setSizeBlock: (width: number, height: number) => void,\r\n  setPositionBlock: (x: number, y: number) => void,\r\n  setSelectedBlock: (id: string) => void,\r\n  resetSelectedBlock: () => void,\r\n}\r\n\r\nfunction Img(props: ImgProps) {\r\n  const img: ImgType = props.img;\r\n  let src: string = \"\";\r\n  if (img.src) {\r\n    src = img.src;\r\n  }\r\n  const imgStyle = getStyle(img);\r\n  const imgBlock = useRef<HTMLImageElement>(null);\r\n\r\n\r\n  const pointLT = useRef<HTMLDivElement>(null);\r\n  const pointRT = useRef<HTMLDivElement>(null);\r\n  const pointLB = useRef<HTMLDivElement>(null);\r\n  const pointRB = useRef<HTMLDivElement>(null);\r\n\r\n  useStateBlock(img.id, imgBlock, props.setSelectedBlock, props.resetSelectedBlock);\r\n  useDragAndDrop(imgBlock, { x: img.x, y: img.y }, props.setPositionBlock);\r\n  useResize(\r\n    props.setSizeBlock,\r\n    props.setPositionBlock,\r\n    pointLT,\r\n    pointRT,\r\n    pointLB,\r\n    pointRB,\r\n    imgBlock,\r\n    { x: img.x, y: img.y },\r\n    { width: img.width, height: img.height }\r\n  );\r\n\r\n  const select: string = img.id === props.selectBlock ? styles.selected : \"\";\r\n\r\n  return (\r\n    <div\r\n      className={`${styles.block} ${select}`}\r\n      style={imgStyle}\r\n      ref={imgBlock}\r\n      onDragStart={(e) => e.preventDefault() }\r\n    >\r\n      <div className={styles.pointTopLeft} ref={pointLT}></div>\r\n      <div className={styles.pointTopRight} ref={pointRT}></div>\r\n      <img src={src}\r\n        alt=\"\"\r\n        className={styles.img}\r\n      />\r\n      <div className={styles.pointBottomLeft} ref={pointLB}></div>\r\n      <div className={styles.pointBottomRight} ref={pointRB}></div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  selectBlock: state.selectBlock,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    setPositionBlock: (x: number, y: number) => dispatch(setPositionBlock(x, y)),\r\n    setSizeBlock: (width: number, height: number) => dispatch(setSizeBlock(width, height)),\r\n    setSelectedBlock: (id: string) => dispatch(setSelectedBlock(id)),\r\n    resetSelectedBlock: () => dispatch(resetSelectedBlock()),\r\n  }\r\n}\r\n\r\nfunction getStyle(img: ImgType) {\r\n  return {\r\n    width: img.width,\r\n    height: img.height,\r\n    left: img.x,\r\n    top: img.y,\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Img);\r\n","import { store } from \"../store\";\n\nexport function createTextBlock() {\n  return {\n    type: \"CREATE_TEXT_BLOCK\",\n    x: store.getState().canvas.width / 2,\n    y: store.getState().canvas.height / 2,\n  }\n}\n\nexport function setTextInTextBlock(text: string) {\n  return {\n    type: \"SET_TEXT_IN_TEXT_BLOCK\",\n    id: store.getState().selectBlock,\n    text: text,\n  }\n}\n\nexport function setFontFamilyText(fontFamily: string) {\n  return {\n    type: \"SET_FONT_FAMILY_TEXT\",\n    id: store.getState().selectBlock,\n    fontFamily: fontFamily,\n  }\n}\n\nexport function setBoldText(isBold: boolean) {\n  return {\n    type: \"SET_BOLD_TEXT\",\n    id: store.getState().selectBlock,\n    isBold: isBold,\n  }\n}\n\nexport function setItalicText(isItalic: boolean) {\n  return {\n    type: \"SET_ITALIC_TEXT\",\n    id: store.getState().selectBlock,\n    isItalic: isItalic,\n  }\n}\n\nexport function setUnderlineText(isUnderline: boolean) {\n  return {\n    type: \"SET_UNDERLINE_TEXT\",\n    id: store.getState().selectBlock,\n    isUnderline: isUnderline,\n  }\n}\n\nexport function setSizeText(size: number) {\n  return {\n    type: \"SET_SIZE_TEXT\",\n    id: store.getState().selectBlock,\n    size: size,\n  }\n}\n\nexport function inputColorText(color: string) {\n  return {\n    type: \"INPUT_COLOR_TEXT\",\n    color: color,\n  }\n}\n\nexport function inputSizeText(size: number) {\n  return {\n    type: \"INPUT_SIZE_TEXT\",\n    size: size,\n  }\n}\n\nexport function setColorText(color: string) {\n  return {\n    type: \"SET_COLOR_TEXT\",\n    id: store.getState().selectBlock,\n    color: color,\n  }\n}","import styles from \"./Text.module.css\";\r\nimport { Text as TextType } from \"../../../store/types\";\r\nimport { useRef } from \"react\";\r\nimport { useStateBlock } from \"../useStateBlock\";\r\nimport { useDragAndDrop } from \"../useDragAndDrop\";\r\nimport { connect } from \"react-redux\";\r\nimport { clickOnText, deleteBlock, resetSelectedBlock, setPositionBlock, setSelectedBlock } from \"../../../store/actionCreators/blockActionCreators\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport { useEditText } from \"./useEditText\";\r\nimport { setBoldText, setItalicText, setTextInTextBlock, setUnderlineText } from \"../../../store/actionCreators/textBlockActionCreators\";\r\n\r\ntype TextProps = {\r\n  text: TextType,\r\n  color: string | null,\r\n  size: number | null,\r\n  selectBlock: string | null,\r\n  setPositionBlock: (x: number, y: number) => void,\r\n  setSelectedBlock: (id: string) => void,\r\n  resetSelectedBlock: () => void,\r\n  setTextInTextBlock: (text: string) => void,\r\n  clickOnText: () => void,\r\n  deleteBlock: () => void,\r\n  setBoldText: (isBold: boolean) => void,\r\n  setItalicText: (isItalic: boolean) => void,\r\n  setUnderlineText: (isUnderline: boolean) => void,\r\n}\r\n\r\nfunction Text(props: TextProps) {\r\n  const text: TextType = props.text;\r\n\r\n  const textBlock = useRef<HTMLDivElement>(null);\r\n  useStateBlock(text.id, textBlock, props.setSelectedBlock, props.resetSelectedBlock);\r\n  useDragAndDrop(textBlock, { x: text.x, y: text.y }, props.setPositionBlock);\r\n\r\n  useEditText(\r\n    textBlock,\r\n    text.bold,\r\n    text.italic,\r\n    text.underline,\r\n    props.setTextInTextBlock,\r\n    props.clickOnText,\r\n    props.deleteBlock,\r\n    props.setBoldText,\r\n    props.setItalicText,\r\n    props.setUnderlineText,\r\n  );\r\n\r\n  const select: string = text.id === props.selectBlock ? styles.selected : \"\";\r\n  let textStyle = getStyle(text);\r\n  textStyle = {\r\n    ...textStyle,\r\n    color: props.color && select !== \"\" ? props.color : textStyle.color,\r\n    fontSize: props.size && select !== \"\" ? props.size : textStyle.fontSize,\r\n  }\r\n\r\n  return (\r\n    <div style={textStyle}\r\n      contentEditable={false}\r\n      suppressContentEditableWarning={true}\r\n      onDragStart={(e) => e.preventDefault()}\r\n      ref={textBlock}\r\n      className={`${styles.block} ${select}`}\r\n      dangerouslySetInnerHTML={{ __html: text.text }}\r\n    >\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getStyle(text: TextType) {\r\n  return {\r\n    left: text.x,\r\n    top: text.y,\r\n    color: text.color,\r\n    fontSize: text.size,\r\n    fontWeight: text.bold ? 700 : 400,\r\n    textDecoration: text.underline ? \"underline\" : \"none\",\r\n    fontStyle: text.italic ? \"italic\" : \"normal\",\r\n    fontFamily: text.fontFamily,\r\n  };\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  selectBlock: state.selectBlock,\r\n  color: state.viewModel.text.tempColor,\r\n  size: state.viewModel.text.tempSize,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    setPositionBlock: (x: number, y: number) => dispatch(setPositionBlock(x, y)),\r\n    setSelectedBlock: (id: string) => dispatch(setSelectedBlock(id)),\r\n    resetSelectedBlock: () => dispatch(resetSelectedBlock()),\r\n    setTextInTextBlock: (text: string) => dispatch(setTextInTextBlock(text)),\r\n    clickOnText: () => dispatch(clickOnText()),\r\n    deleteBlock: () => dispatch(deleteBlock()),\r\n    setBoldText: (isBold: boolean) => dispatch(setBoldText(isBold)),\r\n    setItalicText: (isItalic: boolean) => dispatch(setItalicText(isItalic)),\r\n    setUnderlineText: (isUnderline: boolean) => dispatch(setUnderlineText(isUnderline)),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Text);\r\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useEditText(\n  block: RefObject<HTMLDivElement>,\n  bold: boolean,\n  italic: boolean,\n  underline: boolean,\n  setTextInTextBlock: (text: string) => void,\n  clickOnText: () => void,\n  deleteBlock: () => void,\n  setBoldText: (isBold: boolean) => void,\n  setItalicText: (isItalic: boolean) => void,\n  setUnderlineText: (isUnderline: boolean) => void,\n) {\n\n  useEffect(() => {\n\n    const currentBlock: HTMLDivElement | null = block.current;\n\n    function handleClickBlock() {\n      setTimeout(() => {\n        clickOnText();\n      });\n    }\n\n    function handleDblclickBlock() {\n      verify(currentBlock).setAttribute(\"contenteditable\", \"true\")\n      verify(currentBlock).focus();\n    }\n\n    function handleBlur() {\n      if (currentBlock) {\n        currentBlock.setAttribute(\"contenteditable\", \"false\")\n        const content: string = currentBlock.innerHTML;\n        if (content === '<div><br></div>') {\n          deleteBlock();\n        } else {\n          setTextInTextBlock(currentBlock.innerHTML);\n        }\n      }\n    }\n\n    function handleMouseMove(event: Event) {\n      if (verify(currentBlock).getAttribute('contenteditable') === 'true') {\n        event.stopImmediatePropagation();\n      }\n    }\n\n    function handlerKeydown(event: KeyboardEvent): void {\n      if (event.code === 'Escape') {\n        if (verify(currentBlock).getAttribute('contenteditable') === 'true') {\n          verify(currentBlock).setAttribute(\"contenteditable\", \"false\")\n          setTextInTextBlock(verify(currentBlock).innerHTML)\n        }\n      }\n      if (event.code === 'Delete') {\n        event.preventDefault();\n        document.execCommand('forwardDelete');\n      }\n      if (event.code === 'KeyB' && (event.ctrlKey || event.metaKey)) {\n        setBoldText(!bold)\n      }\n      if (event.code === 'KeyI' && (event.ctrlKey || event.metaKey)) {\n        setItalicText(!italic)\n      }\n      if (event.code === 'KeyU' && (event.ctrlKey || event.metaKey)) {\n        setUnderlineText(!underline)\n      }\n    }\n\n    function handlerPaste(event: any) {\n      event.preventDefault();\n      const text: string = event.clipboardData.getData(\"text/plain\");\n      document.execCommand(\"insertHTML\", false, text);\n    }\n\n    function handlerInput() {\n      if (currentBlock) {\n        if (currentBlock.innerHTML[0] !== '<' || currentBlock.innerHTML === '<br>') {\n          currentBlock.innerHTML = `<div>${currentBlock.innerText}<br></div>`;\n          currentBlock.focus();\n        }\n      }\n    }\n\n\n    verify(currentBlock).addEventListener(\"mousedown\", handleClickBlock);\n    verify(currentBlock).addEventListener(\"dblclick\", handleDblclickBlock);\n    verify(currentBlock).addEventListener(\"blur\", handleBlur);\n    verify(currentBlock).addEventListener(\"keydown\", handlerKeydown);\n    verify(currentBlock).addEventListener(\"paste\", handlerPaste);\n    verify(currentBlock).addEventListener(\"input\", handlerInput);\n    document.addEventListener(\"mousemove\", handleMouseMove);\n    return () => {\n      if (currentBlock) {\n        currentBlock.removeEventListener(\"mousedown\", handleClickBlock);\n        currentBlock.removeEventListener(\"dblclick\", handleDblclickBlock);\n        currentBlock.addEventListener(\"blur\", handleBlur);\n        currentBlock.removeEventListener(\"keydown\", handlerKeydown);\n        currentBlock.removeEventListener(\"paste\", handlerPaste);\n        currentBlock.removeEventListener(\"input\", handlerInput);\n      }\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n    };\n  }, [\n    block, bold, italic, underline, setTextInTextBlock, clickOnText,\n    deleteBlock, setBoldText, setItalicText, setUnderlineText\n  ]);\n}","import styles from \"./ArtObj.module.css\";\r\nimport { ArtObj as ArtObjType } from \"../../../store/types\";\r\nimport { useRef } from \"react\";\r\nimport { useStateBlock } from \"../useStateBlock\";\r\nimport { useDragAndDrop } from \"../useDragAndDrop\";\r\nimport { useResize } from \"../useResize\";\r\nimport { resetSelectedBlock, setPositionBlock, setSelectedBlock, setSizeBlock } from \"../../../store/actionCreators/blockActionCreators\";\r\nimport { connect } from \"react-redux\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\n\r\ntype ArtObjProps = {\r\n  artObj: ArtObjType,\r\n  selectBlock: string | null,\r\n  setSizeBlock: (width: number, height: number) => void,\r\n  setPositionBlock: (x: number, y: number) => void,\r\n  setSelectedBlock: (id: string) => void,\r\n  resetSelectedBlock: () => void,\r\n}\r\n\r\nfunction ArtObj(props: ArtObjProps) {\r\n  const artObj: ArtObjType = props.artObj;\r\n  const artObjBlock = useRef<HTMLDivElement>(null);\r\n  const artObjStyle = getStyle(artObj);\r\n\r\n  const pointLT = useRef<HTMLDivElement>(null);\r\n  const pointRT = useRef<HTMLDivElement>(null);\r\n  const pointLB = useRef<HTMLDivElement>(null);\r\n  const pointRB = useRef<HTMLDivElement>(null);\r\n\r\n  useStateBlock(artObj.id, artObjBlock, props.setSelectedBlock, props.resetSelectedBlock);\r\n  useDragAndDrop(artObjBlock, { x: artObj.x, y: artObj.y }, props.setPositionBlock);\r\n  useResize(\r\n    props.setSizeBlock,\r\n    props.setPositionBlock,\r\n    pointLT,\r\n    pointRT,\r\n    pointLB,\r\n    pointRB,\r\n    artObjBlock,\r\n    { x: artObj.x, y: artObj.y },\r\n    { width: artObj.width, height: artObj.height }\r\n  );\r\n  \r\n  const select: string = artObj.id === props.selectBlock ? styles.selected : \"\";\r\n\r\n  return (\r\n    <div\r\n      className={`${styles.block} ${select}`}\r\n      style={artObjStyle}\r\n      ref={artObjBlock}\r\n      onDragStart={(e) => e.preventDefault() }\r\n    >\r\n      <div className={styles.pointTopLeft} ref={pointLT}></div>\r\n      <div className={styles.pointTopRight} ref={pointRT}></div>\r\n      <img src={artObj.src}\r\n        alt=\"\"\r\n        className={styles.img}\r\n      />\r\n      <div className={styles.pointBottomLeft} ref={pointLB}></div>\r\n      <div className={styles.pointBottomRight} ref={pointRB}></div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  selectBlock: state.selectBlock,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    setPositionBlock: (x: number, y: number) => dispatch(setPositionBlock(x, y)),\r\n    setSizeBlock: (width: number, height: number) => dispatch(setSizeBlock(width, height)),\r\n    setSelectedBlock: (id: string) => dispatch(setSelectedBlock(id)),\r\n    resetSelectedBlock: () => dispatch(resetSelectedBlock()),\r\n  }\r\n}\r\n\r\nfunction getStyle(artObj: ArtObjType) {\r\n  return {\r\n    width: artObj.width,\r\n    height: artObj.height,\r\n    left: artObj.x,\r\n    top: artObj.y,\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ArtObj);\r\n","import styles from \"./Filter.module.css\";\nimport { Canvas, Filter as FilterType } from \"../../../store/types\";\nimport { connect } from \"react-redux\";\nimport { RootState } from \"../../../store/store\";\n\ntype FilterProps = {\n  canvas: Canvas\n  filter: FilterType | null,\n}\n\nfunction Filter(props: FilterProps) {\n  const canvas: Canvas = props.canvas;\n\n  let color: string = \"\";\n  let opacity: number = 0;\n  if (props.filter) {\n    color = props.filter.color;\n    opacity = props.filter.opacity;\n  } else {\n    color = canvas.filter.color;\n    opacity = canvas.filter.opacity;\n  }\n\n  const filterStyle = {\n    background: color,\n    opacity: opacity,\n  };\n\n  return (\n    <div className={styles.filter} style={filterStyle} id=\"filter\"></div>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    canvas: state.canvas,\n    filter: state.viewModel.filter,\n  }\n};\n\nexport default connect(mapStateToProps)(Filter);","import styles from \"./DeleteArea.module.css\";\nimport { ReactElement } from \"react\";\nimport { Area } from \"../../../store/types\";\nimport { connect } from \"react-redux\";\nimport { RootState } from \"../../../store/store\";\n\ntype DeleteAreaProps = { deleteArea: Area[] }\n\nfunction DeleteArea(props: DeleteAreaProps) {\n\n  if (props.deleteArea === []) {\n    return null;\n  }\n\n  const listBlock: ReactElement[] = [];\n  props.deleteArea.forEach((block: Area, index: number) => {\n    const deleteAreaStyle = {\n      width: block.width,\n      height: block.height,\n      left: block.x,\n      top: block.y,\n    };\n\n    listBlock.push(\n      <div className={styles.deleteArea}\n        key={index}\n        style={deleteAreaStyle}>\n      </div>\n    );\n  });\n\n  return (\n    <>\n      {listBlock}\n    </>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    deleteArea: state.canvas.deleteArea,\n  }\n};\n\nexport default connect(mapStateToProps)(DeleteArea);\n\n\n\n","import { store } from \"../store\"\n\nexport function setCanvasSize(width: number, height: number) {\n  return {\n    type: \"SET_CANVAS_SIZE\",\n    width: width,\n    height: height,\n  }\n}\n\nexport function setFilter(color: string, opacity: number) {\n  return {\n    type: \"SET_FILTER\",\n    color: color,\n    opacity: opacity,\n  }\n}\n\nexport function setBackgroundColor(color: string) {\n  return {\n    type: \"SET_BACKGROUND_COLOR\",\n    color: color,\n  }\n}\n\nexport function setBackgroundImg(src: string, width: number, height: number) {\n  return {\n    type: \"SET_BACKGROUND_IMG\",\n    src: src,\n    width: width,\n    height: height,\n  }\n}\n\nexport function resetBackground() {\n  return {\n    type: \"RESET_BACKGROUND\",\n  }\n}\n\nexport function inputBackgroundColor(color: string) {\n  return {\n    type: \"INPUT_BACKGROUND_COLOR\",\n    color: color,\n  }\n}\n\nexport function inputBackgroundImg(src: string, width: number, height: number) {\n  return {\n    type: \"INPUT_BACKGROUND_IMG\",\n    src: src,\n    width: width,\n    height: height,\n  }\n}\n\nexport function inputCanvasSize(width: number, height: number) {\n  return {\n    type: \"INPUT_CANVAS_SIZE\",\n    width: width,\n    height: height,\n  }\n}\n\nexport function inputFilter(color: string, opacity: number) {\n  return {\n    type: \"INPUT_FILTER\",\n    color: color,\n    opacity: opacity,\n  }\n}\n\nexport function areaSelection(x: number, y: number, width: number, height: number) {\n  return {\n    type: \"AREA_SELECTION\",\n    x: x,\n    y: y,\n    width: width,\n    height: height,\n  }\n}\n\nexport function resetAreaSelection() {\n  return {\n    type: \"RESET_AREA_SELECTION\",\n  }\n}\n\nexport function setPositionAreaSelection(x: number, y: number) {\n  return {\n    type: \"SET_POSITION_AREA_SELECTION\",\n    x: x,\n    y: y,\n  }\n}\n\nexport function deleteAreaSelection() {\n  return {\n    type: \"DELETE_AREA_SELECTION\",\n    area: store.getState().viewModel.areaSelection,\n  }\n}\n","import styles from \"./AreaSelection.module.css\";\nimport { Area } from \"../../../store/types\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../store/store\";\nimport { useDragAndDrop } from \"../useDragAndDrop\";\nimport { areaSelection, resetAreaSelection, setPositionAreaSelection } from \"../../../store/actionCreators/canvasActionCreators\";\nimport { ForwardedRef, forwardRef, RefObject, useRef } from \"react\";\nimport { useAreaSelection } from \"./useAreaSelection\";\n\ntype AreaSelectionProps = {\n  area: Area | null,\n  areaSelection: (x: number, y: number, width: number, height: number) => void,\n  resetAreaSelection: () => void,\n  setPositionAreaSelection: (x: number, y: number) => void,\n}\n\nconst AreaSelection = forwardRef((props: AreaSelectionProps, ref: ForwardedRef<HTMLDivElement>) => {\n  const area = useRef<HTMLDivElement>(null);\n\n  useAreaSelection(ref as RefObject<HTMLDivElement>, area, props.areaSelection, props.resetAreaSelection);\n\n  useDragAndDrop(\n    area,\n    {\n      x: props.area ? props.area.x : 0,\n      y: props.area ? props.area.y : 0,\n    },\n    props.setPositionAreaSelection);\n\n  if (!props.area) {\n    return null;\n  }\n\n  const areaSelectionStyle = {\n    left: props.area.x,\n    top: props.area.y,\n    width: props.area.width - 2,\n    height: props.area.height - 2,\n  }\n\n  return (\n    <>\n      {props.area && <div className={styles.areaSelection} style={areaSelectionStyle} ref={area}></div>}\n    </>\n  );\n});\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    area: state.viewModel.areaSelection,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    areaSelection: (x: number, y: number, width: number, height: number) => dispatch(areaSelection(x, y, width, height)),\n    resetAreaSelection: () => dispatch(resetAreaSelection()),\n    setPositionAreaSelection: (x: number, y: number) => dispatch(setPositionAreaSelection(x, y)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, { forwardRef: true })(AreaSelection);\n\n\n\n","import { useEffect, RefObject } from \"react\";\nimport { Position } from \"../../../store/types\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useAreaSelection(\n  canvas: RefObject<HTMLDivElement>,\n  area: RefObject<HTMLDivElement>,\n  areaSelection: (x: number, y: number, width: number, height: number) => void,\n  resetAreaSelection: () => void): void {\n\n  useEffect(() => {\n\n    const field: HTMLDivElement | null = canvas.current;\n    const selectArea: HTMLDivElement | null = area.current;\n\n    let startPos: Position;\n    let startOffsetPos: Position;\n\n    const div: HTMLDivElement = document.createElement(\"div\");\n    div.style.position = \"absolute\";\n    div.style.zIndex = \"1\";\n    div.style.pointerEvents = \"none\";\n\n    function handleMousedown(event: MouseEvent): void {\n      \n      if (!event.defaultPrevented && event.target === field) {\n        startPos = {\n          x: event.pageX,\n          y: event.pageY,\n        };\n\n        startOffsetPos = {\n          x: event.offsetX,\n          y: event.offsetY,\n        };\n\n        document.addEventListener(\"mousemove\", handleMouseMove);\n        document.addEventListener(\"mouseup\", handleMouseUp);\n\n        div.style.border = \"1px dashed red\";\n        div.style.width = \"0px\";\n        div.style.height = \"0px\";\n\n        div.style.left = `${event.offsetX}px`;\n        div.style.top = `${event.offsetY}px`;\n        if (field) field.appendChild(div);\n      }\n    }\n\n\n    function handleMouseMove(event: MouseEvent): void {\n\n      if (!event.defaultPrevented) {\n\n        const delta: Position = {\n          x: Math.abs(event.pageX - startPos.x),\n          y: Math.abs(event.pageY - startPos.y)\n        }\n\n        let moving: Position = { x: 0, y: 0 };\n\n        if (startPos.x >= event.pageX && startPos.y >= event.pageY) { // левый верхний\n          moving = { x: -delta.x, y: -delta.y };\n        } else if (startPos.x <= event.pageX && startPos.y >= event.pageY) { // правый верхний\n          moving = { x: 0, y: -delta.y };\n        } else if (startPos.x >= event.pageX && startPos.y <= event.pageY) { // левый нижний\n          moving = { x: -delta.x, y: 0 };\n        }\n\n        div.style.width = `${delta.x}px`;\n        div.style.height = `${delta.y}px`;\n\n        div.style.left = `${startOffsetPos.x + moving.x}px`;\n        div.style.top = `${startOffsetPos.y + moving.y}px`;\n      }\n    }\n\n    function handleMouseUp(): void {\n\n      if (div.offsetWidth > 2 && div.offsetHeight > 2) {\n        areaSelection(div.offsetLeft, div.offsetTop, div.offsetWidth, div.offsetHeight);\n      }\n      div.remove();\n\n      document.removeEventListener(\"mousemove\", handleMouseMove);\n      document.removeEventListener(\"mouseup\", handleMouseUp);\n\n    }\n\n    function handleMousedownDocument(event: Event): void {\n      if (!event.defaultPrevented && area.current) {\n        event.preventDefault();\n        if (area.current !== event.target) {\n          resetAreaSelection();\n        }\n      }\n    }\n\n    function handleMousedownArea(event: MouseEvent) {\n      event.preventDefault();\n    }\n\n    \n    verify(field).addEventListener(\"mousedown\", handleMousedown);\n    if (selectArea) selectArea.addEventListener(\"mousedown\", handleMousedownArea);\n    document.addEventListener(\"mousedown\", handleMousedownDocument);\n    return () => {\n      if (field) field.removeEventListener(\"mousedown\", handleMousedown);\n      if (selectArea) selectArea.removeEventListener(\"mousedown\", handleMousedownArea);\n      document.removeEventListener(\"mousedown\", handleMousedownDocument);\n    };\n  }, [canvas, area, areaSelection, resetAreaSelection]);\n}","import styles from \"./Canvas.module.css\";\r\nimport { ReactElement, useRef } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport Img from \"./img/Img\"\r\nimport Text from \"./text/Text\"\r\nimport ArtObj from \"./artObj/ArtObj\"\r\nimport Filter from \"./filter/Filter\"\r\nimport DeleteArea from \"./deleteArea/DeleteArea\"\r\nimport AreaSelection from \"./areaSelection/AreaSelection\";\r\nimport { Block, Canvas as CanvasType, Size, BlockTypes } from \"../../store/types\";\r\nimport { AppDispatch, RootState } from \"../../store/store\";\r\nimport { areaSelection, resetAreaSelection } from \"../../store/actionCreators/canvasActionCreators\";\r\nimport { calcSizeImgByCanvas } from \"../../utils/size\";\r\n\r\ntype CanvasProps = {\r\n  canvas: CanvasType,\r\n  bgColor: string | null,\r\n  canvasSize: Size | null,\r\n  areaSelection: (x: number, y: number, width: number, height: number) => void,\r\n  resetAreaSelection: () => void,\r\n}\r\n\r\nfunction Canvas(props: CanvasProps) {\r\n  const canvasStyle = getStyle(props.canvas, props.bgColor, props.canvasSize);\r\n  const listBlock: ReactElement[] = getListBlock(props.canvas.listBlock);\r\n  const canvas = useRef<HTMLDivElement>(null);\r\n\r\n  return (\r\n    <div id=\"canvas\" className={styles.canvas} style={canvasStyle} ref={canvas}>\r\n      <AreaSelection ref={canvas} />\r\n      <DeleteArea />\r\n      <Filter />\r\n      {listBlock}\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => {\r\n  return {\r\n    canvas: state.canvas,\r\n    area: state.viewModel.areaSelection,\r\n    bgColor: state.viewModel.bgColor,\r\n    canvasSize: state.viewModel.canvasSize,\r\n  }\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    areaSelection: (x: number, y: number, width: number, height: number) => dispatch(areaSelection(x, y, width, height)),\r\n    resetAreaSelection: () => dispatch(resetAreaSelection()),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Canvas);\r\n\r\n\r\nfunction getListBlock(listBlock: Block[]): ReactElement[] {\r\n  let newListBlock: ReactElement[] = [];\r\n  listBlock.forEach((block: Block) => {\r\n    switch (block.type) {\r\n      case BlockTypes.text: newListBlock.push(<Text text={block} key={block.id} />);\r\n        break;\r\n      case BlockTypes.img: newListBlock.push(<Img img={block} key={block.id} />);\r\n        break;\r\n      case BlockTypes.artObj: newListBlock.push(<ArtObj artObj={block} key={block.id} />);\r\n        break;\r\n    }\r\n  });\r\n  return newListBlock;\r\n}\r\n\r\nfunction getStyle(canvas: CanvasType, bgColor: string | null, canvasSize: Size | null) {\r\n  let backgroundColor: string = \"#fff\";\r\n  let backgroundImage: string = \"\";\r\n\r\n  if (bgColor) {\r\n    backgroundColor = bgColor;\r\n  } else {\r\n    if (canvas.background.color) {\r\n      backgroundColor = canvas.background.color;\r\n    } else if (canvas.background.src) {\r\n      backgroundImage = `url(${canvas.background.src})`;\r\n    }\r\n  }\r\n\r\n  let width: number = 0;\r\n  let height: number = 0;\r\n  if (canvasSize) {\r\n    width = canvasSize.width;\r\n    height = canvasSize.height;\r\n  } else {\r\n    width = canvas.width;\r\n    height = canvas.height;\r\n  }\r\n\r\n  const bgWidth: number | null = canvas.background.width;\r\n  const bgHeight: number | null = canvas.background.height;\r\n\r\n  let bgSize: Size | null = null;\r\n\r\n  if (bgWidth && bgHeight) {\r\n    bgSize = calcSizeImgByCanvas(bgWidth, bgHeight, width, height);\r\n  }\r\n\r\n  return {\r\n    width: width,\r\n    height: height,\r\n    backgroundColor: backgroundColor,\r\n    backgroundImage: backgroundImage,\r\n    backgroundSize: bgSize ? `${bgSize.width}px ${bgSize.height}px` : '',\r\n  };\r\n}","import styles from \"./ButtonEditText.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { useEditStateText } from \"./useEditStateText\";\n\ntype ButtonEditTextProps = {\n  icon: IconDefinition,\n  enabled: boolean | null,\n  modifyFn: ((enabled: boolean) => void) | (() => void),\n  param: boolean,\n}\n\nfunction ButtonEditText(props: ButtonEditTextProps) {\n  const button = useRef<HTMLButtonElement>(null);\n\n  useEditStateText(button, props.enabled, props.modifyFn, props.param);\n\n  return (\n    <button className={`${styles.button} ${props.enabled ? styles.active : \"\"}`} ref={button}>\n      <FontAwesomeIcon icon={props.icon} />\n    </button>\n  );\n};\n\n\nexport default connect()(ButtonEditText);","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useEditStateText(\n  button: RefObject<HTMLButtonElement>,\n  enabled: boolean | null,\n  modifyFn: (() => void) | ((enabled: boolean) => void),\n  param: boolean) {\n\n  useEffect(() => {\n\n    const btn: HTMLButtonElement | null = button.current;\n\n    function handleClickButton(event: Event) {\n      if (enabled !== null) {\n        modifyFn(!enabled)\n        event.preventDefault();\n      } else if (!param) {\n        modifyFn(true)\n      }\n    }\n\n\n    verify(btn).addEventListener(\"click\", handleClickButton);\n    return () => {\n      if (btn) btn.removeEventListener(\"click\", handleClickButton);\n    };\n  }, [button, modifyFn, enabled, param]);\n}","import styles from \"./ColorPicker.module.css\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport { inputColorText, setColorText } from \"../../../../store/actionCreators/textBlockActionCreators\";\nimport { useEditColorText } from \"./useEditColorText\";\n\ntype ColorPickerProps = {\n  setColorText: (color: string) => void,\n  inputColorText: (color: string) => void,\n  color: string | null\n}\n\nfunction ColorPicker(props: ColorPickerProps) {\n  const colorPicker = useRef<HTMLInputElement>(null);\n  useEditColorText(props.color, colorPicker, props.setColorText, props.inputColorText);\n  return (\n    <input type=\"color\"\n      ref={colorPicker}\n      className={styles.input}\n    />\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    color: state.viewModel.text.color,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    setColorText: (color: string) => dispatch(setColorText(color)),\n    inputColorText: (color: string) => dispatch(inputColorText(color)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColorPicker);\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useEditColorText(\n  color: string | null,\n  colorPicker: RefObject<HTMLInputElement>,\n  setColorText: (color: string) => void,\n  inputColorText: (color: string) => void) {\n\n  useEffect(() => {\n\n    const inputColor: HTMLInputElement | null = colorPicker.current;\n\n    verify(inputColor).value = color ? color : \"#000000\";\n\n    function handleInput(event: Event) {\n      const target = event.target as HTMLOptionElement;\n      inputColorText(target.value);\n    }\n  \n    function handleChange(event: Event) {\n      const target = event.target as HTMLOptionElement;\n      setColorText(target.value);\n    }\n    \n    function handleClick(event: Event) {\n      event.stopImmediatePropagation();\n    }\n\n\n    verify(inputColor).addEventListener(\"input\", handleInput);\n    verify(inputColor).addEventListener(\"change\", handleChange);\n    verify(inputColor).addEventListener(\"click\", handleClick);\n    return () => {\n      if (inputColor) {\n        inputColor.removeEventListener(\"input\", handleInput);\n        inputColor.removeEventListener(\"change\", handleChange);\n        inputColor.removeEventListener(\"click\", handleClick);\n      }\n    };\n  }, [color, colorPicker, setColorText, inputColorText]);\n}","import styles from \"./InputNumber.module.css\";\nimport { connect } from \"react-redux\";\nimport { useEditFontSize } from \"./useEditFontSize\";\nimport { useRef } from \"react\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport { inputSizeText, setSizeText } from \"../../../../store/actionCreators/textBlockActionCreators\";\n\ntype InputNumberProps = {\n  size: number | null,\n  tempSize: number | null,\n  setSizeText: (size: number) => void,\n  inputSizeText: (size: number) => void,\n}\n\nfunction InputNumber(props: InputNumberProps) {\n  const inputNumber = useRef<HTMLInputElement>(null);\n  useEditFontSize(props.size, inputNumber, props.setSizeText, props.inputSizeText);\n\n  return (\n    <input type=\"number\"\n      ref={inputNumber}\n      className={styles.input__number}\n      min={10}\n      max={150}\n      step={1}\n    />\n  )\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    size: state.viewModel.text.size,\n    tempSize: state.viewModel.text.tempSize,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    setSizeText: (size: number) => dispatch(setSizeText(size)),\n    inputSizeText: (size: number) => dispatch(inputSizeText(size))\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(InputNumber);\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useEditFontSize(\n  size: number | null,\n  input: RefObject<HTMLInputElement>,\n  setSizeText: (size: number) => void,\n  inputSizeText: (size: number) => void) {\n\n  useEffect(() => {\n\n    const defSize: number = 10;\n\n    const fieldSize: HTMLInputElement | null = input.current;\n\n    verify(fieldSize).value = size ? String(size) : `${defSize}`;\n\n    function handleInput(event: Event) {\n      const target = event.target as HTMLOptionElement;\n      if (Number(target.value) > defSize) {\n        inputSizeText(Number(target.value));\n      } else {\n        inputSizeText(defSize);\n      }\n    }\n\n    function handleBlur(event: Event) {\n      const target = event.target as HTMLOptionElement;\n      if (Number(target.value) > defSize) {\n        setSizeText(Number(target.value));\n      } else {\n        setSizeText(defSize);\n      }\n    }\n\n    function handleClick(event: Event) {\n      event.preventDefault();\n    }\n\n\n    verify(fieldSize).addEventListener(\"input\", handleInput);\n    verify(fieldSize).addEventListener(\"blur\", handleBlur);\n    verify(fieldSize).addEventListener(\"click\", handleClick);\n    return () => {\n      if (fieldSize) {\n        fieldSize.removeEventListener(\"input\", handleInput);\n        fieldSize.removeEventListener(\"blur\", handleBlur);\n        fieldSize.removeEventListener(\"click\", handleClick);\n      }\n    };\n  }, [size, input, setSizeText, inputSizeText]);\n}","import { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport styles from \"./SelectFontFamily.module.css\";\nimport { useRef } from \"react\";\nimport { useSelectFont } from \"./useSelectFont\";\nimport { setFontFamilyText } from \"../../../../store/actionCreators/textBlockActionCreators\";\n\ntype SelectFontFamilyProps = {\n  fontFamily: string | null,\n  setFontFamilyText: (fontFamily: string) => void,\n}\n\nfunction SelectFontFamily(props: SelectFontFamilyProps) {\n  const select = useRef<HTMLSelectElement>(null);\n\n  useSelectFont(select, props.setFontFamilyText);\n\n  const listParameters: {value: string, class: string}[] = [\n    { value: \"Roboto Slab\", class: styles.robotoSlab },\n    { value: \"Fantazyor\", class: styles.fantazyor },\n    { value: \"Piroucyrillic\", class: styles.piroucyrillic },\n    { value: \"Phenomena\", class: styles.phenomena },\n    { value: \"Sunday\", class: styles.sunday },\n    { value: \"Kurale\", class: styles.kurale },\n    { value: \"Sensei\", class: styles.sensei },\n    { value: \"Borsok\", class: styles.borsok },\n    { value: \"Summer\", class: styles.summer },\n    { value: \"Underdog\", class: styles.underdog },\n    { value: \"Montserrat\", class: styles.montserrat },\n    { value: \"OpenSans\", class: styles.openSans },\n    { value: \"Comfortaa\", class: styles.comfortaa },\n    { value: \"Rubik\", class: styles.rubik },\n    { value: \"Marta\", class: styles.marta },\n  ]\n\n  let fontFamilies: JSX.Element[] = listParameters.map((element, index) => {\n    return <option key={index} className={element.class} value={element.value}>{element.value}</option>\n  })\n\n  let currentStyle: string = fontFamilies[0].props.className;\n\n  fontFamilies = fontFamilies.map((element: JSX.Element) => {\n    if (element.props.value === props.fontFamily) {\n      currentStyle = element.props.className;\n      return {\n        ...element,\n        props: {\n          ...element.props,\n          selected: true\n        }\n      }\n    } else {\n      return element\n    }\n  });\n\n  return (\n    <select name=\"\" id=\"\" className={`${styles.select} ${currentStyle}`} ref={select}>\n      {fontFamilies}\n    </select>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    fontFamily: state.viewModel.text.fontFamily\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    setFontFamilyText: (fontFamily: string) => dispatch(setFontFamilyText(fontFamily)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SelectFontFamily);","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useSelectFont(\n  select: RefObject<HTMLSelectElement>,\n  setFontFamilyText: (fontFamily: string) => void) {\n\n  useEffect(() => {\n\n    const selectFontFamily: HTMLSelectElement | null = select.current;\n    \n    function handleClick(event: Event) {\n      event.preventDefault();\n    }\n\n    function handleChange(event: Event) {\n      const target = event.target as HTMLOptionElement;\n      setFontFamilyText(target.value);\n    }\n\n    \n    verify(selectFontFamily).addEventListener(\"click\", handleClick);\n    verify(selectFontFamily).addEventListener(\"change\", handleChange);\n    return () => {\n      if (selectFontFamily) {\n        selectFontFamily.removeEventListener(\"click\", handleClick);\n        selectFontFamily.removeEventListener(\"change\", handleChange);\n      }\n    };\n  }, [select, setFontFamilyText]);\n}","import styles from \"./ToolbarText.module.css\";\nimport { faBold, faItalic, faUnderline, faFont } from \"@fortawesome/free-solid-svg-icons\"\nimport { connect } from \"react-redux\";\nimport { AppDispatch, RootState } from \"../../../store/store\";\nimport {\n  createTextBlock,\n  setBoldText,\n  setItalicText,\n  setUnderlineText\n} from \"../../../store/actionCreators/textBlockActionCreators\";\nimport ButtonEditText from \"./buttonEditText/ButtonEditText\";\nimport ColorPicker from \"./colorPicker/ColorPicker\";\nimport InputNumber from \"./inputNumber/InputNumber\";\nimport SelectFontFamily from \"./selectFontFamily/SelectFontFamily\";\n\n\ntype ToolbarTextProps = {\n  createTextBlock: () => void,\n  setBoldText: (isBold: boolean) => void,\n  setItalicText: (isItalic: boolean) => void,\n  setUnderlineText: (isUnderline: boolean) => void,\n  bold: boolean | null,\n  italic: boolean | null,\n  underline: boolean | null,\n}\n\nfunction ToolbarText(props: ToolbarTextProps) {\n  return (\n    <div className={styles.toolbar}>\n\n      <div className={styles.toolbar__row}>\n        <SelectFontFamily />\n        <ButtonEditText icon={faFont} enabled={null} modifyFn={props.createTextBlock} param={false} />\n      </div>\n\n      <div className={styles.toolbar__row}>\n        <InputNumber />\n\n        <ButtonEditText icon={faBold} enabled={props.bold} modifyFn={props.setBoldText} param={true} />\n        <ButtonEditText icon={faItalic} enabled={props.italic} modifyFn={props.setItalicText} param={true} />\n        <ButtonEditText icon={faUnderline} enabled={props.underline} modifyFn={props.setUnderlineText} param={true} />\n        <div className={styles.colorPickerBox}>\n          <ColorPicker />\n        </div>\n      </div>\n\n    </div>\n  );\n}\n\nconst mapStateToProps = (state: RootState) => {\n  return {\n    bold: state.viewModel.text.bold,\n    italic: state.viewModel.text.italic,\n    underline: state.viewModel.text.underline,\n  }\n};\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createTextBlock: () => dispatch(createTextBlock()),\n    setBoldText: (isBold: boolean) => dispatch(setBoldText(isBold)),\n    setItalicText: (isItalic: boolean) => dispatch(setItalicText(isItalic)),\n    setUnderlineText: (isUnderline: boolean) => dispatch(setUnderlineText(isUnderline)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarText);\n","import styles from \"./AddImgButtonFile.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\n\ntype NavButtonProps = {\n  label: string,\n  icon: IconDefinition,\n}\n\nconst AddImgButton = forwardRef((props: NavButtonProps, ref: ForwardedRef<HTMLInputElement>) => (\n  <button className={styles.button}>\n    <label htmlFor=\"input-file-img\" className={styles.icon}>\n      <FontAwesomeIcon icon={props.icon} />\n    </label>\n    <input\n      className={styles.inputFile}\n      type=\"file\"\n      accept=\".png,.jpg,.jfif,.jpe,.jpeg\"\n      ref={ref}\n      id=\"input-file-img\"\n    />\n    <label className={styles.buttonText}\n      htmlFor=\"input-file-img\">\n      {props.label}\n    </label>\n  </button>\n));\n\nexport default connect(null, null, null, { forwardRef: true })(AddImgButton);","import styles from \"./PreviewArtObj.module.css\";\nimport { useCreateArtObj } from \"./useCreateArtObj\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../../store/store\";\nimport { createArtObjBlock } from \"../../../../store/actionCreators/artObjBlockActionCreators\";\n\ntype PreviewArtObjProps = {\n  src: string,\n  createArtObjBlock: (src: string) => void,\n}\n\nfunction PreviewArtObj(props: PreviewArtObjProps) {\n\n  const img = useRef<HTMLImageElement>(null);\n  useCreateArtObj(img, props.src, props.createArtObjBlock);\n  return (\n    <img src={props.src} alt=\"\" ref={img} className={styles.sticker} />\n  );\n}\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createArtObjBlock: (src: string) => dispatch(createArtObjBlock(src)),\n  }\n}\n\nexport default connect(null, mapDispatchToProps)(PreviewArtObj);","import { store } from \"../store\";\n\nexport function createArtObjBlock(src: string) {\n  return {\n    type: \"CREATE_ART_OBJ_BLOCK\",\n    src: src,\n    x: (store.getState().canvas.width / 2) - 75,\n    y: (store.getState().canvas.height / 2) - 75,\n  }\n}\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../../utils/permisions\";\n\nexport function useCreateArtObj(\n  artObj: RefObject<HTMLElement>,\n  src: string,\n  createArtObjBlock: (src: string) => void) {\n\n  useEffect(() => {\n\n    const artObjPreview: HTMLElement | null = artObj.current;\n\n    function handleClickArtObj() {\n      createArtObjBlock(src);\n    }\n\n\n    verify(artObjPreview).addEventListener(\"click\", handleClickArtObj);\n    return () => {\n      if (artObjPreview) artObjPreview.removeEventListener(\"click\", handleClickArtObj);\n    };\n  }, [artObj, src, createArtObjBlock]);\n}","import { store } from \"../store\"\nexport function createImgBlock(src: string, width: number, height: number) {\n  return {\n    type: \"CREATE_IMG_BLOCK\",\n    src: src,\n    width: width,\n    height: height,\n    x: (store.getState().canvas.width / 2) - (width / 2),\n    y: (store.getState().canvas.height / 2) - (height / 2),\n  }\n}","import { Dispatch, RefObject, SetStateAction, useEffect } from \"react\"\n\nexport function useGetPhotoAPI(\n  buttonSearch: RefObject<HTMLButtonElement>,\n  buttonNext: RefObject<HTMLButtonElement>,\n  buttonBack: RefObject<HTMLButtonElement>,\n  input: RefObject<HTMLInputElement>,\n  loadingIndicator: RefObject<HTMLDivElement>,\n  information: RefObject<HTMLDivElement>,\n  setImages: (value: string[]) => void,\n  next: string | null,\n  back: string | null,\n  setNext: Dispatch<SetStateAction<null>>,\n  setBack: Dispatch<SetStateAction<null>>\n): void {\n\n\n  useEffect(() => {\n\n    const btnSearch: HTMLButtonElement | null = buttonSearch.current\n    const btnNext: HTMLButtonElement | null = buttonNext.current\n    const btnBack: HTMLButtonElement | null = buttonBack.current\n\n    if (next && buttonNext.current) {\n      buttonNext.current.style.visibility = \"visible\";\n    } else if (buttonNext.current) {\n      buttonNext.current.style.visibility = \"hidden\";\n    }\n\n    if (back && buttonBack.current) {\n      buttonBack.current.style.visibility = \"visible\";\n    } else if (buttonBack.current) {\n      buttonBack.current.style.visibility = \"hidden\";\n    }\n\n    async function handlerClickSearch() {\n      if (input.current) {\n        if (loadingIndicator.current) {\n          loadingIndicator.current.style.display = \"block\";\n        }\n        try {\n          const result = await search(input.current.value);\n          renderImg(result.photos);\n          if (result.next_page) {\n            setNext(result.next_page);\n          } else if (next) {\n            setNext(null);\n          }\n          if (back) {\n            setBack(null);\n          }\n          if (result.photos.length > 0 && information.current) {\n            information.current.innerText = \"\";\n          }\n          if (result.photos.length === 0 && information.current) {\n            throw new Error();\n          }\n        } catch {\n          if (information.current) {\n            information.current.innerText = \"По данному запросу ничего не найдено\";\n          }\n        }\n        if (loadingIndicator.current) {\n          loadingIndicator.current.style.display = \"none\";\n        }\n      }\n    }\n\n    async function handlerClickLink(event: Event) {\n      const link: string | null = event.target === buttonNext.current ? next : back;\n      if (input.current) {\n        if (loadingIndicator.current) {\n          loadingIndicator.current.style.display = \"block\";\n        }\n        try {\n          const result = await search(input.current.value, link);\n          if (loadingIndicator.current) {\n            loadingIndicator.current.style.display = \"none\";\n          }\n          renderImg(result.photos);\n          if (result.next_page) {\n            setNext(result.next_page);\n          } else if (next) {\n            setNext(null);\n          }\n          if (result.prev_page) {\n            setBack(result.prev_page);\n          } else if (back) {\n            setBack(null);\n          }\n        } catch {\n          if (information.current) {\n            information.current.innerText = \"Ссылка недействительна\";\n          }\n        }\n      }\n    }\n\n    function renderImg(photos: any[]) {\n      const arr: string[] = [];\n      for (let item of photos) {\n        arr.push(item.src.large);\n      }\n      setImages(arr);\n    }\n\n\n    if (btnSearch) btnSearch.addEventListener(\"click\", handlerClickSearch);\n    if (btnNext) btnNext.addEventListener(\"click\", handlerClickLink);\n    if (btnBack) btnBack.addEventListener(\"click\", handlerClickLink);\n    return () => {\n      if (btnSearch) btnSearch.removeEventListener(\"click\", handlerClickSearch)\n      if (btnNext) btnNext.removeEventListener(\"click\", handlerClickLink)\n      if (btnBack) btnBack.removeEventListener(\"click\", handlerClickLink)\n    }\n  });\n}\n\n\nasync function search(query: string, src: string | null = null) {\n  if (query.split(' ').join('') !== \"\") {\n    let response: Response = await fetch(src ? src : 'https://api.pexels.com/v1/search?per_page=20&locale=ru-RU&query=' + query, {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"User-Agent\": \"Pexels/JavaScript\",\n        // \"Authorization\": '563492ad6f91700001000001cf263b7519584f7fa301d119d96b629c',\n        // \"Authorization\": '563492ad6f917000010000019c0b3566c70e42328eb3340748668ddf',\n        // \"Authorization\": '563492ad6f917000010000010b6c64ee2ba847d1bc2d064fd821c6a5',\n        \"Authorization\": '563492ad6f91700001000001cbbc3b7fe6c14a5faa262d8d356ad945',\n      },\n    });\n    return await response.json();\n  }\n\n}","import { RefObject, useRef } from \"react\";\nimport { connect } from \"react-redux\";\n\ntype ImgProps = {\n  src: string,\n  baseSrc: string,\n  useImg: (img: RefObject<HTMLImageElement>, url: string, setModal: (value: boolean) => void) => void,\n  setModal: (value: boolean) => void,\n}\n\nfunction Img(props: ImgProps) {\n  const img = useRef<HTMLImageElement>(null);\n  props.useImg(img, props.baseSrc, props.setModal);\n  return (\n    <img key={props.src} src={props.src} width={375} loading=\"lazy\" ref={img} alt=\"\" />\n  );\n}\n\nexport default connect()(Img);","import { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport styles from \"./LoadingIndicator.module.css\";\n\nconst LoadingIndicator = forwardRef((props: {}, ref: ForwardedRef<HTMLDivElement>) => {\n  return (\n    <div className={styles.cssloadSpinBox} ref={ref}></div>\n  )\n});\n\nexport default connect(null, null, null, { forwardRef: true })(LoadingIndicator);","import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\"\nimport { RefObject, useEffect, useRef, useState } from \"react\"\nimport { connect } from \"react-redux\"\nimport styles from \"./ModalSearchImg.module.css\";\nimport { useGetPhotoAPI } from \"./useGetPhotoAPI\";\nimport Img from \"./Img\";\nimport LoadingIndicator from \"./loadingIndicator/LoadingIndicator\";\n\n// интерфейс для пропсов\ntype ModalSearchImgProps = {\n  visible: boolean,\n  setModal: (value: boolean) => void,\n  useImg: (img: RefObject<HTMLImageElement>, url: string, setModal: (value: boolean)=> void) => void,\n  onClose: () => void,\n}\n\nconst ModalSearchImg = ({\n  visible = false,\n  setModal,\n  useImg,\n  onClose,\n}: ModalSearchImgProps) => {\n\n  // c помощью useEffect цепляем обработчик к нажатию клавиш\n  useEffect(() => {\n    // создаем обработчик нажатия клавиши Esc\n    const onKeydown = ({ key }: KeyboardEvent) => {\n      switch (key) {\n        case \"Escape\":\n          onClose()\n          break\n      }\n    }\n    document.addEventListener(\"keydown\", onKeydown)\n    return () => document.removeEventListener(\"keydown\", onKeydown)\n  }, [onClose])\n\n  const buttonSearch = useRef<HTMLButtonElement>(null);\n  const buttonNext = useRef<HTMLButtonElement>(null);\n  const buttonBack = useRef<HTMLButtonElement>(null);\n  const input = useRef<HTMLInputElement>(null);\n  const loadingIndicator = useRef<HTMLDivElement>(null);\n  const information = useRef<HTMLDivElement>(null);\n\n\n\n  const [images, setImages] = useState([] as string[]);\n  const [next, setNext] = useState(null);\n  const [back, setBack] = useState(null);\n\n  useGetPhotoAPI(\n    buttonSearch,\n    buttonNext,\n    buttonBack,\n    input,\n    loadingIndicator,\n    information,\n    setImages,\n    next,\n    back,\n    setNext,\n    setBack\n  );\n\n  \n  useEffect(() => {\n    if (!visible) {\n      setImages([]);\n      setNext(null);\n      setBack(null);\n    }\n  }, [visible]);\n\n  // если компонент невидим, то не отображаем его\n  if (!visible) {\n    return null;\n  }\n  const images1 = [...images];\n  const images2 = images1.splice(images1.length / 2)\n\n  const onCloseModal = () => {\n    onClose();\n    setImages([]);\n    setNext(null);\n    setBack(null);\n  }\n\n  // или возвращаем верстку модального окна\n  return (\n    <div className={styles.modal} onClick={onCloseModal}>\n      <div className={styles.modalDialog} onClick={e => e.stopPropagation()}>\n        <div className={styles.modalHeader}>\n          <h3 className={styles.modalTitle}>Поиск фотографий</h3>\n          <span className={styles.modalClose} onClick={onCloseModal}>\n            <FontAwesomeIcon icon={faTimes} />\n          </span>\n        </div>\n\n        <div className={styles.modalHeader}>\n          <div className={styles.searchBox}>\n            <input type=\"text\" ref={input} />\n            <button ref={buttonSearch}>Поиск</button>\n            <LoadingIndicator ref={loadingIndicator} />\n          </div>\n          <div className={styles.navBox}>\n            <button ref={buttonBack}>Назад</button>\n            <button ref={buttonNext}>Вперед</button>\n          </div>\n\n        </div>\n\n        <div className={styles.modalBody}>\n          <div className={styles.modalContent}>\n            <div className={styles.information} ref={information}>Введите поисковой запрос</div>\n            <div style={{ display: \"inline-block\" }}>\n              {images1.map((src: string) => <Img key={src} setModal={setModal}\n                useImg={useImg}\n                src={src}\n                baseSrc={src} />)}\n            </div>\n            <div style={{ display: \"inline-block\" }}>\n              {images2.map((src: string) => <Img key={src} setModal={setModal}\n                useImg={useImg}\n                src={src}\n                baseSrc={src} />)}\n            </div>\n          </div>\n\n        </div>\n        <div className={styles.modalFooter}></div>\n      </div>\n    </div>\n  )\n}\n\nexport default connect()(ModalSearchImg)","import { RefObject, useEffect } from \"react\";\nimport { createImgBlock } from \"../../../../store/actionCreators/imgBlockActionCreators\";\nimport { store } from \"../../../../store/store\";\n\nexport function useCreateImgByUrl(\n  img: RefObject<HTMLImageElement>,\n  url: string,\n  setModal: (value: boolean) => void,\n) {\n  useEffect(() => {\n    const image: HTMLImageElement | null = img.current;\n    async function handlerClick() {\n      const newImage: HTMLImageElement = new Image();\n      newImage.src = url;\n      await newImage.decode();\n      store.dispatch(createImgBlock(newImage.src, newImage.width, newImage.height));\n      setModal(false);\n    }\n\n    if (image) image.addEventListener(\"click\", handlerClick);\n    return () => {\n      if (image) image.removeEventListener(\"click\", handlerClick)\n    }\n  }, [img, url, setModal]);\n}","import styles from \"./AddImgByUrlButton.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../../store/store\";\nimport { createImgBlock } from \"../../../../store/actionCreators/imgBlockActionCreators\";\nimport ModalSearchImg from \"../../modalSearchImg/ModalSearchImg\";\nimport { useCreateImgByUrl } from \"./useCreateImgByUrl\";\n\ntype NavButtonProps = {\n  label: string,\n  icon: IconDefinition,\n  createImgBlock: (src: string, width: number, height: number) => void,\n}\n\nconst AddImgByUrlButton = forwardRef((props: NavButtonProps, ref: ForwardedRef<HTMLButtonElement>) => {\n  const [isModal, setModal] = useState(false);\n  const onClose = () => setModal(false);\n\n  return (\n    <>\n      <button\n        onClick={() => setModal(true)}\n        ref={ref}\n        className={styles.button}>\n        <FontAwesomeIcon icon={props.icon} />\n        <span className={styles.buttonText}>{props.label}</span>\n      </button>\n      <ModalSearchImg visible={isModal} onClose={onClose} setModal={setModal} useImg={useCreateImgByUrl} />\n    </>\n  );\n});\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createImgBlock: (src: string, width: number, height: number) => dispatch(createImgBlock(src, width, height)),\n  }\n}\n\nexport default connect(null, mapDispatchToProps, null, { forwardRef: true })(AddImgByUrlButton);","import styles from \"./ToolbarImg.module.css\";\nimport { faDownload, faGlobe, faStickyNote } from \"@fortawesome/free-solid-svg-icons\"\nimport DropdownMenu from \"../../dropdownMenu/DropdownMenu\";\nimport AddImgButtonFile from \"./addImgButtonFile/AddImgButtonFile\";\nimport PreviewArtObj from \"./previewArtObj/PreviewArtObj\";\nimport { SetOfArtObject } from \"../../../store/types\";\nimport { useCreateImg } from \"./useCreateImg\";\nimport { ReactElement } from \"react\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../store/store\";\nimport { createImgBlock } from \"../../../store/actionCreators/imgBlockActionCreators\";\nimport AddImgByUrlButton from \"./addImgByUrlButton/AddImgByUrlButton\";\n\ntype ToolbarImgProps = {\n  createImgBlock: (src: string, width: number, height: number) => void,\n}\n\nfunction ToolbarImg(props: ToolbarImgProps) {\n\n  // формирование списка стикеров\n  const srcList: SetOfArtObject[] = Object.values(SetOfArtObject);\n  const imgList: ReactElement[] = [];\n  srcList.forEach((src, index) => {\n    imgList.push(<PreviewArtObj src={src} key={index} />);\n  });\n\n  const inputFile = useRef<HTMLInputElement>(null);\n\n  useCreateImg(inputFile, props.createImgBlock);\n\n  return (\n    <div className={styles.toolbar}>\n      <div className={styles.button_box}>\n        <AddImgButtonFile label=\"C компьютера\" icon={faDownload} ref={inputFile} />\n\n        <AddImgByUrlButton label=\"Из Pixels\" icon={faGlobe} />\n\n        <DropdownMenu minWidth={200} label=\"Стикеры\" icon={faStickyNote}>\n          {imgList}\n        </DropdownMenu>\n      </div>\n    </div>\n  );\n}\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    createImgBlock: (src: string, width: number, height: number) => dispatch(createImgBlock(src, width, height)),\n  }\n}\n\nexport default connect(null, mapDispatchToProps)(ToolbarImg);","import { RefObject, useEffect } from \"react\";\nimport { getImgInformationFromFile } from \"../../../utils/files\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useCreateImg(\n  inputFile: RefObject<HTMLInputElement>,\n  createImgBlock: (src: string, width: number, height: number) => void) {\n\n  useEffect(() => {\n\n    const input = inputFile.current;\n\n    async function handlerChangeInput(): Promise<void> {\n\n      if (input) {\n        const files: FileList | null = input.files;\n        try {\n          if (files) {\n            const img: HTMLImageElement = await getImgInformationFromFile(files[0]);\n            createImgBlock(img.src, img.width, img.height);\n          }\n        } catch {\n          alert(\"Ошибка при импорте изображения. Проверьте исходный файл и повторите попытку\");\n        }\n        input.value = \"\";\n      }\n    }\n\n\n    verify(input).addEventListener(\"change\", handlerChangeInput);\n    return () => {\n      if (input) input.removeEventListener(\"change\", handlerChangeInput);\n    };\n  }, [inputFile, createImgBlock]);\n}","import styles from \"./ColorPicker.module.css\";\nimport { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\n\nconst ColorPicker = forwardRef((props: {}, ref: ForwardedRef<HTMLInputElement>) => (\n  <input type=\"color\"\n    ref={ref}\n    className={styles.input__color}\n  />\n));\n\nexport default connect(null, null, null, { forwardRef: true })(ColorPicker);\n","import styles from \"./ToolbarFilter.module.css\";\r\nimport ColorPicker from \"../colorPicker/ColorPicker\";\r\nimport { useRef } from \"react\";\r\nimport { useStateFilter } from \"./useStateFilter\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport { inputFilter, setFilter } from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { connect } from \"react-redux\";\r\nimport { Filter } from \"../../../store/types\";\r\n\r\ntype ToolbarFilterProps = {\r\n  inputFilter: (color: string, opacity: number) => void,\r\n  setFilter: (color: string, opacity: number) => void,\r\n  filter: Filter,\r\n}\r\n\r\nfunction ToolbarFilter(props: ToolbarFilterProps) {\r\n  const inputColor = useRef<HTMLInputElement>(null);\r\n  const inputRange = useRef<HTMLInputElement>(null);\r\n  useStateFilter(\r\n    inputColor,\r\n    inputRange,\r\n    props.inputFilter,\r\n    props.setFilter,\r\n    props.filter\r\n  );\r\n  return (\r\n    <>\r\n      <div className={styles.toolbar}>\r\n        <div className={styles.row}>\r\n          <label className={styles.label}>Цвет фильтра:</label>\r\n          <ColorPicker ref={inputColor} />\r\n        </div>\r\n        <input type=\"range\" min=\"0\" max=\"0.5\" step=\"0.025\" className={styles.inputRange} ref={inputRange} />\r\n      </div>\r\n\r\n    </>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  filter: state.canvas.filter,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    inputFilter: (color: string, opacity: number) => dispatch(inputFilter(color, opacity)),\r\n    setFilter: (color: string, opacity: number) => dispatch(setFilter(color, opacity)),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarFilter);\r\n","import { Filter } from \"../../../store/types\";\nimport { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useStateFilter(\n  inputColor: RefObject<HTMLInputElement>,\n  inputRange: RefObject<HTMLInputElement>,\n  inputFilter: (color: string, opacity: number) => void,\n  setFilter: (color: string, opacity: number) => void,\n  filter: Filter): void {\n\n  useEffect(() => {\n\n    const fieldColor: HTMLInputElement | null = inputColor.current;\n    const fieldRange: HTMLInputElement | null = inputRange.current;\n\n    verify(fieldColor).value = filter.color;\n    verify(fieldRange).value = String(filter.opacity);\n\n    function handleInputFilter(): void {\n      if (fieldRange && fieldColor) {\n        const color: string = fieldColor.value;\n        const opacity: number = Number(fieldRange.value);\n        inputFilter(color, opacity);\n      }\n    }\n\n    function handleChangeFilter(): void {\n      if (fieldRange && fieldColor) {\n        const opacity: number = Number(fieldRange.value);\n        const color: string = fieldColor.value;\n        setFilter(color, opacity);\n      }\n    }\n\n    verify(fieldColor).addEventListener(\"input\", handleInputFilter);\n    verify(fieldColor).addEventListener(\"change\", handleChangeFilter);\n    verify(fieldRange).addEventListener(\"input\", handleInputFilter);\n    verify(fieldRange).addEventListener(\"change\", handleChangeFilter);\n    return () => {\n      if (fieldColor) {\n        fieldColor.removeEventListener(\"input\", handleInputFilter);\n        fieldColor.removeEventListener(\"change\", handleChangeFilter);\n      }\n      if (fieldRange) {\n        fieldRange.removeEventListener(\"input\", handleInputFilter);\n        fieldRange.removeEventListener(\"change\", handleChangeFilter);\n      }\n    };\n  }, [inputColor, inputRange, inputFilter, setFilter, filter]);\n}","import styles from \"./FileImgButton.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { useRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport Modal from \"../../../modal/Modal\";\nimport { useBackgroungImg } from \"../useBackgroungImg\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport {\n  inputBackgroundImg,\n  setBackgroundImg,\n  setCanvasSize\n} from \"../../../../store/actionCreators/canvasActionCreators\";\nimport { ViewModelBgImg } from \"../../../../store/types\";\n\ntype NavButtonProps = {\n  label: string,\n  icon: IconDefinition,\n  inputBackgroundImg: (src: string, width: number, height: number) => void,\n  setBackgroundImg: (src: string, width: number, height: number) => void,\n  setCanvasSize: (width: number, height: number) => void,\n  viewModelBgImg: ViewModelBgImg | null,\n}\n\nfunction AddImgButton(props: NavButtonProps) {\n\n  const inputFile = useRef<HTMLInputElement>(null);\n\n  const [isModal, setModal] = useState(false);\n  const onClose = () => setModal(false);\n\n  useBackgroungImg(inputFile, props.setBackgroundImg, props.inputBackgroundImg, setModal);\n\n  const bg: ViewModelBgImg = props.viewModelBgImg ?? {\n    width: 0,\n    height: 0,\n    src: \"\",\n  }\n\n  const onAcceptStretch = () => {\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    props.setCanvasSize(bg.width, bg.height);\n    onClose();\n  }\n  const onAcceptCrop = () => {\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    onClose();\n  }\n\n  const content: JSX.Element = <p>Исходное изображение больше размера холста</p>;\n\n  const footer: JSX.Element =\n    <>\n      <button onClick={onAcceptStretch}>Растянуть холст</button>\n      <button onClick={onAcceptCrop}>Обрезать изображение</button>\n      <button onClick={onClose}>Отмена</button>\n    </>\n\n  return (\n    <>\n      <Modal\n        visible={isModal}\n        title=\"Выберите действие\"\n        content={content}\n        footer={footer}\n        onClose={onClose}\n      />\n      <button className={styles.button}>\n        <label htmlFor=\"input-file-bg-img\" className={styles.icon}>\n          <FontAwesomeIcon icon={props.icon} />\n        </label>\n        <input\n          className={styles.inputFile}\n          type=\"file\"\n          accept=\".png,.jpg,.jfif,.jpe,.jpeg\"\n          id=\"input-file-bg-img\"\n          ref={inputFile}\n        />\n        <label className={styles.buttonText}\n          htmlFor=\"input-file-bg-img\">\n          {props.label}\n        </label>\n      </button>\n    </>\n  );\n};\n\nconst mapStateToProps = (state: RootState) => ({\n  viewModelBgImg: state.viewModel.bgImg,\n})\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    inputBackgroundImg: (src: string, width: number, height: number) => dispatch(inputBackgroundImg(src, width, height,)),\n    setBackgroundImg: (src: string, width: number, height: number) => dispatch(setBackgroundImg(src, width, height)),\n    setCanvasSize: (width: number, height: number) => dispatch(setCanvasSize(width, height)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddImgButton);","import { RefObject, useEffect } from \"react\";\r\nimport { getImgInformationFromFile } from \"../../../utils/files\";\r\nimport { verify } from \"../../../utils/permisions\";\r\nimport { store } from \"../../../store/store\";\r\nimport { Size } from \"../../../store/types\";\r\n\r\nexport function useBackgroungImg(\r\n  inputFile: RefObject<HTMLInputElement>,\r\n  setBackgroundImg: (src: string, width: number, height: number) => void,\r\n  inputBackgroundImg: (src: string, width: number, height: number) => void,\r\n  setModal: (state: boolean) => void\r\n) {\r\n\r\n  useEffect(() => {\r\n\r\n    const canvasSize: Size = {\r\n      width: store.getState().canvas.width,\r\n      height: store.getState().canvas.height,\r\n    };\r\n\r\n    const input: HTMLInputElement | null = inputFile.current;\r\n    async function handlerChange(): Promise<void> {\r\n\r\n      if (input) {\r\n        const files: FileList | null = input.files;\r\n        try {\r\n          if (files) {\r\n            const img: HTMLImageElement = await getImgInformationFromFile(files[0]);\r\n            if ((canvasSize.width < img.width) || (canvasSize.height < img.height)) {\r\n              inputBackgroundImg(img.src, img.width, img.height)\r\n              setModal(true);\r\n            } else {\r\n              setBackgroundImg(img.src, img.width, img.height);\r\n            }\r\n          }\r\n        } catch {\r\n          alert(\"Ошибка при импорте изображения. Проверьте исходный файл и повторите попытку\");\r\n        }\r\n        input.value = \"\";\r\n      }\r\n\r\n    }\r\n\r\n\r\n    verify(input).addEventListener(\"change\", handlerChange);\r\n    return () => {\r\n      if (input) input.removeEventListener(\"change\", handlerChange);\r\n    };\r\n  }, [inputFile, setBackgroundImg, inputBackgroundImg, setModal]);\r\n}","import { RefObject, useEffect } from \"react\";\nimport { inputBackgroundImg, setBackgroundImg } from \"../../../../store/actionCreators/canvasActionCreators\";\nimport { store } from \"../../../../store/store\";\n\nexport function useAddBackgroundByUrl(\n  image: RefObject<HTMLImageElement>,\n  url: string,\n  setModal: (value: boolean) => void,\n) {\n\n  useEffect(() => {\n\n    const photo: HTMLImageElement | null = image.current;\n\n    async function handlerClick() {\n\n      try {\n        const img: HTMLImageElement = new Image();\n        img.src = url;\n        await img.decode();\n        if ((store.getState().canvas.width < img.width) || (store.getState().canvas.height < img.height)) {\n          store.dispatch(inputBackgroundImg(img.src, img.width, img.height));\n          setModal(true)\n        } else {\n          store.dispatch(setBackgroundImg(img.src, img.width, img.height));\n        }\n      } catch {\n        alert(\"Ошибка при импорте изображения.\");\n      }\n    }\n\n    if (photo) photo.addEventListener(\"click\", handlerClick);\n    return () => {\n      if (photo) photo.removeEventListener(\"click\", handlerClick)\n    }\n  }, [image, setModal, url]);\n}","import styles from \"./AddBackgroundByUrlButton.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport ModalSearchImg from \"../../modalSearchImg/ModalSearchImg\";\nimport { useAddBackgroundByUrl } from \"./useAddBackgroundByUrl\";\nimport Modal from \"../../../modal/Modal\";\nimport { AppDispatch, RootState } from \"../../../../store/store\";\nimport { inputBackgroundImg, setBackgroundImg, setCanvasSize } from \"../../../../store/actionCreators/canvasActionCreators\";\nimport { ViewModelBgImg } from \"../../../../store/types\";\n\ntype ButtonProps = {\n  label: string,\n  icon: IconDefinition,\n  inputBackgroundImg: (src: string, width: number, height: number) => void,\n  setBackgroundImg: (src: string, width: number, height: number) => void,\n  setCanvasSize: (width: number, height: number) => void,\n  viewModelBgImg: ViewModelBgImg | null,\n}\n\nconst Button = forwardRef((props: ButtonProps, ref: ForwardedRef<HTMLButtonElement>) => {\n  const [isModalSearchImg, setModalSearchImg] = useState(false);\n  const onCloseModalSearchImg = () => setModalSearchImg(false);\n\n  const [isModal, setModal] = useState(false);\n  const onClose = () => setModal(false);\n\n  const bg: ViewModelBgImg = props.viewModelBgImg ?? {\n    width: 0,\n    height: 0,\n    src: \"\",\n  }\n\n  const onAcceptStretch = () => {\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    props.setCanvasSize(bg.width, bg.height);\n    onClose();\n    onCloseModalSearchImg();\n  }\n  const onAcceptCrop = () => {\n    props.setBackgroundImg(bg.src, bg.width, bg.height);\n    onClose();\n    onCloseModalSearchImg();\n  }\n\n  const content: JSX.Element = <p>Исходное изображение больше размера холста</p>;\n\n  const footer: JSX.Element =\n    <>\n      <button onClick={onAcceptStretch}>Растянуть холст</button>\n      <button onClick={onAcceptCrop}>Обрезать изображение</button>\n      <button onClick={onClose}>Отмена</button>\n    </>\n\n  return (\n    <>\n      <button\n        onClick={() => setModalSearchImg(true)}\n        className={styles.button}\n        ref={ref}\n      >\n        <FontAwesomeIcon icon={props.icon} />\n        <span className={styles.button_text}>{props.label}</span>\n      </button>\n\n      <ModalSearchImg\n        visible={isModalSearchImg}\n        onClose={onCloseModalSearchImg}\n        setModal={setModal}\n        useImg={useAddBackgroundByUrl}\n      />\n\n      <Modal\n        visible={isModal}\n        title=\"Выберите действие\"\n        content={content}\n        footer={footer}\n        onClose={onClose}\n      />\n    </>\n  );\n});\n\nconst mapStateToProps = (state: RootState) => ({\n  viewModelBgImg: state.viewModel.bgImg,\n})\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    inputBackgroundImg: (src: string, width: number, height: number) => dispatch(inputBackgroundImg(src, width, height,)),\n    setBackgroundImg: (src: string, width: number, height: number) => dispatch(setBackgroundImg(src, width, height)),\n    setCanvasSize: (width: number, height: number) => dispatch(setCanvasSize(width, height)),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, { forwardRef: true })(Button);","import styles from \"./ToolbarBackground.module.css\";\r\nimport { faDownload, faGlobe, faRetweet } from \"@fortawesome/free-solid-svg-icons\"\r\nimport ColorPicker from \"../colorPicker/ColorPicker\";\r\nimport FileImgButton from \"./fileImgButton/FileImgButton\";\r\nimport { useRef } from \"react\";\r\nimport { useBackgroungColor } from \"./useBackgroungColor\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport {\r\n  inputBackgroundColor,\r\n  resetBackground,\r\n  setBackgroundColor\r\n} from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { connect } from \"react-redux\";\r\nimport { Background } from \"../../../store/types\";\r\nimport AddBackgroundByUrlButton from \"./addBackgroundByUrlButton/AddBackgroundByUrlButton\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\ntype ToolbarBackgroundProps = {\r\n  resetBackground: () => void,\r\n  inputBackgroundColor: (color: string) => void,\r\n  setBackgroundColor: (color: string) => void,\r\n  background: Background,\r\n}\r\n\r\nfunction ToolbarBackground(props: ToolbarBackgroundProps) {\r\n\r\n  const inputColor = useRef<HTMLInputElement>(null);\r\n  const buttonReset = useRef<HTMLButtonElement>(null);\r\n\r\n  useBackgroungColor(\r\n    props.resetBackground,\r\n    props.inputBackgroundColor,\r\n    props.setBackgroundColor,\r\n    props.background,\r\n    inputColor,\r\n    buttonReset\r\n  );\r\n\r\n  return (\r\n    <div className={styles.toolbar}>\r\n      <FileImgButton\r\n        label=\"C компьютера\"\r\n        icon={faDownload}\r\n      />\r\n      <AddBackgroundByUrlButton\r\n        label=\"Из Pixels\"\r\n        icon={faGlobe}\r\n      />\r\n\r\n      <div className={styles.row}>\r\n        <label className={styles.label}>Цвет фона:</label>\r\n        <ColorPicker ref={inputColor} />\r\n        <button ref={buttonReset} className={styles.reset}>\r\n          <FontAwesomeIcon icon={faRetweet} />\r\n        </button>\r\n      </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  background: state.canvas.background,\r\n})\r\n\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    resetBackground: () => dispatch(resetBackground()),\r\n    inputBackgroundColor: (color: string) => dispatch(inputBackgroundColor(color)),\r\n    setBackgroundColor: (color: string) => dispatch(setBackgroundColor(color)),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarBackground);\r\n","import { useEffect, RefObject } from \"react\";\r\nimport { Background } from \"../../../store/types\";\r\nimport { verify } from \"../../../utils/permisions\";\r\n\r\nexport function useBackgroungColor(\r\n  resetBackground: () => void,\r\n  inputBackgroundColor: (color: string) => void,\r\n  setBackgroundColor: (color: string) => void,\r\n  background: Background,\r\n  inputColor: RefObject<HTMLInputElement>,\r\n  buttonReset: RefObject<HTMLButtonElement>): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const input: HTMLInputElement | null = inputColor.current;\r\n    const button: HTMLButtonElement | null = buttonReset.current;\r\n\r\n    function handlerClickResetColor(): void {\r\n      resetBackground();\r\n    }\r\n  \r\n    function handlerInputColor(event: Event): void {\r\n      const inputColor = event.target as HTMLInputElement;\r\n      inputBackgroundColor(inputColor.value);\r\n    }\r\n  \r\n    function handleerChangeColor(event: Event): void {\r\n      const inputColor = event.target as HTMLInputElement;\r\n      const color: string = inputColor.value;\r\n      setBackgroundColor(color);\r\n    }\r\n\r\n\r\n    verify(input).addEventListener(\"input\", handlerInputColor);\r\n    verify(input).addEventListener(\"change\", handleerChangeColor);\r\n    verify(button).addEventListener(\"click\", handlerClickResetColor);\r\n    return () => {\r\n      if (input) {\r\n        input.removeEventListener(\"input\", handlerInputColor);\r\n        input.removeEventListener(\"change\", handleerChangeColor);\r\n      }\r\n      if (button) button.removeEventListener(\"click\", handlerClickResetColor);\r\n\r\n    };\r\n  }, [resetBackground, inputBackgroundColor, setBackgroundColor, background, inputColor, buttonReset]);\r\n\r\n  // изменение цвета input на белый при сбросе фона\r\n  useEffect(() => {\r\n    const input: HTMLInputElement | null = inputColor.current;\r\n    verify(input).value = background.color ? background.color : \"#ffffff\";\r\n  }, [inputColor, background]);\r\n\r\n\r\n}","import styles from \"./Button.module.css\";\nimport { IconDefinition } from \"@fortawesome/fontawesome-svg-core\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { ForwardedRef, forwardRef } from \"react\";\nimport { connect } from \"react-redux\";\n\ntype ButtonProps = {\n  label: string,\n  icon: IconDefinition,\n}\n\nconst Button = forwardRef((props: ButtonProps, ref: ForwardedRef<HTMLButtonElement>) => (\n  <button\n    className={styles.button}\n    ref={ref}\n  >\n    <FontAwesomeIcon icon={props.icon} />\n    <span className={styles.buttonText}>{props.label}</span>\n  </button>\n));\n\nexport default connect(null, null, null, { forwardRef: true })(Button);","import styles from \"./ToolbarObject.module.css\";\nimport { faArrowUp, faArrowDown, faTrash } from \"@fortawesome/free-solid-svg-icons\"\nimport Button from \"../button/Button\";\nimport { useBlockLevel } from \"./useBlockLevel\";\nimport { useBlockDelete } from \"./useBlockDelete\";\nimport { useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { AppDispatch } from \"../../../store/store\";\nimport { deleteBlock, shiftDownBlock, shiftUpBlock } from \"../../../store/actionCreators/blockActionCreators\";\n\ntype ToolbarObjectProps = {\n  shiftUpBlock: () => void,\n  shiftDownBlock: () => void,\n  deleteBlock: () => void,\n}\n\nfunction ToolbarObject(props: ToolbarObjectProps) {\n  const buttonUp = useRef<HTMLButtonElement>(null);\n  const buttonDown = useRef<HTMLButtonElement>(null);\n  const buttonDelete = useRef<HTMLButtonElement>(null);\n  useBlockLevel(buttonUp, buttonDown, props.shiftUpBlock, props.shiftDownBlock);\n  useBlockDelete(buttonDelete, props.deleteBlock);\n  return (\n    <div className={styles.toolbar}>\n      <Button\n        ref={buttonUp}\n        label=\"На слой вверх\"\n        icon={faArrowUp}\n      />\n      <Button\n        ref={buttonDown}\n        label=\"На слой вниз\"\n        icon={faArrowDown}\n      />\n      <Button\n        ref={buttonDelete}\n        label=\"Удалить\"\n        icon={faTrash}\n      />\n    </div>\n  );\n}\n\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\n  return {\n    shiftUpBlock: () => dispatch(shiftUpBlock()),\n    shiftDownBlock: () => dispatch(shiftDownBlock()),\n    deleteBlock: () => dispatch(deleteBlock()),\n  }\n}\n\nexport default connect(null, mapDispatchToProps)(ToolbarObject);\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useBlockLevel(\n  buttonUp: RefObject<HTMLButtonElement>,\n  buttonDown: RefObject<HTMLButtonElement>,\n  shiftUpBlock: () => void,\n  shiftDownBlock: () => void): void {\n\n  useEffect(() => {\n\n    const btnUp: HTMLButtonElement | null = buttonUp.current;\n    const btnDown: HTMLButtonElement | null = buttonDown.current;\n\n    function handlerClickShiftUp(event: Event): void {\n      event.preventDefault();\n      shiftUpBlock();\n    }\n  \n    function handlerClickShiftDown(event: Event): void {\n      event.preventDefault();\n      shiftDownBlock();\n    }\n\n\n    verify(btnUp).addEventListener(\"click\", handlerClickShiftUp);\n    verify(btnDown).addEventListener(\"click\", handlerClickShiftDown);\n    return () => {\n      if (btnUp) btnUp.removeEventListener(\"click\", handlerClickShiftUp);\n      if (btnDown) btnDown.removeEventListener(\"click\", handlerClickShiftDown);\n    };\n  }, [buttonUp, buttonDown, shiftUpBlock, shiftDownBlock]);\n}\n\n\n","import { RefObject, useEffect } from \"react\";\r\nimport { verify } from \"../../../utils/permisions\";\r\n\r\nexport function useBlockDelete(buttonDelete: RefObject<HTMLButtonElement>, deleteBlock: () => void): void {\r\n\r\n  useEffect(() => {\r\n\r\n    const button: HTMLButtonElement | null = buttonDelete.current;\r\n\r\n    function handlerClickDelete(): void {\r\n      deleteBlock();\r\n    }\r\n\r\n    function handlerKeydown(event: KeyboardEvent): void {\r\n      if (event.code === \"Delete\") {\r\n        if (!event.defaultPrevented) {\r\n          deleteBlock();\r\n        }\r\n\r\n      }\r\n    }\r\n\r\n    \r\n    verify(button).addEventListener(\"click\", handlerClickDelete);\r\n    document.addEventListener(\"keydown\", handlerKeydown);\r\n    return () => {\r\n      if (button) button.removeEventListener(\"click\", handlerClickDelete);\r\n      document.removeEventListener(\"keydown\", handlerKeydown);\r\n    };\r\n  }, [buttonDelete, deleteBlock]);\r\n}\r\n\r\n\r\n","import styles from \"./ToolbarCanvas.module.css\";\r\nimport { useRef } from \"react\";\r\nimport { useStateCanvasSize } from \"./useStateCanvasSize\";\r\nimport { connect } from \"react-redux\";\r\nimport { inputCanvasSize, setCanvasSize } from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { AppDispatch, RootState } from \"../../../store/store\";\r\nimport { faEraser } from \"@fortawesome/free-solid-svg-icons\"\r\nimport Button from \"../button/Button\";\r\nimport { deleteAreaSelection, resetAreaSelection } from \"../../../store/actionCreators/canvasActionCreators\";\r\nimport { useDeleteArea } from \"./useDeleteArea\";\r\n\r\ntype ToolbarCanvasProps = {\r\n  inputCanvasSize: (width: number, height: number) => void,\r\n  setCanvasSize: (width: number, height: number) => void,\r\n  width: number,\r\n  height: number,\r\n  deleteAreaSelection: () => void,\r\n  resetAreaSelection: () => void,\r\n}\r\n\r\nfunction ToolbarCanvas(props: ToolbarCanvasProps) {\r\n\r\n  const inputWidth = useRef<HTMLInputElement>(null);\r\n  const inputHeight = useRef<HTMLInputElement>(null);\r\n  useStateCanvasSize(\r\n    inputWidth,\r\n    inputHeight,\r\n    props.inputCanvasSize,\r\n    props.setCanvasSize,\r\n    props.width,\r\n    props.height,\r\n  );\r\n\r\n  const buttonDelete = useRef<HTMLButtonElement>(null);\r\n\r\n  useDeleteArea(buttonDelete, props.deleteAreaSelection, props.resetAreaSelection);\r\n\r\n  return (\r\n    <div className={styles.toolbar}>\r\n\r\n      <div className={styles.row}>\r\n        <label className={styles.label}>Ширина:</label>\r\n        <input type=\"number\" className={styles.inputNumber} min=\"0\" ref={inputWidth} />\r\n        <span className={styles.unitsLabel}>px</span>\r\n      </div>\r\n\r\n      <div className={styles.row}>\r\n        <label className={styles.label}>Высота:</label>\r\n        <input type=\"number\" className={styles.inputNumber} min=\"0\" ref={inputHeight} />\r\n        <span className={styles.unitsLabel}>px</span>\r\n      </div>\r\n\r\n      <Button\r\n        ref={buttonDelete}\r\n        label=\"Удалить область\"\r\n        icon={faEraser}\r\n      />\r\n\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapStateToProps = (state: RootState) => ({\r\n  width: state.canvas.width,\r\n  height: state.canvas.height,\r\n})\r\n\r\nconst mapDispatchToProps = (dispatch: AppDispatch) => {\r\n  return {\r\n    inputCanvasSize: (width: number, height: number) => dispatch(inputCanvasSize(width, height)),\r\n    setCanvasSize: (width: number, height: number) => dispatch(setCanvasSize(width, height)),\r\n    deleteAreaSelection: () => dispatch(deleteAreaSelection()),\r\n    resetAreaSelection: () => dispatch(resetAreaSelection()),\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ToolbarCanvas);\r\n","import { RefObject, useEffect } from \"react\";\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useStateCanvasSize(\n  inputWidth: RefObject<HTMLInputElement>,\n  inputHeight: RefObject<HTMLInputElement>,\n  inputCanvasSize: (width: number, height: number) => void,\n  setCanvasSize: (width: number, height: number) => void,\n  width: number,\n  height: number\n  ): void {\n\n  useEffect(() => {\n    const fieldWidth: HTMLInputElement | null = inputWidth.current;\n    const fieldHeight: HTMLInputElement | null = inputHeight.current;\n\n    verify(fieldWidth).value = String(width);\n    verify(fieldHeight).value = String(height);\n\n    function handleChangeSize(): void {\n      if (fieldWidth && fieldHeight) {\n        const width: number = Number(fieldWidth.value);\n        const height: number = Number(fieldHeight.value);\n        inputCanvasSize(width, height);\n      }\n    }\n\n    function handleBlurSize(): void {\n      if (fieldWidth && fieldHeight) {\n        const width: number = Number(fieldWidth.value);\n        const height: number = Number(fieldHeight.value);\n        setCanvasSize(width, height);\n      }\n    }\n\n\n    verify(fieldWidth).addEventListener(\"change\", handleChangeSize);\n    verify(fieldWidth).addEventListener(\"blur\", handleBlurSize);\n    verify(fieldHeight).addEventListener(\"change\", handleChangeSize);\n    verify(fieldHeight).addEventListener(\"blur\", handleBlurSize);\n    return () => {\n      if (fieldWidth) {\n        fieldWidth.removeEventListener(\"change\", handleChangeSize);\n        fieldWidth.removeEventListener(\"blur\", handleBlurSize);\n      }\n      if (fieldHeight) {\n        fieldHeight.removeEventListener(\"change\", handleChangeSize);\n        fieldHeight.removeEventListener(\"blur\", handleBlurSize);\n      }\n    };\n  }, [inputWidth, inputHeight, inputCanvasSize, setCanvasSize, width, height]);\n}","import { RefObject, useEffect } from \"react\"\nimport { verify } from \"../../../utils/permisions\";\n\nexport function useDeleteArea(\n  buttonDelete: RefObject<HTMLButtonElement>,\n  deleteAreaSelection: () => void,\n  resetAreaSelection: () => void) {\n\n    useEffect(() => {\n\n      const button: HTMLButtonElement | null = buttonDelete.current;\n\n      function handleClickButton() {\n        deleteAreaSelection();\n        resetAreaSelection();\n      }\n      function handleMousedownButton(event: MouseEvent) {\n        event.preventDefault();\n      }\n  \n  \n      verify(button).addEventListener(\"click\", handleClickButton);\n      verify(button).addEventListener(\"mousedown\", handleMousedownButton);\n      return () => {\n        if (button) button.removeEventListener(\"click\", handleClickButton);\n        if (button) button.removeEventListener(\"mousedown\", handleMousedownButton);\n      };\n    }, [buttonDelete, deleteAreaSelection, resetAreaSelection]);\n  }","import styles from \"./Toolbar.module.css\";\nimport ToolbarText from \"./toolbarText/ToolbarText\";\nimport ToolbarImg from \"./toolbarImg/ToolbarImg\";\nimport ToolbarFilter from \"./toolbarFilter/ToolbarFilter\";\nimport ToolbarBackground from \"./toolbarBackground/ToolbarBackground\";\nimport ToolbarObject from \"./toolbarObject/ToolbarObject\";\nimport ToolbarCanvas from \"./toolbarCanvas/ToolbarCanvas\";\nimport { connect } from \"react-redux\";\n\nfunction Toolbar() {\n  return (\n    <div className={styles.toolbar}>\n      <label>Текст</label>\n      <ToolbarText />\n      <label>Изображения</label>\n      <ToolbarImg />\n      <label>Фон</label>\n      <ToolbarBackground />\n      <label>Фильтр</label>\n      <ToolbarFilter />\n      <label>Объекты</label>\n      <ToolbarObject />\n      <label>Холст</label>\n      <ToolbarCanvas />\n    </div>\n  );\n}\n\nexport default connect()(Toolbar);\n","import styles from \"./CardMaker.module.css\";\r\nimport Header from \"./header/Header\";\r\nimport Canvas from \"./canvas/Canvas\";\r\nimport { connect } from \"react-redux\";\r\nimport Toolbar from \"./toolbar/Toolbar\";\r\n\r\nfunction CardMaker() {\r\n  return (\r\n    <>\r\n      <main className={styles.main}>\r\n        <Canvas />\r\n      </main>\r\n      <Header />\r\n      <Toolbar />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default connect()(CardMaker);\r\n","import \"./index.css\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport CardMaker from \"./cardMaker/CardMaker\";\r\nimport { store } from \"./store/store\";\r\nimport { Provider } from \"react-redux\";\r\n\r\nwindow.addEventListener(\"beforeunload\", (event) => event.returnValue = false);\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <CardMaker />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}